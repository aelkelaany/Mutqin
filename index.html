<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="متقن - Mutqin">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0B0E17">
<meta name="description" content="متقن Mutqin - نظام إدارة حياتك الشخصي">
<title>متقن Mutqin | إدارة حياتك</title>
<link rel="apple-touch-icon" href="data:image/png;base64,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">
<link rel="icon" type="image/png" href="data:image/png;base64,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">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<script>
// PWA Manifest (inline)
const manifest = {
  name: "متقن - Mutqin",
  short_name: "متقن",
  description: "متقن — نظام إدارة حياتك الشخصي",
  start_url: ".",
  display: "standalone",
  orientation: "portrait",
  background_color: "#0B0E17",
  theme_color: "#0B0E17",
  categories: ["productivity", "lifestyle"],
  icons: [
    { src: "data:image/png;base64,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", sizes: "512x512", type: "image/png", purpose: "any maskable" }
  ]
};
const mBlob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
const mUrl = URL.createObjectURL(mBlob);
const mLink = document.createElement('link');
mLink.rel = 'manifest';
mLink.href = mUrl;
document.head.appendChild(mLink);

// Service Worker (inline)
if ('serviceWorker' in navigator) {
  const swCode = `
    const CACHE = 'gt-v6';
    const URLS = ['./', 'https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js','https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js','https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js','https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js','https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css'];
    self.addEventListener('install', e => { e.waitUntil(caches.open(CACHE).then(c => c.addAll(URLS)).then(() => self.skipWaiting())); });
    self.addEventListener('activate', e => { e.waitUntil(caches.keys().then(ks => Promise.all(ks.filter(k => k !== CACHE).map(k => caches.delete(k)))).then(() => self.clients.claim())); });
    self.addEventListener('fetch', e => { const url = e.request.url; if (url.includes('er-api.com') || url.includes('frankfurter') || url.includes('exchangerate')) { return; } e.respondWith(caches.match(e.request).then(r => r || fetch(e.request).then(res => { if (res.ok) { const cl = res.clone(); caches.open(CACHE).then(c => c.put(e.request, cl)); } return res; }).catch(() => caches.match('./')))); });
  `;
  const swBlob = new Blob([swCode], {type: 'application/javascript'});
  const swUrl = URL.createObjectURL(swBlob);
  navigator.serviceWorker.register(swUrl).catch(() => {});
}
</script>
<style>
:root{--coral:#FF6B6B;--coral-g:#FF6B6B44;--teal:#00D2D3;--teal-g:#00D2D344;--gold:#FECA57;--gold-g:#FECA5744;--pink:#FF9FF3;--pink-g:#FF9FF344;--lime:#55E6C1;--lime-g:#55E6C144;--electric:#5F7FFF;--electric-g:#5F7FFF44;--bg:#0B0E17;--bg2:#111627;--bg3:#182036;--text:#F0F2F8;--text2:#8892B0;--border:#1E2744;--bh:#2A3660}
.light{--bg:#F5F7FA;--bg2:#FFFFFF;--bg3:#EEF1F6;--text:#1A202C;--text2:#64748B;--border:#E2E8F0;--bh:#CBD5E1}
.light body,.light .bottom-nav,.light header{background:var(--bg2)}
.light body::before{background:radial-gradient(ellipse 600px 400px at 10% 20%,#FF6B6B06 0%,transparent 70%),radial-gradient(ellipse 500px 500px at 90% 80%,#00D2D306 0%,transparent 70%)}
.light .btn-ghost{background:var(--bg3);color:var(--text2);border-color:var(--border)}
.light .field{background:var(--bg3);border-color:var(--border);color:var(--text)}
.light .modal{background:var(--bg2);border-color:var(--border)}
.light .overlay{background:rgba(0,0,0,.35)}
.light .card{box-shadow:0 2px 12px rgba(0,0,0,.06)}
.light .drop-zone{border-color:var(--border)}
.light .stat-chip{background:var(--bg3)}
.light ::-webkit-scrollbar-thumb{background:var(--border)}
.light .stat-card{background:var(--bg3);border-color:var(--border)}
.light .pomo-panel{background:var(--bg2);border-color:var(--border);box-shadow:0 12px 40px rgba(0,0,0,.1)}
.light .filter-chip{background:var(--bg3);border-color:var(--border)}
.light .search-wrap input{background:var(--bg3);border-color:var(--border)}
.light .note-box{background:var(--bg3);border-color:var(--border)}
.light .sort-btn{background:var(--bg3);border-color:var(--border)}
.light .backup-bar{background:#FECA5718;border-color:#F6B93B}
.light .drag-ghost{background:var(--bg2);border-color:var(--teal);box-shadow:0 12px 40px rgba(0,0,0,.1)}
.light .chart-bar:hover::after{background:var(--bg2);border-color:var(--border)}
body,header,.bottom-nav,.card,.field,.btn,.modal,.overlay,.badge{transition:background .3s,color .3s,border-color .3s,box-shadow .3s}
.mobile-preview{width:390px;height:844px;border-radius:40px;border:4px solid var(--border);overflow:hidden;position:relative;margin:20px auto;box-shadow:0 25px 60px rgba(0,0,0,.3);display:flex;flex-direction:column;transition:border-color .3s,box-shadow .3s}
.light .mobile-preview{box-shadow:0 25px 60px rgba(0,0,0,.12);border-color:#CBD5E1}
.mobile-preview::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:120px;height:28px;background:var(--bg2);border-radius:0 0 16px 16px;z-index:99;border:1px solid var(--border);border-top:none}
.mobile-preview .bottom-nav{display:flex!important;position:absolute}
.mobile-preview .dnav{display:none!important}
.mobile-preview .cal-cell{min-height:44px!important;padding:2px!important}
.mobile-preview main{padding-bottom:90px!important}
.mobile-preview .hidden.sm\\:block,.mobile-preview .hidden.md\\:block{display:none!important}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
@media(display-mode:standalone){body{padding-top:env(safe-area-inset-top);padding-bottom:env(safe-area-inset-bottom)}.bottom-nav{padding-bottom:env(safe-area-inset-bottom)}header{padding-top:env(safe-area-inset-top)}}
body{font-family:'Tajawal','Poppins',sans-serif;background:var(--bg);color:var(--text);min-height:100dvh;overflow-x:hidden;-webkit-font-smoothing:antialiased}
[dir="ltr"] body{font-family:'Poppins','Tajawal',sans-serif}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 600px 400px at 10% 20%,#FF6B6B0A 0%,transparent 70%),radial-gradient(ellipse 500px 500px at 90% 80%,#00D2D30A 0%,transparent 70%),radial-gradient(ellipse 400px 300px at 50% 50%,#5F7FFF08 0%,transparent 70%);pointer-events:none;z-index:0}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--border);border-radius:10px}
.card{background:var(--bg2);border:1px solid var(--border);border-radius:20px;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}
.card:hover{border-color:var(--bh)}
.btn{border:none;border-radius:14px;padding:10px 20px;cursor:pointer;font-weight:700;font-family:inherit;font-size:14px;transition:all .25s cubic-bezier(.4,0,.2,1);display:inline-flex;align-items:center;gap:6px;white-space:nowrap}
.btn:active{transform:scale(.96)}
.btn-coral{background:linear-gradient(135deg,#FF6B6B,#EE5A24);color:#fff;box-shadow:0 4px 15px var(--coral-g)}
.btn-teal{background:linear-gradient(135deg,#00D2D3,#01A3A4);color:#0B0E17;box-shadow:0 4px 15px var(--teal-g)}
.btn-gold{background:linear-gradient(135deg,#FECA57,#F6B93B);color:#0B0E17;box-shadow:0 4px 15px var(--gold-g)}
.btn-pink{background:linear-gradient(135deg,#FF9FF3,#F368E0);color:#0B0E17;box-shadow:0 4px 15px var(--pink-g)}
.btn-elec{background:linear-gradient(135deg,#5F7FFF,#4361EE);color:#fff;box-shadow:0 4px 15px var(--electric-g)}
.btn-ghost{background:var(--bg3);color:var(--text2);border:1px solid var(--border)}
.btn-ghost:hover{border-color:var(--teal);color:var(--teal)}
.btn-sm{padding:7px 14px;font-size:12px;border-radius:10px}
.btn-xs{padding:5px 10px;font-size:11px;border-radius:8px}
.btn-icon-sm{width:32px;height:32px;font-size:13px;border-radius:10px;padding:0;display:flex;align-items:center;justify-content:center}
.btn-icon-xs{width:28px;height:28px;font-size:11px;border-radius:8px;padding:0;display:flex;align-items:center;justify-content:center}
.field{background:var(--bg);border:2px solid var(--border);border-radius:14px;padding:12px 16px;color:var(--text);width:100%;font-family:inherit;font-size:14px;transition:all .2s;outline:none}
.field:focus{border-color:var(--teal);box-shadow:0 0 0 4px var(--teal-g)}
.field::placeholder{color:var(--text2);opacity:.5}
select.field{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12'%3E%3Cpath fill='%238892B0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:left 14px center}
[dir="ltr"] select.field{background-position:right 14px center}
.label{font-size:12px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px;display:block}
.badge{display:inline-flex;align-items:center;gap:3px;padding:3px 9px;border-radius:8px;font-size:11px;font-weight:700}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);backdrop-filter:blur(8px);z-index:50;display:flex;align-items:flex-end;justify-content:center;animation:fadeIn .2s ease}
@media(min-width:640px){.overlay{align-items:center}}
.modal{background:var(--bg2);border:1px solid var(--border);width:100%;max-height:92dvh;overflow-y:auto;border-radius:24px 24px 0 0;animation:slideUp .35s cubic-bezier(.4,0,.2,1)}
@media(min-width:640px){.modal{max-width:520px;border-radius:24px;max-height:85dvh}}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes toastSlide{from{transform:translateX(120%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
.exp-summary{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px}
.exp-summary-card{padding:14px;border-radius:16px;border:1px solid var(--border);background:var(--bg2)}
.exp-summary-card .exp-val{font-size:24px;font-weight:900}
.exp-summary-card .exp-lbl{font-size:11px;color:var(--text2);font-weight:600;margin-top:2px}
.exp-budget-bar{height:8px;border-radius:8px;background:var(--bg3);overflow:hidden;margin-top:8px}
.exp-budget-fill{height:100%;border-radius:8px;transition:width .5s}
.exp-tabs{display:flex;gap:4px;margin-bottom:14px;overflow-x:auto;padding-bottom:4px}
.exp-tab{padding:8px 16px;border-radius:12px;font-size:12px;font-weight:700;cursor:pointer;white-space:nowrap;border:1px solid var(--border);background:var(--bg3);color:var(--text2);transition:all .2s}
.exp-tab.active{background:var(--coral);color:white;border-color:var(--coral)}
.exp-item{display:flex;align-items:center;gap:10px;padding:12px 0;border-bottom:1px solid var(--border)}
.exp-cat-dot{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.exp-amount{font-weight:800;font-size:15px;white-space:nowrap}
.exp-date-group{font-size:12px;font-weight:700;color:var(--text2);padding:10px 0 4px;border-bottom:2px solid var(--border)}
.exp-chart-wrap{padding:16px;min-height:200px;display:flex;align-items:center;justify-content:center}
.exp-pie-legend{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:12px}
.exp-pie-legend-item{display:flex;align-items:center;gap:4px;font-size:11px;font-weight:600}
.exp-budget-card{padding:14px;border-radius:16px;border:1px solid var(--border);background:var(--bg2);margin-bottom:10px;transition:border-color .2s,transform .1s}
.exp-budget-card:hover{border-color:var(--coral)}
.exp-budget-card:active{transform:scale(.98)}
.light .exp-summary-card,.light .exp-budget-card{background:var(--bg2);border-color:var(--border)}
.notes-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media(min-width:768px){.notes-grid{grid-template-columns:1fr 1fr 1fr}}
.note-card{border-radius:16px;padding:14px;border:1px solid var(--border);cursor:pointer;transition:transform .15s,box-shadow .15s;overflow:hidden;position:relative;min-height:80px}
.note-card:active{transform:scale(.97)}
.note-card.pinned{border-width:2px}
.note-pin{position:absolute;top:8px;left:8px;font-size:14px}
[dir="rtl"] .note-pin{left:auto;right:8px}
.note-card-title{font-weight:800;font-size:13px;margin-bottom:6px;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.note-card-body{font-size:11px;color:var(--text2);line-height:1.5;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical;overflow:hidden}
.note-card-footer{display:flex;justify-content:space-between;align-items:center;margin-top:8px;font-size:10px;color:var(--text2)}
.note-check-item{display:flex;align-items:center;gap:6px;font-size:11px;padding:2px 0}
.note-check-item.done{text-decoration:line-through;opacity:.5}
.notes-list .note-card{display:flex;gap:12px;align-items:center;min-height:60px}
.notes-list .note-card-body{-webkit-line-clamp:2}
.note-type-tabs{display:flex;gap:4px;overflow-x:auto;padding-bottom:4px}
.note-reminder-badge{display:inline-flex;align-items:center;gap:3px;padding:2px 6px;border-radius:6px;font-size:9px;font-weight:700;background:var(--gold-g);color:var(--gold)}
.light .exp-tab{background:var(--bg3);border-color:var(--border)}
.bottom-nav{position:fixed;bottom:0;left:0;right:0;background:var(--bg2);border-top:1px solid var(--border);z-index:40;padding:6px 8px;padding-bottom:max(6px,env(safe-area-inset-bottom));display:flex;justify-content:space-around}
@media(min-width:768px){.bottom-nav{display:none}}
.bnav-item{display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 8px;border-radius:14px;cursor:pointer;transition:all .2s;color:var(--text2);font-size:10px;font-weight:600;position:relative}
.bnav-item.active{color:var(--coral)}
.bnav-item.active::before{content:'';position:absolute;top:-6px;width:24px;height:3px;border-radius:0 0 4px 4px;background:var(--coral)}
.bnav-item span:first-child{font-size:22px;line-height:1}
.dnav{display:none}@media(min-width:768px){.dnav{display:flex}}
.dnav-item{padding:8px 18px;border-radius:14px;cursor:pointer;transition:all .25s;display:flex;align-items:center;gap:8px;color:var(--text2);font-weight:600;font-size:14px}
.dnav-item:hover{background:var(--bg3);color:var(--text)}
.dnav-item.active{background:linear-gradient(135deg,var(--coral),#EE5A24);color:white;box-shadow:0 4px 15px var(--coral-g)}
.cal-toggle{display:flex;align-items:center;gap:6px;padding:8px 14px;border-radius:14px;cursor:pointer;background:var(--bg2);border:1px solid var(--border);font-size:13px;font-weight:700;color:var(--text2);transition:all .2s;margin-bottom:10px;width:100%}
.cal-toggle:hover{border-color:var(--teal);color:var(--teal)}
@media(min-width:768px){.cal-toggle{display:none}.cal-inner{display:block!important}}
@media(min-width:768px){
  .desktop-layout{max-width:1200px!important}
  .desktop-layout .card{padding:20px!important}
  .desktop-layout .card h3,.desktop-layout h2{font-size:20px!important}
  .stats-grid{grid-template-columns:repeat(5,1fr)!important;gap:12px!important}
  .stat-card{padding:16px 14px!important}
  .stat-card .sv{font-size:32px!important}
  .stat-card .sl{font-size:12px!important}
  .chart-bar-wrap{height:100px!important}
  .search-wrap input{padding:14px 40px!important;font-size:15px!important}
  .filter-chips{gap:8px!important}
  .filter-chip{padding:7px 16px!important;font-size:13px!important}
  .desk-split{display:grid!important;grid-template-columns:340px 1fr;gap:20px;align-items:start}
  .desk-split .cal-col{position:sticky;top:80px}
  .note-box{font-size:13px!important}
  .badge{font-size:12px!important;padding:4px 10px!important}
}
@media(min-width:1100px){
  .desktop-layout{max-width:1400px!important}
  .desk-split{grid-template-columns:380px 1fr}
  .stat-card .sv{font-size:36px!important}
}
.cal-cell{min-height:44px;cursor:pointer;border-radius:12px;transition:all .15s;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px}
.cal-cell:hover{background:var(--bg3)}.cal-cell:active{transform:scale(.95)}
@media(min-width:768px){.cal-cell{min-height:72px;padding:4px}}
.progress-ring{transform:rotate(-90deg)}
.glow-dot{width:6px;height:6px;border-radius:50%;animation:pulse 2s infinite}
.toast-item{animation:toastSlide .4s cubic-bezier(.4,0,.2,1)}
@media(max-width:767px){main{padding-bottom:90px!important}}
@media(hover:none){.card:hover{transform:none}}
.drop-zone{border:3px dashed var(--border);border-radius:20px;padding:40px 20px;text-align:center;transition:all .3s;cursor:pointer}
.drop-zone:hover,.drop-zone.dragover{border-color:var(--teal);background:var(--teal-g)}
.upload-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:8px;margin-top:16px}
.stat-chip{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:10px;text-align:center}
.stat-chip .num{font-size:24px;font-weight:900;display:block}
.stat-chip .lbl{font-size:10px;color:var(--text2);font-weight:600;text-transform:uppercase}
.drag-handle{cursor:grab;font-size:16px;color:var(--text2);padding:4px;border-radius:6px;user-select:none;touch-action:none;display:flex;align-items:center;justify-content:center;flex-shrink:0;opacity:.5;transition:all .2s}
.drag-handle:hover,.drag-handle:active{opacity:1;color:var(--teal);background:var(--teal-g)}
.drag-item{transition:transform .15s,opacity .15s,box-shadow .15s}
.drag-item.dragging{opacity:.4;transform:scale(.97)}
.drag-item.drag-over-top{box-shadow:0 -3px 0 0 var(--teal) inset}
.drag-item.drag-over-bot{box-shadow:0 3px 0 0 var(--teal) inset}
.drag-ghost{position:fixed;pointer-events:none;z-index:999;opacity:.85;transform:scale(1.02);box-shadow:0 12px 40px rgba(0,0,0,.3);border-radius:14px;background:var(--bg2);border:2px solid var(--teal);max-width:90vw}
.sort-btn{display:inline-flex;align-items:center;gap:3px;padding:4px 10px;border-radius:8px;font-size:11px;font-weight:700;cursor:pointer;border:1px solid var(--border);background:var(--bg3);color:var(--text2);transition:all .2s;user-select:none}
.sort-btn:hover{border-color:var(--teal);color:var(--teal)}
.sort-btn.active{background:var(--teal-g);border-color:var(--teal);color:var(--teal)}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(90px,1fr));gap:8px;margin-bottom:16px}
.stat-card{background:var(--bg2);border:1px solid var(--border);border-radius:16px;padding:12px 10px;text-align:center;transition:all .2s}
.stat-card:hover{border-color:var(--bh)}
.stat-card .sv{font-size:26px;font-weight:900;display:block;line-height:1.2}
.stat-card .sl{font-size:10px;color:var(--text2);font-weight:600;margin-top:2px}
.chart-bar-wrap{display:flex;align-items:flex-end;gap:4px;height:80px;padding:0 4px}
.chart-bar{flex:1;border-radius:6px 6px 0 0;transition:height .4s cubic-bezier(.4,0,.2,1);min-width:12px;position:relative;cursor:default}
.chart-bar:hover::after{content:attr(data-tip);position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:3px 8px;font-size:10px;font-weight:700;white-space:nowrap;z-index:10}
.search-wrap{position:relative;margin-bottom:12px}
.search-wrap input{padding-right:36px;padding-left:36px}
.search-wrap .search-icon{position:absolute;top:50%;transform:translateY(-50%);font-size:16px;pointer-events:none}
[dir="rtl"] .search-wrap .search-icon{right:12px}
[dir="ltr"] .search-wrap .search-icon{left:12px}
.search-wrap .clear-btn{position:absolute;top:50%;transform:translateY(-50%);cursor:pointer;font-size:14px;background:none;border:none;color:var(--text2);padding:4px}
[dir="rtl"] .search-wrap .clear-btn{left:10px}
[dir="ltr"] .search-wrap .clear-btn{right:10px}
.filter-chips{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px}
.filter-chip{padding:5px 12px;border-radius:20px;font-size:11px;font-weight:700;cursor:pointer;border:1px solid var(--border);background:var(--bg3);color:var(--text2);transition:all .2s}
.filter-chip.active{border-color:var(--teal);background:var(--teal-g);color:var(--teal)}
.pomo-float{position:fixed;bottom:90px;z-index:45;transition:all .3s}
[dir="rtl"] .pomo-float{left:16px}
[dir="ltr"] .pomo-float{right:16px}
@media(min-width:768px){.pomo-float{bottom:20px}}
.pomo-mini{width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--coral),#EE5A24);color:white;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 6px 24px var(--coral-g);font-size:22px;border:none;transition:all .2s}
.pomo-mini:hover{transform:scale(1.1)}
.pomo-panel{background:var(--bg2);border:1px solid var(--border);border-radius:20px;padding:20px;width:280px;box-shadow:0 12px 40px rgba(0,0,0,.3)}
.pomo-ring{position:relative;width:140px;height:140px;margin:0 auto 16px}
.pomo-ring svg{transform:rotate(-90deg)}
.pomo-ring .pomo-time{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:32px;font-weight:900;line-height:1}
.pomo-ring .pomo-label{font-size:11px;color:var(--text2);font-weight:600;margin-top:2px}
.note-box{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:8px 10px;font-size:12px;color:var(--text2);margin-top:4px;line-height:1.5}
.dep-badge{display:inline-flex;align-items:center;gap:3px;padding:2px 8px;border-radius:6px;font-size:10px;font-weight:700;background:var(--coral-g);color:var(--coral)}
.streak-badge{display:inline-flex;align-items:center;gap:4px;padding:6px 14px;border-radius:12px;font-weight:800;font-size:14px;background:linear-gradient(135deg,#FF6B6B,#EE5A24);color:white;box-shadow:0 4px 15px var(--coral-g);animation:pulse 2s infinite}
.backup-bar{background:var(--gold-g);border:1px solid var(--gold);border-radius:14px;padding:10px 16px;display:flex;align-items:center;gap:10px;margin-bottom:12px;font-size:13px;font-weight:600;color:var(--gold)}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useCallback,useMemo}=React;
const DB='GoalTrackerDB',VER=6,ST=['goals','milestones','tasks','quickTasks','taskLists','meetings','expenses','categories','budgets','notes'];
const ICONS={goals:['🎯','🏆','💼','🎓','💪','🌟','🚀','📈','🏃‍♂️','💡','🎨','🔬','🏠','💰','❤️','🧠','🕌','📖','🤲','🌙','⭐','🔥','🏅','🎖️','💎','🗝️','🌍','🏋️','🧘','🎵','📚','🏗️','🔮','🎪','🦅','🌱','🏔️','⚡','🛡️','🧭'],milestones:['📍','🏁','🎖️','⭐','💎','🔑','🎯','📊','🏅','🔥','⚡','🌈','🕋','🌙','📖','🤲','🕌','☪️','🏆','👑','💫','🎗️','🔰','🌟','🎊','🏔️','🦁','✨','🔱','💠'],tasks:['✅','📝','✏️','📋','🔨','⚙️','🔧','💡','📱','📊','🎬','🔍','🎨','💻','📞','🧹','📖','🕌','🤲','🌙','🕋','☪️','🍽️','🍲','🔪','🛒','🚿','👔','🧕','📿','🕐','🕑','🕒','🕓','🕔','💼','📧','🗂️','📎','🖥️','📊','📄','🗳️','🤝','📌','🏷️','💳','📦','🔔','📢','🧪','🔬','📐','🖌️','📓','🏃','🧘','💊','🍎','💧','🧠','🔋','🌅','🌄','🌇','🌆','⏰','🎒','✈️','🚗','🏥','🛍️','🎁','💌','📸','🎶','🎮','📺','🧩','🏠','🌳','🐝','☕','🍵','🫖'],meetings:['👥','🤝','💬','📞','🎤','🏢','☕','🍽️','📹','🗣️','🎯','💼','🕌','📱','💻','🎪','📋','🏛️','🗓️','⏰','🔔','👨‍💼','👩‍💼','🧑‍🏫','🎓'],lists:['🛒','📞','📚','✈️','🏠','🎵','🎮','🧹','💊','📦','🎁','🍽️','👕','🔧','🏋️','🌱','📿','🕌','🤲','🍲','📖','☪️','🧕','🎒','💼','🧪','🩺','🎨','🎯','✨']};

const MUTQIN_LOGO='data:image/png;base64,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';
const COLS=['#FF6B6B','#00D2D3','#FECA57','#FF9FF3','#55E6C1','#5F7FFF','#F97F51','#1B9CFC','#A3CB38','#D980FA'];
const T=(a,e,l)=>l==='ar'?a:e;
const uid=()=>Date.now().toString(36)+Math.random().toString(36).substr(2,6);
const localDS=(d)=>{d=d||new Date();const y=d.getFullYear(),m=String(d.getMonth()+1).padStart(2,'0'),day=String(d.getDate()).padStart(2,'0');return`${y}-${m}-${day}`;};
const CHEERS={ar:['أحسنت! واصل التقدم 🔥','ما شاء الله! إنجاز رائع 🌟','يا بطل! خطوة للأمام 💪','تبارك الله! أنت تتقدم 🚀','هكذا تُصنع الإنجازات ⭐','استمر! النجاح قريب 🏆','رائع! كل مهمة تقربك من هدفك 🎯','بارك الله فيك! عمل ممتاز ✨','أنت ملهم! واصل 🌈','ممتاز! الإصرار مفتاح النجاح 💎','هيا! باقي القليل 🏁','ثابر! الله معك 🤲','عظيم! أنت على الطريق الصحيح 📈','أنجزتها! فخور بك 🎉','قوة! لا تتوقف 🔋'],en:['Well done! Keep it up 🔥','Amazing progress! 🌟','Champion! One step forward 💪','Incredible! You\'re advancing 🚀','This is how greatness is built ⭐','Keep going! Success is near 🏆','Awesome! Each task gets you closer 🎯','Excellent work! ✨','You\'re inspiring! 🌈','Persistence is the key 💎','Almost there! 🏁','Stay strong! 🤲','Great! You\'re on track 📈','Nailed it! Proud of you 🎉','Power! Don\'t stop 🔋']};
const cheer=(lang)=>CHEERS[lang][Math.floor(Math.random()*CHEERS[lang].length)];

const HM={ar:['محرم','صفر','ربيع الأول','ربيع الثاني','جمادى الأولى','جمادى الآخرة','رجب','شعبان','رمضان','شوال','ذو القعدة','ذو الحجة'],en:['Muharram','Safar','Rabi I','Rabi II','Jumada I','Jumada II','Rajab','Sha\'ban','Ramadan','Shawwal','Dhul Qi\'dah','Dhul Hijjah']};
// Umm al-Qura calendar via Intl API
const _hFmt={day:new Intl.DateTimeFormat('en-u-ca-islamic-umalqura',{day:'numeric'}),month:new Intl.DateTimeFormat('en-u-ca-islamic-umalqura',{month:'numeric'}),year:new Intl.DateTimeFormat('en-u-ca-islamic-umalqura',{year:'numeric'}),monthName_ar:new Intl.DateTimeFormat('ar-SA-u-ca-islamic-umalqura',{month:'long'}),monthName_en:new Intl.DateTimeFormat('en-u-ca-islamic-umalqura',{month:'long'})};
function toH(y,m,d){try{const dt=new Date(y,m-1,d);return{day:parseInt(_hFmt.day.format(dt)),month:parseInt(_hFmt.month.format(dt)),year:parseInt(_hFmt.year.format(dt).replace(/\D/g,'')),monthName_ar:_hFmt.monthName_ar.format(dt),monthName_en:_hFmt.monthName_en.format(dt)};}catch(e){return{day:d,month:m,year:y,monthName_ar:'',monthName_en:''};}}
function hijriHeader(y,m,lang){const dt=new Date(y,m,15);const h=toH(y,m+1,15);const mName=lang==='ar'?h.monthName_ar:h.monthName_en;return`${mName} ${h.year}`;}

// DB
function odb(){return new Promise((r,j)=>{const q=indexedDB.open(DB,VER);q.onupgradeneeded=e=>{const db=e.target.result;ST.forEach(s=>{if(!db.objectStoreNames.contains(s))db.createObjectStore(s,{keyPath:'id'});});};q.onsuccess=()=>r(q.result);q.onerror=()=>j(q.error);})}
async function dAll(s){const db=await odb();return new Promise((r,j)=>{const q=db.transaction(s,'readonly').objectStore(s).getAll();q.onsuccess=()=>r(q.result);q.onerror=()=>j(q.error);})}
async function dPut(s,i){const db=await odb();return new Promise((r,j)=>{const tx=db.transaction(s,'readwrite');tx.objectStore(s).put(i);tx.oncomplete=()=>r();tx.onerror=()=>j(tx.error);})}
async function dDel(s,id){const db=await odb();return new Promise((r,j)=>{const tx=db.transaction(s,'readwrite');tx.objectStore(s).delete(id);tx.oncomplete=()=>r();tx.onerror=()=>j(tx.error);})}
async function dClr(s){const db=await odb();return new Promise((r,j)=>{const tx=db.transaction(s,'readwrite');tx.objectStore(s).clear();tx.oncomplete=()=>r();tx.onerror=()=>j(tx.error);})}

// ========== DRAG-SORT ==========
const sortByOrder=(items)=>[...items].sort((a,b)=>(a.sortOrder??999999)-(b.sortOrder??999999));

function DragList({items,onReorder,renderItem,keyFn=i=>i.id,style}){
  const[dragIdx,setDragIdx]=useState(null);
  const[overIdx,setOverIdx]=useState(null);
  const[overHalf,setOverHalf]=useState(null); // 'top' or 'bot'
  const ghostRef=React.useRef(null);
  const itemsRef=React.useRef([]);
  const touchActive=React.useRef(false);

  const getOverInfo=(clientY)=>{
    for(let i=0;i<itemsRef.current.length;i++){
      const el=itemsRef.current[i];
      if(!el)continue;
      const r=el.getBoundingClientRect();
      if(clientY>=r.top&&clientY<=r.bottom){
        const mid=r.top+r.height/2;
        return{idx:i,half:clientY<mid?'top':'bot'};
      }
    }
    return null;
  };

  const doReorder=(fromIdx,toIdx,half)=>{
    if(fromIdx===null||toIdx===null)return;
    let finalIdx=half==='bot'?toIdx+1:toIdx;
    if(finalIdx>fromIdx)finalIdx--;
    if(finalIdx===fromIdx)return;
    const arr=[...items];
    const[moved]=arr.splice(fromIdx,1);
    arr.splice(finalIdx,0,moved);
    onReorder(arr.map((it,i)=>({...it,sortOrder:i})));
  };

  // Desktop drag
  const onDragStart=(e,idx)=>{setDragIdx(idx);e.dataTransfer.effectAllowed='move';
    const el=itemsRef.current[idx];if(el){e.dataTransfer.setDragImage(el,20,20);}};
  const onDragOver=(e,idx)=>{e.preventDefault();e.dataTransfer.dropEffect='move';
    const r=itemsRef.current[idx]?.getBoundingClientRect();
    if(r){const mid=r.top+r.height/2;setOverHalf(e.clientY<mid?'top':'bot');}
    setOverIdx(idx);};
  const onDragEnd=()=>{if(dragIdx!==null&&overIdx!==null)doReorder(dragIdx,overIdx,overHalf);
    setDragIdx(null);setOverIdx(null);setOverHalf(null);};

  // Touch drag
  const onTouchStart=(e,idx)=>{
    touchActive.current=true;setDragIdx(idx);
    const touch=e.touches[0];
    const el=itemsRef.current[idx];
    if(el){
      const ghost=el.cloneNode(true);
      ghost.className='drag-ghost';
      ghost.style.width=el.offsetWidth+'px';
      ghost.style.left=el.getBoundingClientRect().left+'px';
      ghost.style.top=(touch.clientY-30)+'px';
      document.body.appendChild(ghost);
      ghostRef.current=ghost;
    }
  };
  const onTouchMove=(e,idx)=>{
    if(!touchActive.current)return;
    e.preventDefault();
    const touch=e.touches[0];
    if(ghostRef.current){ghostRef.current.style.top=(touch.clientY-30)+'px';}
    const info=getOverInfo(touch.clientY);
    if(info){setOverIdx(info.idx);setOverHalf(info.half);}
  };
  const onTouchEnd=()=>{
    if(touchActive.current&&dragIdx!==null&&overIdx!==null)doReorder(dragIdx,overIdx,overHalf);
    touchActive.current=false;setDragIdx(null);setOverIdx(null);setOverHalf(null);
    if(ghostRef.current){ghostRef.current.remove();ghostRef.current=null;}
  };

  return(
    <div style={style}>
      {items.map((item,idx)=>(
        <div key={keyFn(item)} ref={el=>itemsRef.current[idx]=el}
          draggable onDragStart={e=>onDragStart(e,idx)} onDragOver={e=>onDragOver(e,idx)} onDragEnd={onDragEnd}
          className={`drag-item ${dragIdx===idx?'dragging':''} ${overIdx===idx&&dragIdx!==idx?(overHalf==='top'?'drag-over-top':'drag-over-bot'):''}`}>
          {renderItem(item,idx,
            <div className="drag-handle"
              onTouchStart={e=>onTouchStart(e,idx)}
              onTouchMove={e=>onTouchMove(e,idx)}
              onTouchEnd={onTouchEnd}>⠿</div>
          )}
        </div>
      ))}
    </div>
  );
}
// ========== SORT BUTTON ==========
function SortBtn({sort,onToggle,language}){
  const labels={none:T('ترتيب حسب التاريخ','Sort by date',language),asc:'📅 '+T('الأقرب أولاً','Earliest first',language),desc:'📅 '+T('الأبعد أولاً','Latest first',language)};
  return(<div className={`sort-btn ${sort!=='none'?'active':''}`} onClick={onToggle}>{labels[sort]} {sort==='asc'?'↑':sort==='desc'?'↓':'↕'}</div>);
}
const sortItems=(items,sort,dateKey='dueDate')=>{if(sort==='none')return items;return[...items].sort((a,b)=>{const da=new Date(a[dateKey]||'9999'),db=new Date(b[dateKey]||'9999');return sort==='asc'?da-db:db-da;});};
const nextSort=s=>s==='none'?'asc':s==='asc'?'desc':'none';

// ========== STATS BAR ==========
function StatsBar({data,language}){
  const stats=useMemo(()=>{
    const allT=[...(data.tasks||[]),...(data.quickTasks||[])];
    const done=allT.filter(t=>t.status==='complete').length;
    const prog=allT.filter(t=>t.status==='inProgress'||t.status==='partial').length;
    const pend=allT.filter(t=>!t.status||t.status==='notStarted').length;
    const total=allT.length;
    const pct=total?Math.round(done/total*100):0;
    const today=new Date();today.setHours(0,0,0,0);
    let streak=0;
    for(let i=0;i<365;i++){
      const d=new Date(today);d.setDate(d.getDate()-i);
      const ds=localDS(d);
      const dayDone=allT.some(t=>{if(t.status!=='complete')return false;const ul=t.updatedAt?localDS(new Date(t.updatedAt)):null;const cl=t.createdAt?localDS(new Date(t.createdAt)):null;return ul===ds||cl===ds||(t.dueDate||'').startsWith(ds);});
      if(dayDone)streak++;else if(i>0)break;
    }
    return{done,prog,pend,pct,streak};
  },[data.tasks,data.quickTasks]);
  return(<div className="stats-grid">
    <div className="stat-card"><span className="sv" style={{color:'var(--lime)'}}>{stats.done}</span><span className="sl">✅ {T('مكتمل','Done',language)}</span></div>
    <div className="stat-card"><span className="sv" style={{color:'var(--teal)'}}>{stats.prog}</span><span className="sl">⚡ {T('جارٍ','Active',language)}</span></div>
    <div className="stat-card"><span className="sv" style={{color:'var(--text2)'}}>{stats.pend}</span><span className="sl">⏳ {T('معلّق','Pending',language)}</span></div>
    <div className="stat-card"><span className="sv" style={{color:'var(--gold)'}}>{stats.pct}%</span><span className="sl">📊 {T('الإنجاز','Progress',language)}</span></div>
    <div className="stat-card"><span className="sv streak-badge" style={{fontSize:16,padding:'4px 10px',margin:'0 auto'}}>🔥 {stats.streak}</span><span className="sl">{T('أيام متتالية','Day streak',language)}</span></div>
  </div>);
}

// ========== WEEKLY CHART ==========
function WeeklyChart({data,language}){
  const allT=[...(data.tasks||[]),...(data.quickTasks||[])];
  const today=new Date();
  const bars=[];
  for(let i=6;i>=0;i--){
    const d=new Date(today);d.setDate(d.getDate()-i);
    const ds=localDS(d);
    const dayDue=allT.filter(t=>(t.dueDate||'').startsWith(ds));
    const dayCompleted=allT.filter(t=>{if(t.status!=='complete')return false;const ul=t.updatedAt?localDS(new Date(t.updatedAt)):null;return ul===ds||(!t.updatedAt&&t.dueDate&&t.dueDate.startsWith(ds));});
    const dn=d.toLocaleDateString(language==='ar'?'ar-SA':'en-US',{weekday:'short'});
    bars.push({label:dn,done:dayCompleted.length,total:Math.max(dayDue.length,dayCompleted.length),ds});
  }
  const maxV=Math.max(...bars.map(b=>Math.max(b.total,b.done)),1);
  return(<div className="card" style={{padding:14,marginBottom:16}}>
    <div style={{fontSize:13,fontWeight:800,marginBottom:10}}>📊 {T('إنجاز الأسبوع','This Week',language)}</div>
    <div className="chart-bar-wrap">{bars.map((b,i)=>(
      <div key={i} style={{flex:1,display:'flex',flexDirection:'column',alignItems:'center',gap:3}}>
        <div style={{width:'100%',height:80,display:'flex',flexDirection:'column',justifyContent:'flex-end',gap:1}}>
          <div className="chart-bar" data-tip={`${b.done}/${b.total}`} style={{height:`${b.total?b.done/maxV*100:0}%`,background:'var(--lime)',minHeight:b.done?4:0}}/>
          <div className="chart-bar" data-tip={`${b.total-b.done} ${T('متبقي','left',language)}`} style={{height:`${b.total?(b.total-b.done)/maxV*100:0}%`,background:'var(--bg3)',minHeight:b.total-b.done?4:0}}/>
        </div>
        <span style={{fontSize:10,color:'var(--text2)',fontWeight:600}}>{b.label}</span>
      </div>
    ))}</div>
  </div>);
}

// ========== POMODORO ==========
function Pomodoro({language}){
  const[open,setOpen]=useState(false);
  const[mode,setMode]=useState('work'); // work, break, longBreak
  const DURATIONS={work:25*60,break:5*60,longBreak:15*60};
  const[timeLeft,setTimeLeft]=useState(DURATIONS.work);
  const[running,setRunning]=useState(false);
  const[sessions,setSessions]=useState(0);
  const intRef=React.useRef(null);

  useEffect(()=>{
    if(running){
      intRef.current=setInterval(()=>{
        setTimeLeft(p=>{
          if(p<=1){
            clearInterval(intRef.current);setRunning(false);
            try{const ac=new(window.AudioContext||window.webkitAudioContext)();const o=ac.createOscillator();const g=ac.createGain();o.connect(g);g.connect(ac.destination);o.frequency.value=880;o.type='sine';g.gain.setValueAtTime(0.3,ac.currentTime);g.gain.exponentialRampToValueAtTime(0.01,ac.currentTime+0.8);o.start(ac.currentTime);o.stop(ac.currentTime+0.8);setTimeout(()=>{const o2=ac.createOscillator();const g2=ac.createGain();o2.connect(g2);g2.connect(ac.destination);o2.frequency.value=1100;o2.type='sine';g2.gain.setValueAtTime(0.3,ac.currentTime);g2.gain.exponentialRampToValueAtTime(0.01,ac.currentTime+0.5);o2.start(ac.currentTime);o2.stop(ac.currentTime+0.5);},300);}catch(e){}
            if(mode==='work'){const ns=sessions+1;setSessions(ns);setMode(ns%4===0?'longBreak':'break');setTimeLeft(ns%4===0?DURATIONS.longBreak:DURATIONS.break);}
            else{setMode('work');setTimeLeft(DURATIONS.work);}
            return 0;
          }
          return p-1;
        });
      },1000);
    }
    return()=>clearInterval(intRef.current);
  },[running,mode,sessions]);

  const reset=()=>{setRunning(false);setMode('work');setTimeLeft(DURATIONS.work);setSessions(0);};
  const switchMode=(m)=>{setRunning(false);setMode(m);setTimeLeft(DURATIONS[m]);};
  const min=Math.floor(timeLeft/60),sec=timeLeft%60;
  const pct=timeLeft/DURATIONS[mode];
  const r=62,c=2*Math.PI*r;
  const mc={work:'var(--coral)',break:'var(--lime)',longBreak:'var(--teal)'};
  const ml={work:T('تركيز','Focus',language),break:T('استراحة','Break',language),longBreak:T('استراحة طويلة','Long Break',language)};

  return(<div className="pomo-float">
    {!open&&<button className="pomo-mini" onClick={()=>setOpen(true)}>{running?`${min}:${String(sec).padStart(2,'0')}`:'🍅'}</button>}
    {open&&<div className="pomo-panel">
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:12}}>
        <span style={{fontWeight:800,fontSize:15}}>🍅 {T('بومودورو','Pomodoro',language)}</span>
        <button className="btn btn-ghost btn-icon-xs" onClick={()=>setOpen(false)}>✕</button>
      </div>
      <div style={{display:'flex',gap:4,marginBottom:14,justifyContent:'center'}}>
        {['work','break','longBreak'].map(m=>(<div key={m} className={`filter-chip ${mode===m?'active':''}`} style={mode===m?{borderColor:mc[m],background:`${mc[m]}22`,color:mc[m]}:{}} onClick={()=>switchMode(m)}>{ml[m]}</div>))}
      </div>
      <div className="pomo-ring">
        <svg width="140" height="140"><circle cx="70" cy="70" r={r} fill="none" stroke="var(--bg3)" strokeWidth="8"/><circle cx="70" cy="70" r={r} fill="none" stroke={mc[mode]} strokeWidth="8" strokeLinecap="round" strokeDasharray={c} strokeDashoffset={c*(1-pct)} style={{transition:'stroke-dashoffset .5s'}}/></svg>
        <div className="pomo-time"><span style={{color:mc[mode]}}>{min}:{String(sec).padStart(2,'0')}</span><span className="pomo-label">{ml[mode]}</span></div>
      </div>
      <div style={{display:'flex',gap:8,justifyContent:'center'}}>
        <button className="btn btn-sm" style={{background:running?'var(--gold-g)':'var(--coral)',color:running?'var(--gold)':'white',border:running?'1px solid var(--gold)':'none'}} onClick={()=>setRunning(!running)}>{running?'⏸ '+T('إيقاف','Pause',language):'▶ '+T('ابدأ','Start',language)}</button>
        <button className="btn btn-ghost btn-sm" onClick={reset}>🔄 {T('إعادة','Reset',language)}</button>
      </div>
      <div style={{textAlign:'center',marginTop:10,fontSize:12,color:'var(--text2)',fontWeight:600}}>🍅 {sessions} {T('جلسة','sessions',language)}</div>
    </div>}
  </div>);
}

// ========== SEARCH & FILTER ==========
function SearchFilter({language,search,onSearch,filter,onFilter}){
  return(<div>
    <div className="search-wrap"><span className="search-icon">🔍</span>
      <input className="field" style={{paddingRight:36,paddingLeft:36}} placeholder={T('بحث في المهام...','Search tasks...',language)} value={search} onChange={e=>onSearch(e.target.value)}/>
      {search&&<button className="clear-btn" onClick={()=>onSearch('')}>✕</button>}
    </div>
    <div className="filter-chips">
      {[{id:'all',l:T('الكل','All',language),ic:'📋'},{id:'notStarted',l:T('معلّق','Pending',language),ic:'⏳'},{id:'inProgress',l:T('جارٍ','Active',language),ic:'⚡'},{id:'complete',l:T('مكتمل','Done',language),ic:'✅'},{id:'blocked',l:T('محجوب','Blocked',language),ic:'🔒'}].map(f=>(
        <div key={f.id} className={`filter-chip ${filter===f.id?'active':''}`} onClick={()=>onFilter(f.id)}>{f.ic} {f.l}</div>
      ))}
    </div>
  </div>);
}

// ========== BACKUP REMINDER ==========
function BackupBar({language,onExport}){
  const lastExport=localStorage.getItem('gt-last-export');
  const daysSince=lastExport?Math.floor((Date.now()-new Date(lastExport).getTime())/(86400000)):999;
  if(daysSince<7)return null;
  return(<div className="backup-bar">
    <span>⚠️</span><span style={{flex:1}}>{daysSince>=999?T('لم تأخذ نسخة احتياطية بعد!','No backup yet!',language):T(`آخر نسخة من ${daysSince} يوم`,`Last backup ${daysSince} days ago`,language)}</span>
    <button className="btn btn-gold btn-xs" onClick={onExport}>💾 {T('نسخ الآن','Backup now',language)}</button>
  </div>);
}
// ========== CALENDAR EXPORT (.ics) ==========
function generateICS(data, language) {
  const T2 = (a,e) => language==='ar'?a:e;
  const pad = n => String(n).padStart(2,'0');
  const toICSDate = (ds, allDay) => {
    if (!ds) return null;
    const d = new Date(ds);
    if (isNaN(d)) return null;
    if (allDay) return d.toISOString().replace(/[-:]/g,'').split('T')[0];
    return d.toISOString().replace(/[-:]/g,'').replace(/\.\d{3}/,'');
  };
  let cal = [
    'BEGIN:VCALENDAR',
    'VERSION:2.0',
    'PRODID:-//GoalTracker//Ahmed//AR',
    'CALSCALE:GREGORIAN',
    'METHOD:PUBLISH',
    'X-WR-CALNAME:' + T2('متقن','Mutqin'),
    'X-WR-TIMEZONE:Asia/Riyadh',
  ];
  let count = 0;
  // Tasks
  [...(data.tasks||[]), ...(data.quickTasks||[])].forEach(tk => {
    if (!tk.dueDate) return;
    const dtStart = toICSDate(tk.dueDate + 'T09:00:00', false);
    const dtEnd = toICSDate(tk.dueDate + 'T09:30:00', false);
    if (!dtStart) return;
    const status = tk.status === 'complete' ? 'COMPLETED' : 'NEEDS-ACTION';
    const priority = tk.priority === 'high' ? '1' : tk.priority === 'medium' ? '5' : '9';
    cal.push('BEGIN:VEVENT');
    cal.push('UID:gt-' + (tk.id||count) + '@goaltracker');
    cal.push('DTSTART:' + dtStart);
    cal.push('DTEND:' + dtEnd);
    cal.push('SUMMARY:' + (tk.icon||'✅') + ' ' + (tk.title||''));
    const descParts = [];
    if (tk.description) descParts.push(tk.description.replace(/\n/g,'\\n'));
    if (tk.notes) descParts.push('📝 ' + tk.notes.replace(/\n/g,'\\n'));
    if (descParts.length) cal.push('DESCRIPTION:' + descParts.join('\\n\\n'));
    cal.push('STATUS:' + status);
    cal.push('PRIORITY:' + priority);
    cal.push('BEGIN:VALARM');
    cal.push('TRIGGER:-PT15M');
    cal.push('ACTION:DISPLAY');
    cal.push('DESCRIPTION:' + T2('⏰ موعد المهمة: ','⏰ Task due: ') + tk.title);
    cal.push('END:VALARM');
    cal.push('BEGIN:VALARM');
    cal.push('TRIGGER:-PT60M');
    cal.push('ACTION:DISPLAY');
    cal.push('DESCRIPTION:' + T2('📋 بعد ساعة: ','📋 In 1 hour: ') + tk.title);
    cal.push('END:VALARM');
    cal.push('END:VEVENT');
    count++;
  });
  // Meetings
  (data.meetings||[]).forEach(mt => {
    if (!mt.meetingDate) return;
    const dtStart = toICSDate(mt.meetingDate, false);
    const end = new Date(mt.meetingDate);
    end.setHours(end.getHours() + 1);
    const dtEnd = toICSDate(end.toISOString(), false);
    if (!dtStart) return;
    cal.push('BEGIN:VEVENT');
    cal.push('UID:gt-m-' + (mt.id||count) + '@goaltracker');
    cal.push('DTSTART:' + dtStart);
    cal.push('DTEND:' + dtEnd);
    cal.push('SUMMARY:' + (mt.icon||'👥') + ' ' + (mt.title||''));
    const mDescParts = [];
    if (mt.description) mDescParts.push(mt.description.replace(/\n/g,'\\n'));
    if (mt.notes) mDescParts.push('📝 ' + mt.notes.replace(/\n/g,'\\n'));
    if (mt.attendees) mDescParts.push('👥 ' + mt.attendees);
    if (mDescParts.length) cal.push('DESCRIPTION:' + mDescParts.join('\\n\\n'));
    if (mt.location) cal.push('LOCATION:' + mt.location);
    cal.push('BEGIN:VALARM');
    cal.push('TRIGGER:-PT15M');
    cal.push('ACTION:DISPLAY');
    cal.push('DESCRIPTION:' + T2('⏰ موعد الاجتماع: ','⏰ Meeting: ') + mt.title);
    cal.push('END:VALARM');
    cal.push('BEGIN:VALARM');
    cal.push('TRIGGER:-PT30M');
    cal.push('ACTION:DISPLAY');
    cal.push('DESCRIPTION:' + T2('📋 بعد نص ساعة: ','📋 In 30 min: ') + mt.title);
    cal.push('END:VALARM');
    cal.push('END:VEVENT');
    count++;
  });
  // Milestones
  (data.milestones||[]).forEach(ms => {
    if (!ms.dueDate) return;
    const dtVal = toICSDate(ms.dueDate, true);
    if (!dtVal) return;
    cal.push('BEGIN:VEVENT');
    cal.push('UID:gt-ms-' + (ms.id||count) + '@goaltracker');
    cal.push('DTSTART;VALUE=DATE:' + dtVal);
    cal.push('SUMMARY:🏁 ' + (ms.icon||'📍') + ' ' + (ms.title||''));
    if (ms.description) cal.push('DESCRIPTION:' + ms.description.replace(/\n/g,'\\n'));
    cal.push('BEGIN:VALARM');
    cal.push('TRIGGER:-PT120M');
    cal.push('ACTION:DISPLAY');
    cal.push('DESCRIPTION:' + T2('📍 اليوم موعد المرحلة: ','📍 Milestone today: ') + ms.title);
    cal.push('END:VALARM');
    cal.push('END:VEVENT');
    count++;
  });
  cal.push('END:VCALENDAR');
  return { content: cal.join('\r\n'), count };
}

// ========== XLSX PARSER ==========
function parseXlsx(data) {
  const wb = XLSX.read(data, { type: 'array', cellDates: true });
  const result = { goals: [], milestones: [], tasks: [], quickTasks: [], meetings: [], taskLists: [] };
  const now = new Date().toISOString();
  const fmtDate = v => { if (!v) return ''; if (v instanceof Date) return localDS(v); const s = String(v).trim(); if (/^\d{4}-\d{2}-\d{2}/.test(s)) return s.substring(0, 10); return s; };
  const fmtDateTime = v => { if (!v) return ''; if (v instanceof Date) return v.toISOString().substring(0, 16); const s = String(v).trim(); if (/^\d{4}-\d{2}-\d{2}/.test(s)) return s.substring(0, 16).replace(' ', 'T'); return s; };
  const str = v => v ? String(v).trim() : '';

  // Goals sheet
  const gs = wb.Sheets['Goals'];
  if (gs) {
    const rows = XLSX.utils.sheet_to_json(gs).slice(1);
    rows.forEach(r => {
      const title = str(r['Title *'] || r['Title']);
      if (!title) return;
      result.goals.push({ id: uid(), title, description: str(r['Description']), icon: str(r['Icon']) || '🎯', color: str(r['Color']) || '#FF6B6B', startDate: fmtDate(r['Start Date']), endDate: fmtDate(r['End Date']), createdAt: now });
    });
  }

  // Milestones sheet
  const ms = wb.Sheets['Milestones'];
  if (ms) {
    const rows = XLSX.utils.sheet_to_json(ms).slice(1);
    rows.forEach(r => {
      const title = str(r['Title *'] || r['Title']);
      const goalTitle = str(r['Goal Title *'] || r['Goal Title']);
      if (!title) return;
      const goal = result.goals.find(g => g.title === goalTitle);
      result.milestones.push({ id: uid(), title, description: str(r['Description']), icon: str(r['Icon']) || '📍', goalId: goal ? goal.id : '', dueDate: fmtDate(r['Due Date']), createdAt: now });
    });
  }

  // Tasks sheet
  const ts = wb.Sheets['Tasks'];
  if (ts) {
    const rows = XLSX.utils.sheet_to_json(ts).slice(1);
    rows.forEach(r => {
      const title = str(r['Title *'] || r['Title']);
      const msTitle = str(r['Milestone Title *'] || r['Milestone Title']);
      if (!title) return;
      const milestone = result.milestones.find(m => m.title === msTitle);
      result.tasks.push({ id: uid(), title, description: str(r['Description']), icon: str(r['Icon']) || '✅', milestoneId: milestone ? milestone.id : '', dueDate: fmtDate(r['Due Date']), priority: str(r['Priority']) || 'medium', status: str(r['Status']) || 'notStarted', repeat: str(r['Repeat']) || 'never', repeatStartDate: fmtDate(r['Repeat Start']), repeatEndDate: fmtDate(r['Repeat End']), createdAt: now });
    });
  }

  // Quick Tasks sheet
  const qt = wb.Sheets['Quick Tasks'];
  if (qt) {
    const rows = XLSX.utils.sheet_to_json(qt).slice(1);
    rows.forEach(r => {
      const title = str(r['Title *'] || r['Title']);
      if (!title) return;
      result.quickTasks.push({ id: uid(), title, description: str(r['Description']), icon: str(r['Icon']) || '✅', dueDate: fmtDate(r['Due Date']), priority: str(r['Priority']) || 'medium', status: str(r['Status']) || 'notStarted', createdAt: now });
    });
  }

  // Meetings sheet
  const mt = wb.Sheets['Meetings'];
  if (mt) {
    const rows = XLSX.utils.sheet_to_json(mt).slice(1);
    rows.forEach(r => {
      const title = str(r['Title *'] || r['Title']);
      if (!title) return;
      result.meetings.push({ id: uid(), title, description: str(r['Description']), icon: str(r['Icon']) || '👥', meetingDate: fmtDateTime(r['Date & Time']), attendees: str(r['Attendees']), location: str(r['Location']), createdAt: now });
    });
  }

  // Task Lists sheet
  const tl = wb.Sheets['Task Lists'];
  if (tl) {
    const rows = XLSX.utils.sheet_to_json(tl).slice(1);
    rows.forEach(r => {
      const name = str(r['List Name *'] || r['List Name']);
      if (!name) return;
      const items = [];
      for (let i = 1; i <= 8; i++) {
        const val = str(r['Item ' + i]);
        if (val) items.push({ id: uid(), title: val, checked: false, createdAt: now });
      }
      result.taskLists.push({ id: uid(), name, icon: str(r['Icon']) || '📋', color: str(r['Color']) || '#FF6B6B', items, createdAt: now });
    });
  }

  return result;
}

// ========== Small Components ==========
function Toasts({toasts,onDismiss}){const c={success:'var(--lime)',error:'var(--coral)',warning:'var(--gold)',info:'var(--teal)'};const ic={success:'✅',error:'💥',warning:'⚡',info:'💡'};return(<div style={{position:'fixed',top:16,left:16,right:16,zIndex:100,display:'flex',flexDirection:'column',gap:8,pointerEvents:'none',maxWidth:380}}>{toasts.map(t=>(<div key={t.id} className="toast-item" onClick={()=>onDismiss(t.id)} style={{background:'var(--bg2)',border:`2px solid ${c[t.type]}`,borderRadius:16,padding:'12px 16px',display:'flex',alignItems:'center',gap:10,pointerEvents:'auto',cursor:'pointer',boxShadow:`0 8px 30px ${c[t.type]}33`}}><span style={{fontSize:20}}>{ic[t.type]}</span><span style={{flex:1,fontSize:13,fontWeight:600}}>{t.message}</span></div>))}</div>);}

function Confirm({message,language,onOk,onCancel}){return(<div className="overlay" onClick={onCancel} style={{zIndex:60}}><div className="modal" onClick={e=>e.stopPropagation()} style={{maxWidth:400,padding:28,borderRadius:24}}><p style={{fontSize:16,fontWeight:600,lineHeight:1.7,marginBottom:24}}>{message}</p><div style={{display:'flex',gap:10,justifyContent:'flex-end'}}><button className="btn btn-ghost" onClick={onCancel}>{T('إلغاء','Cancel',language)}</button><button className="btn btn-coral" onClick={onOk}>{T('تأكيد','Confirm',language)}</button></div></div></div>);}

function IconPick({icons,sel,onSel}){return(<div style={{display:'flex',flexWrap:'wrap',gap:5,maxHeight:140,overflowY:'auto',padding:4,borderRadius:12,border:'1px solid var(--border)',background:'var(--bg)'}}>{icons.map(i=>(<div key={i} onClick={()=>onSel(i)} style={{width:38,height:38,display:'flex',alignItems:'center',justifyContent:'center',borderRadius:10,cursor:'pointer',fontSize:18,background:sel===i?'var(--coral)':'transparent',border:`2px solid ${sel===i?'var(--coral)':'transparent'}`,transition:'all .15s'}}>{i}</div>))}</div>);}
function ColPick({sel,onSel}){return(<div style={{display:'flex',flexWrap:'wrap',gap:8}}>{COLS.map(c=>(<div key={c} onClick={()=>onSel(c)} style={{width:34,height:34,borderRadius:'50%',background:c,cursor:'pointer',border:sel===c?'3px solid white':'3px solid transparent',boxShadow:sel===c?`0 0 15px ${c}66`:'none',transition:'all .2s'}}/>))}</div>);}
function Prog({progress,size=50,sw=4,color='var(--coral)'}){const r=(size-sw)/2,ci=2*Math.PI*r,off=ci-(progress/100)*ci;return(<svg width={size} height={size} className="progress-ring"><circle cx={size/2} cy={size/2} r={r} fill="none" stroke="var(--border)" strokeWidth={sw}/><circle cx={size/2} cy={size/2} r={r} fill="none" stroke={color} strokeWidth={sw} strokeDasharray={ci} strokeDashoffset={off} strokeLinecap="round" style={{transition:'stroke-dashoffset .6s cubic-bezier(.4,0,.2,1)'}}/><text x="50%" y="50%" textAnchor="middle" dy=".35em" fill="var(--text)" fontSize={size*.22} fontWeight="800" style={{transform:'rotate(90deg)',transformOrigin:'center'}}>{Math.round(progress)}%</text></svg>);}

// ========== UPLOAD MODAL ==========
function UploadModal({ language, onImport, onClose }) {
  const [dragOver, setDragOver] = useState(false);
  const [result, setResult] = useState(null);
  const [error, setError] = useState('');
  const [importing, setImporting] = useState(false);
  const fileRef = React.useRef();

  const processFile = (file) => {
    if (!file) return;
    const ext = file.name.split('.').pop().toLowerCase();
    if (!['xlsx', 'xls', 'csv'].includes(ext)) {
      setError(T('يرجى رفع ملف Excel (.xlsx)','Please upload an Excel file (.xlsx)', language));
      return;
    }
    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const parsed = parseXlsx(new Uint8Array(e.target.result));
        setResult(parsed);
        setError('');
      } catch (err) {
        setError(T('خطأ في قراءة الملف: ' + err.message, 'Error reading file: ' + err.message, language));
      }
    };
    reader.readAsArrayBuffer(file);
  };

  const handleDrop = (e) => { e.preventDefault(); setDragOver(false); processFile(e.dataTransfer.files[0]); };
  const handleConfirm = async () => {
    setImporting(true);
    await onImport(result);
    setImporting(false);
  };

  const total = result ? Object.values(result).reduce((s, a) => s + a.length, 0) : 0;

  return (
    <div className="overlay" onClick={onClose}>
      <div className="modal" onClick={e => e.stopPropagation()} style={{ maxWidth: 520 }}>
        <div style={{ padding: '20px 24px', borderBottom: '1px solid var(--border)', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
          <h3 style={{ fontSize: 18, fontWeight: 800 }}>📂 {T('استيراد من ملف Excel', 'Import from Excel File', language)}</h3>
          <button className="btn btn-ghost btn-icon-sm" onClick={onClose}>✕</button>
        </div>

        <div style={{ padding: 24 }}>
          {!result ? (
            <>
              <div className={`drop-zone ${dragOver ? 'dragover' : ''}`}
                onDragOver={e => { e.preventDefault(); setDragOver(true); }}
                onDragLeave={() => setDragOver(false)}
                onDrop={handleDrop}
                onClick={() => fileRef.current.click()}>
                <input ref={fileRef} type="file" accept=".xlsx,.xls,.csv" style={{ display: 'none' }} onChange={e => processFile(e.target.files[0])} />
                <div style={{ fontSize: 48, marginBottom: 12 }}>📄</div>
                <p style={{ fontWeight: 700, fontSize: 15, marginBottom: 6 }}>{T('اسحب الملف هنا أو انقر للاختيار', 'Drag file here or click to browse', language)}</p>
                <p style={{ fontSize: 12, color: 'var(--text2)' }}>{T('يدعم ملفات .xlsx فقط', 'Supports .xlsx files only', language)}</p>
              </div>
              {error && <p style={{ color: 'var(--coral)', marginTop: 12, fontSize: 13, fontWeight: 600 }}>💥 {error}</p>}
              <div style={{ marginTop: 20, padding: 16, background: 'var(--bg)', borderRadius: 14, border: '1px solid var(--border)' }}>
                <p style={{ fontSize: 13, fontWeight: 700, color: 'var(--gold)', marginBottom: 8 }}>💡 {T('تلميح', 'Tip', language)}</p>
                <p style={{ fontSize: 12, color: 'var(--text2)', lineHeight: 1.7 }}>
                  {T('استخدم القالب الذي يمكنك تحميله من أدوات التصدير (📋). القالب يحتوي على أوراق منفصلة لكل نوع: الأهداف، المراحل، المهام، المهام السريعة، الاجتماعات، والقوائم.',
                    'Use the template downloadable from export tools (📋). The template has separate sheets for: Goals, Milestones, Tasks, Quick Tasks, Meetings, and Task Lists.',
                    language)}
                </p>
              </div>
            </>
          ) : (
            <>
              <div style={{ textAlign: 'center', marginBottom: 20 }}>
                <div style={{ fontSize: 48, marginBottom: 8 }}>🎉</div>
                <p style={{ fontWeight: 800, fontSize: 16 }}>{T('تم تحليل الملف بنجاح!', 'File parsed successfully!', language)}</p>
                <p style={{ fontSize: 13, color: 'var(--text2)', marginTop: 4 }}>{total} {T('عناصر جاهزة للاستيراد', 'items ready to import', language)}</p>
              </div>
              <div className="upload-stats">
                {[
                  { key: 'goals', icon: '🎯', label: T('أهداف', 'Goals', language), color: 'var(--coral)' },
                  { key: 'milestones', icon: '📍', label: T('مراحل', 'Milestones', language), color: 'var(--gold)' },
                  { key: 'tasks', icon: '📝', label: T('مهام', 'Tasks', language), color: 'var(--teal)' },
                  { key: 'quickTasks', icon: '✅', label: T('سريعة', 'Quick', language), color: 'var(--electric)' },
                  { key: 'meetings', icon: '👥', label: T('اجتماعات', 'Meetings', language), color: 'var(--pink)' },
                  { key: 'taskLists', icon: '📋', label: T('قوائم', 'Lists', language), color: 'var(--lime)' },
                ].map(s => (
                  <div key={s.key} className="stat-chip">
                    <span className="num" style={{ color: s.color }}>{result[s.key].length}</span>
                    <span className="lbl">{s.icon} {s.label}</span>
                  </div>
                ))}
              </div>
              <button className="btn btn-ghost btn-sm" style={{ marginTop: 12 }} onClick={() => { setResult(null); setError(''); }}>
                🔄 {T('اختيار ملف آخر', 'Choose another file', language)}
              </button>
            </>
          )}
        </div>

        <div style={{ padding: '16px 24px', borderTop: '1px solid var(--border)', display: 'flex', gap: 10, justifyContent: 'flex-end' }}>
          <button className="btn btn-ghost" onClick={onClose}>{T('إلغاء', 'Cancel', language)}</button>
          {result && <button className="btn btn-teal" onClick={handleConfirm} disabled={importing}>
            {importing ? '⏳...' : `✨ ${T('استيراد ' + total + ' عنصر', 'Import ' + total + ' items', language)}`}
          </button>}
        </div>
      </div>
    </div>
  );
}

// ========== ITEM MODAL ==========
function ItemModal({type,editItem,goalId,milestoneId,language,onSave,onClose,allTasks}){
  const isE=editItem&&editItem.id;
  const defs={goal:{title:'',description:'',icon:'🎯',color:'#FF6B6B',startDate:localDS(),endDate:''},milestone:{title:'',description:'',icon:'📍',dueDate:''},task:{title:'',description:'',icon:'✅',dueDate:'',priority:'medium',status:'notStarted',repeat:'never',repeatStartDate:'',repeatEndDate:'',notes:'',blockedBy:''},quickTask:{title:'',description:'',icon:'✅',dueDate:'',priority:'medium',status:'notStarted',notes:''},meeting:{title:'',description:'',icon:'👥',meetingDate:'',attendees:'',location:'',notes:'',minutes:'',decisions:''}};
  const[f,setF]=useState({...defs[type],...(editItem||{})});const u=(k,v)=>setF(p=>({...p,[k]:v}));
  const save=()=>{if(!f.title.trim())return;const now=new Date().toISOString();let item=isE?{...f,updatedAt:now}:{...f,id:uid(),createdAt:now};if(type==='task'&&!isE)item.milestoneId=milestoneId;if(type==='milestone'&&!isE)item.goalId=goalId;onSave(type,item);};
  const ic=type==='goal'?ICONS.goals:type==='milestone'?ICONS.milestones:type==='meeting'?ICONS.meetings:ICONS.tasks;
  const tn={goal:T('هدف','Goal',language),milestone:T('مرحلة','Milestone',language),task:T('مهمة','Task',language),quickTask:T('مهمة سريعة','Quick Task',language),meeting:T('اجتماع','Meeting',language)};
  const depOptions=(allTasks||[]).filter(t=>t.id!==f.id);
  return(
    <div className="overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()}>
      <div style={{padding:'20px 24px',borderBottom:'1px solid var(--border)',display:'flex',justifyContent:'space-between',alignItems:'center'}}><h3 style={{fontSize:18,fontWeight:800}}>{isE?'✏️':'✨'} {isE?T('تعديل','Edit',language):T('إضافة','Add',language)} {tn[type]}</h3><button className="btn btn-ghost btn-icon-sm" onClick={onClose}>✕</button></div>
      <div style={{padding:'20px 24px',display:'flex',flexDirection:'column',gap:16,maxHeight:'60dvh',overflowY:'auto'}}>
        <div><span className="label">{T('الأيقونة','Icon',language)}</span><IconPick icons={ic} sel={f.icon} onSel={v=>u('icon',v)}/></div>
        <div><span className="label">{T('العنوان','Title',language)} *</span><input className="field" value={f.title} onChange={e=>u('title',e.target.value)} autoFocus/></div>
        <div><span className="label">{T('الوصف','Description',language)}</span><textarea className="field" rows={2} value={f.description} onChange={e=>u('description',e.target.value)}/></div>
        {type==='goal'&&<><div><span className="label">{T('اللون','Color',language)}</span><ColPick sel={f.color} onSel={v=>u('color',v)}/></div><div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:12}}><div><span className="label">{T('البدء','Start',language)}</span><input type="date" className="field" value={f.startDate} onChange={e=>u('startDate',e.target.value)}/></div><div><span className="label">{T('الانتهاء','End',language)}</span><input type="date" className="field" value={f.endDate} onChange={e=>u('endDate',e.target.value)}/></div></div></>}
        {type==='milestone'&&<div><span className="label">{T('التاريخ','Due',language)}</span><input type="date" className="field" value={f.dueDate||''} onChange={e=>u('dueDate',e.target.value)}/></div>}
        {(type==='task'||type==='quickTask')&&<><div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:12}}><div><span className="label">{T('التاريخ','Due',language)}</span><input type="date" className="field" value={f.dueDate||''} onChange={e=>u('dueDate',e.target.value)}/></div><div><span className="label">{T('الأولوية','Priority',language)}</span><select className="field" value={f.priority} onChange={e=>u('priority',e.target.value)}><option value="low">🟢 {T('منخفضة','Low',language)}</option><option value="medium">🟡 {T('متوسطة','Medium',language)}</option><option value="high">🔴 {T('عالية','High',language)}</option></select></div></div>{type==='task'&&<><div><span className="label">{T('التكرار','Repeat',language)}</span><select className="field" value={f.repeat||'never'} onChange={e=>u('repeat',e.target.value)}><option value="never">{T('بدون','Never',language)}</option><option value="daily">🔄 {T('يومياً','Daily',language)}</option><option value="weekly">🔄 {T('أسبوعياً','Weekly',language)}</option><option value="monthly">🔄 {T('شهرياً','Monthly',language)}</option></select>{f.repeat&&f.repeat!=='never'&&<div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:12,marginTop:12}}><div><span className="label" style={{fontSize:11}}>{T('من','From',language)}</span><input type="date" className="field" value={f.repeatStartDate||''} onChange={e=>u('repeatStartDate',e.target.value)}/></div><div><span className="label" style={{fontSize:11}}>{T('إلى','To',language)}</span><input type="date" className="field" value={f.repeatEndDate||''} onChange={e=>u('repeatEndDate',e.target.value)}/></div></div>}</div>
        {depOptions.length>0&&<div><span className="label">🔗 {T('محجوب بواسطة','Blocked by',language)}</span><select className="field" value={f.blockedBy||''} onChange={e=>u('blockedBy',e.target.value)}><option value="">{T('بدون','None',language)}</option>{depOptions.map(t=>(<option key={t.id} value={t.id}>{t.icon} {t.title}</option>))}</select></div>}</>}</>}
        {type==='meeting'&&<><div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:12}}><div><span className="label">📅 {T('التاريخ','Date',language)}</span><input type="date" className="field" value={(f.meetingDate||'').slice(0,10)} onChange={e=>{const time=(f.meetingDate||'').includes('T')?(f.meetingDate.split('T')[1]||'09:00'):'09:00';u('meetingDate',e.target.value+'T'+time);}}/></div><div><span className="label">🕐 {T('الوقت','Time',language)}</span><input type="time" className="field" value={(f.meetingDate||'').includes('T')?(f.meetingDate.split('T')[1]||'09:00'):''} onChange={e=>{const date=(f.meetingDate||'').slice(0,10)||localDS();u('meetingDate',date+'T'+e.target.value);}}/></div></div><div><span className="label">{T('الحضور','Attendees',language)}</span><input className="field" value={f.attendees||''} onChange={e=>u('attendees',e.target.value)} placeholder={T('أحمد، محمد، علي','Ahmed, Mohamed, Ali',language)}/></div><div><span className="label">{T('الموقع','Location',language)}</span><input className="field" value={f.location||''} onChange={e=>u('location',e.target.value)}/></div><div><span className="label">📋 {T('محضر الاجتماع','Meeting Minutes',language)}</span><textarea className="field" rows={5} value={f.minutes||''} onChange={e=>u('minutes',e.target.value)} placeholder={T('اكتب محضر الاجتماع هنا — النقاط اللي اتناقشت والتفاصيل...','Write meeting minutes here — points discussed and details...',language)} style={{lineHeight:1.8}}/></div><div><span className="label">✅ {T('القرارات والإجراءات','Decisions & Actions',language)}</span><textarea className="field" rows={3} value={f.decisions||''} onChange={e=>u('decisions',e.target.value)} placeholder={T('القرارات اللي اتاخذت والمهام المطلوبة...','Decisions taken and action items...',language)} style={{lineHeight:1.8}}/></div></>}
        <div><span className="label">📝 {T('ملاحظات','Notes',language)}</span><textarea className="field" rows={3} placeholder={T('أضف ملاحظاتك هنا...','Add your notes here...',language)} value={f.notes||''} onChange={e=>u('notes',e.target.value)}/></div>
      </div>
      <div style={{padding:'16px 24px',borderTop:'1px solid var(--border)',display:'flex',gap:10,justifyContent:'flex-end'}}><button className="btn btn-ghost" onClick={onClose}>{T('إلغاء','Cancel',language)}</button><button className="btn btn-teal" onClick={save}>{isE?T('💾 حفظ','💾 Save',language):T('✨ إضافة','✨ Add',language)}</button></div>
    </div></div>);
}

function ListModal({editList,language,onSave,onClose}){const isE=editList&&editList.id;const[f,setF]=useState({name:'',icon:'🛒',color:'#FF6B6B',items:[],...(isE?editList:{})});const save=()=>{if(!f.name.trim())return;const now=new Date().toISOString();onSave(isE?{...f,updatedAt:now}:{...f,id:uid(),createdAt:now,items:[]});};return(<div className="overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()} style={{maxWidth:420,padding:28,borderRadius:24}}><h3 style={{fontSize:18,fontWeight:800,marginBottom:20}}>{isE?'✏️':'📋'} {isE?T('تعديل','Edit',language):T('قائمة جديدة','New List',language)}</h3><div style={{display:'flex',flexDirection:'column',gap:16}}><div><span className="label">{T('الأيقونة','Icon',language)}</span><IconPick icons={ICONS.lists} sel={f.icon} onSel={v=>setF({...f,icon:v})}/></div><div><span className="label">{T('الاسم','Name',language)} *</span><input className="field" value={f.name} onChange={e=>setF({...f,name:e.target.value})} autoFocus/></div><div><span className="label">{T('اللون','Color',language)}</span><ColPick sel={f.color} onSel={v=>setF({...f,color:v})}/></div></div><div style={{display:'flex',gap:10,justifyContent:'flex-end',marginTop:24}}><button className="btn btn-ghost" onClick={onClose}>{T('إلغاء','Cancel',language)}</button><button className="btn btn-teal" onClick={save}>{isE?T('💾 حفظ','💾 Save',language):T('✨ إضافة','✨ Add',language)}</button></div></div></div>);}

// ========== CALENDAR ==========
function Cal({language,data,onDayClick}){const[cur,setCur]=useState(new Date());const y=cur.getFullYear(),m=cur.getMonth();const first=new Date(y,m,1).getDay(),days=new Date(y,m+1,0).getDate();const today=new Date(),tStr=localDS(today);const hdr=useMemo(()=>hijriHeader(y,m,language),[y,m,language]);const mN=cur.toLocaleDateString(language==='ar'?'ar-SA':'en-US',{month:'long',year:'numeric'});const iFor=useCallback(ds=>{const r=[];(data.tasks||[]).forEach(x=>{if(x.dueDate&&x.dueDate.startsWith(ds))r.push({...x,_type:'task'});});(data.quickTasks||[]).forEach(x=>{if(x.dueDate&&x.dueDate.startsWith(ds))r.push({...x,_type:'quickTask'});});(data.meetings||[]).forEach(x=>{if(x.meetingDate&&x.meetingDate.startsWith(ds))r.push({...x,_type:'meeting'});});return r;},[data]);const dn=language==='ar'?['أحد','إثن','ثلا','أرب','خمي','جمع','سبت']:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];const cells=[];for(let i=0;i<first;i++)cells.push(null);for(let d=1;d<=days;d++)cells.push(d);return(<div className="card" style={{padding:'16px 12px'}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:14,padding:'0 4px'}}><button className="btn btn-ghost btn-icon-sm" onClick={()=>setCur(new Date(y,m-1,1))} style={{fontSize:16}}>{language==='ar'?'▶':'◀'}</button><div style={{textAlign:'center'}}><div style={{fontSize:16,fontWeight:800,color:'var(--coral)'}}>📅 {mN}</div><div style={{fontSize:12,color:'var(--gold)',fontWeight:600}}>🌙 {hdr}</div></div><button className="btn btn-ghost btn-icon-sm" onClick={()=>setCur(new Date(y,m+1,1))} style={{fontSize:16}}>{language==='ar'?'◀':'▶'}</button></div><div style={{display:'grid',gridTemplateColumns:'repeat(7,1fr)',gap:3}}>{dn.map((d,i)=>(<div key={i} style={{textAlign:'center',fontSize:11,fontWeight:700,color:'var(--text2)',padding:'4px 0'}}>{d}</div>))}{cells.map((day,i)=>{if(!day)return<div key={'e'+i}/>;const ds=`${y}-${String(m+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;const isT=ds===tStr,items=iFor(ds),has=items.length>0;const h=toH(y,m+1,day);return(<div key={day} className="cal-cell" onClick={()=>onDayClick(ds,items)} style={{background:isT?'linear-gradient(135deg,var(--coral),#EE5A24)':has?'var(--bg3)':'transparent',boxShadow:isT?'0 4px 15px var(--coral-g)':'none'}}><span style={{fontSize:14,fontWeight:isT?800:500,color:isT?'white':'var(--text)'}}>{day}</span><span className="hidden md:block" style={{fontSize:9,color:isT?'rgba(255,255,255,.7)':'var(--text2)',fontWeight:600}}>{h.day}</span>{has&&!isT&&<div className="glow-dot" style={{background:'var(--teal)',boxShadow:'0 0 6px var(--teal-g)'}}/>}{has&&isT&&<div style={{width:6,height:6,borderRadius:'50%',background:'white'}}/>}</div>);})}</div></div>);}

function DayMod({dateStr,items,language,onClose,onAddTask,onAddMeeting,onAddExpense,onStatus,onReorder}){const d=new Date(dateStr+'T00:00:00');const fmt=d.toLocaleDateString(language==='ar'?'ar-SA':'en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'});const h=toH(d.getFullYear(),d.getMonth()+1,d.getDate());const hName=language==='ar'?h.monthName_ar:h.monthName_en;
const[daySort,setDaySort]=useState('none');
const sc={complete:'var(--lime)',inProgress:'var(--teal)',partial:'var(--gold)',notStarted:'var(--text2)'};
const sl={complete:T('مكتمل','Done',language),inProgress:T('جارٍ','Active',language),partial:T('جزئي','Partial',language),notStarted:T('لم يبدأ','Todo',language)};
const ns4={notStarted:'inProgress',inProgress:'partial',partial:'complete',complete:'notStarted'};
const ns3={notStarted:'inProgress',inProgress:'complete',complete:'notStarted'};
const toggleStatus=(it)=>{const store=it._type==='task'?'tasks':it._type==='quickTask'?'quickTasks':null;if(!store)return;const nsMap=store==='tasks'?ns4:ns3;onStatus(store,it,nsMap[it.status||'notStarted']);};
const getDateKey=(it)=>it._type==='meeting'?'meetingDate':'dueDate';
const sorted=daySort==='none'?sortByOrder(items):[...items].sort((a,b)=>{const da=new Date(a[getDateKey(a)]||'9999'),db=new Date(b[getDateKey(b)]||'9999');return daySort==='asc'?da-db:db-da;});
return(<div className="overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()}><div style={{padding:'20px 24px',borderBottom:'1px solid var(--border)'}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><div><h3 style={{fontSize:16,fontWeight:800}}>{fmt}</h3><p style={{fontSize:12,color:'var(--gold)',fontWeight:600}}>🌙 {h.day} {hName} {h.year}</p></div><button className="btn btn-ghost btn-icon-sm" onClick={onClose}>✕</button></div><div style={{display:'flex',gap:8,marginTop:14,flexWrap:'wrap'}}><button className="btn btn-teal btn-sm" onClick={()=>onAddTask(dateStr)}>✅ {T('+ مهمة','+ Task',language)}</button><button className="btn btn-pink btn-sm" onClick={()=>onAddMeeting(dateStr)}>👥 {T('+ اجتماع','+ Meeting',language)}</button>{onAddExpense&&<button className="btn btn-coral btn-sm" onClick={()=>onAddExpense(dateStr)}>💰 {T('+ مصروف','+ Expense',language)}</button>}<SortBtn sort={daySort} onToggle={()=>setDaySort(s=>nextSort(s))} language={language}/></div></div><div style={{padding:20,maxHeight:'50dvh',overflowY:'auto'}}>{sorted.length===0?(<p style={{textAlign:'center',color:'var(--text2)',padding:30,fontSize:14}}>🫥 {T('لا توجد عناصر','No items',language)}</p>):(
<DragList items={sorted} onReorder={arr=>{
  const byStore={};
  arr.forEach((it,i)=>{const s=it._type==='task'?'tasks':it._type==='quickTask'?'quickTasks':'meetings';if(!byStore[s])byStore[s]=[];byStore[s].push({...it,sortOrder:i});});
  Object.entries(byStore).forEach(([s,items])=>onReorder(s,items));
}} renderItem={(it,i,dragHandle)=>{const isMeeting=it._type==='meeting';const status=it.status||'notStarted';return(
<div style={{display:'flex',alignItems:'center',gap:10,padding:'12px 0',borderBottom:'1px solid var(--border)'}}>
{dragHandle}
{!isMeeting&&<div onClick={()=>toggleStatus(it)} style={{width:28,height:28,borderRadius:8,border:`2px solid ${sc[status]}`,background:status==='complete'?sc.complete:'transparent',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:14,color:'white',fontWeight:900,flexShrink:0,transition:'all .2s'}}>{status==='complete'&&'✓'}</div>}
<span style={{fontSize:22}}>{it.icon||(isMeeting?'👥':'✅')}</span>
<div style={{flex:1,minWidth:0}}><div style={{fontWeight:700,fontSize:14,textDecoration:status==='complete'&&!isMeeting?'line-through':'none',opacity:status==='complete'&&!isMeeting?.5:1}}>{it.title}</div>
{isMeeting&&it.location&&<div style={{fontSize:12,color:'var(--text2)'}}>📍 {it.location}</div>}
{isMeeting&&it.meetingDate&&<div style={{fontSize:12,color:'var(--text2)'}}>🕐 {new Date(it.meetingDate).toLocaleTimeString(language==='ar'?'ar-SA':'en-US',{hour:'2-digit',minute:'2-digit'})}</div>}
{!isMeeting&&<div style={{display:'flex',gap:4,marginTop:4}}><span className="badge" style={{background:`${sc[status]}22`,color:sc[status]}}>{sl[status]}</span>{it.priority&&<span className="badge" style={{background:`${{high:'var(--coral)',medium:'var(--gold)',low:'var(--lime)'}[it.priority]}22`,color:{high:'var(--coral)',medium:'var(--gold)',low:'var(--lime)'}[it.priority]}}>{it.priority==='high'?'🔥':it.priority==='medium'?'⚡':'🌱'}</span>}</div>}
{it.notes&&<div className="note-box" style={{marginTop:4}}>📝 {it.notes.length>50?it.notes.slice(0,50)+'...':it.notes}</div>}
</div>
{isMeeting&&<span className="badge" style={{background:'var(--lime-g)',color:'var(--lime)'}}>{T('اجتماع','Meeting',language)}</span>}
</div>);}}/>
)}</div></div></div>);}

// ========== VIEWS ==========
function Dashboard({data,language,onAdd,onEdit,onDelete,onStatus,onReorder,search,filter}){const[eG,setEG]=useState(null);const[eM,setEM]=useState(null);const[msSort,setMsSort]=useState('none');const[tkSort,setTkSort]=useState('none');const gP=useCallback(id=>{const ms=(data.milestones||[]).filter(m=>m.goalId===id);if(!ms.length)return 0;return ms.map(m=>{const ts=(data.tasks||[]).filter(t=>t.milestoneId===m.id);if(!ts.length)return 0;return ts.filter(t=>t.status==='complete').length/ts.length*100;}).reduce((a,b)=>a+b,0)/ms.length;},[data.milestones,data.tasks]);const mP=useCallback(id=>{const ts=(data.tasks||[]).filter(t=>t.milestoneId===id);if(!ts.length)return 0;return ts.filter(t=>t.status==='complete').length/ts.length*100;},[data.tasks]);const sc={complete:'var(--lime)',inProgress:'var(--teal)',partial:'var(--gold)',notStarted:'var(--text2)'};const sl={complete:T('مكتمل','Done',language),inProgress:T('جارٍ','Active',language),partial:T('جزئي','Partial',language),notStarted:T('لم يبدأ','Todo',language)};const ns={notStarted:'inProgress',inProgress:'partial',partial:'complete',complete:'notStarted'};const pc={high:'var(--coral)',medium:'var(--gold)',low:'var(--lime)'};
  const exportGoalXlsx=(g)=>{
    const sl2={complete:language==='ar'?'مكتمل':'Done',inProgress:language==='ar'?'جارٍ':'Active',partial:language==='ar'?'جزئي':'Partial',notStarted:language==='ar'?'لم يبدأ':'Todo'};
    const pr2={high:language==='ar'?'عالية':'High',medium:language==='ar'?'متوسطة':'Medium',low:language==='ar'?'منخفضة':'Low'};
    const ms=(data.milestones||[]).filter(m=>m.goalId===g.id);
    const rows=[[T('تقرير الهدف','Goal Report',language)],[T('الهدف','Goal',language),g.title],[T('الوصف','Description',language),g.description||''],[T('البداية','Start',language),g.startDate||''],[T('النهاية','End',language),g.endDate||''],[T('الإنجاز','Progress',language),Math.round(gP(g.id))+'%'],[],
    [T('المرحلة','Milestone',language),T('التاريخ','Due Date',language),T('المهمة','Task',language),T('الأولوية','Priority',language),T('الحالة','Status',language),T('ملاحظات','Notes',language)]];
    ms.forEach(m=>{const ts=(data.tasks||[]).filter(t=>t.milestoneId===m.id);
      if(!ts.length){rows.push([m.title,m.dueDate||'','','','','']);}
      else{ts.forEach((t,i)=>{rows.push([i===0?m.title+(m.dueDate?' ('+m.dueDate+')':''):'',i===0?(m.dueDate||''):'',t.title,pr2[t.priority]||'',sl2[t.status]||'',t.notes||'']);});}
    });
    rows.push([]);
    const done=ms.reduce((s,m)=>{const ts=(data.tasks||[]).filter(t=>t.milestoneId===m.id);return s+ts.filter(t=>t.status==='complete').length;},0);
    const total=ms.reduce((s,m)=>s+(data.tasks||[]).filter(t=>t.milestoneId===m.id).length,0);
    rows.push([T('الإجمالي','Total',language),'',total+' '+T('مهمة','tasks',language),'',done+'/'+total+' '+T('مكتمل','done',language)]);
    const wb=XLSX.utils.book_new();const ws=XLSX.utils.aoa_to_sheet(rows);
    ws['!cols']=[{wch:25},{wch:14},{wch:30},{wch:12},{wch:12},{wch:30}];
    XLSX.utils.book_append_sheet(wb,ws,g.title.slice(0,30));
    XLSX.writeFile(wb,`${g.title}-${localDS()}.xlsx`);
  };
const isBlocked=useCallback((tk)=>{if(!tk.blockedBy)return false;const dep=(data.tasks||[]).find(t=>t.id===tk.blockedBy);return dep&&dep.status!=='complete';},[data.tasks]);
const depName=useCallback((tk)=>{if(!tk.blockedBy)return'';const dep=(data.tasks||[]).find(t=>t.id===tk.blockedBy);return dep?dep.title:'';},[data.tasks]);
const matchSearch=useCallback((tk)=>{if(!search)return true;const s=search.toLowerCase();return(tk.title||'').toLowerCase().includes(s)||(tk.description||'').toLowerCase().includes(s)||(tk.notes||'').toLowerCase().includes(s);},[search]);
const matchFilter=useCallback((tk)=>{if(filter==='all')return true;if(filter==='blocked')return isBlocked(tk);return(tk.status||'notStarted')===filter;},[filter,isBlocked]);
const getMilestones=useCallback((gid)=>{const raw=sortByOrder((data.milestones||[]).filter(m=>m.goalId===gid));return msSort==='none'?raw:sortItems(raw,msSort,'dueDate');},[data.milestones,msSort]);
const getTasks=useCallback((msid)=>{const raw=sortByOrder((data.tasks||[]).filter(tk=>tk.milestoneId===msid)).filter(tk=>matchSearch(tk)&&matchFilter(tk));return tkSort==='none'?raw:sortItems(raw,tkSort,'dueDate');},[data.tasks,tkSort,matchSearch,matchFilter]);
return(<div style={{display:'flex',flexDirection:'column',gap:16}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><h2 style={{fontSize:22,fontWeight:900}}>🎯 {T('الأهداف','Goals',language)}</h2><button className="btn btn-coral btn-sm" onClick={()=>onAdd('goal')}>⚡ {T('هدف جديد','New Goal',language)}</button></div>
{!(data.goals||[]).length&&(<div className="card" style={{padding:'50px 20px',textAlign:'center'}}><div style={{fontSize:56,marginBottom:16}}>🚀</div><p style={{color:'var(--text2)',fontSize:15,fontWeight:600}}>{T('ابدأ رحلتك! أضف أول هدف','Start your journey!',language)}</p></div>)}
{(data.goals||[]).map(g=>(<div key={g.id} className="card" style={{borderRight:language==='ar'?`4px solid ${g.color}`:'none',borderLeft:language!=='ar'?`4px solid ${g.color}`:'none'}}><div style={{padding:'16px 14px',cursor:'pointer'}} onClick={()=>setEG(eG===g.id?null:g.id)}><div style={{display:'flex',alignItems:'center',gap:12}}><div style={{fontSize:32,width:48,height:48,display:'flex',alignItems:'center',justifyContent:'center',background:`${g.color}22`,borderRadius:14,flexShrink:0}}>{g.icon}</div><div style={{flex:1,minWidth:0}}><h3 style={{fontSize:16,fontWeight:800,overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}}>{g.title}</h3>{g.description&&<p style={{fontSize:12,color:'var(--text2)',marginTop:2,overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}}>{g.description}</p>}{(g.startDate||g.endDate)&&<p style={{fontSize:11,color:'var(--text2)',marginTop:4}}>📅 {g.startDate&&new Date(g.startDate).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{month:'short',day:'numeric'})}{g.startDate&&g.endDate&&' → '}{g.endDate&&new Date(g.endDate).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{month:'short',day:'numeric'})}</p>}</div><Prog progress={gP(g.id)} color={g.color}/></div><div style={{display:'flex',gap:6,marginTop:10,justifyContent:'flex-end'}}><button className="btn btn-ghost btn-xs" onClick={e=>{e.stopPropagation();exportGoalXlsx(g);}}>📤 Excel</button><button className="btn btn-ghost btn-xs" onClick={e=>{e.stopPropagation();onEdit('goal',g);}}>✏️ {T('تعديل','Edit',language)}</button><button className="btn btn-ghost btn-xs" style={{borderColor:'var(--coral)',color:'var(--coral)'}} onClick={e=>{e.stopPropagation();onDelete('goals',g.id,g.title);}}>🗑️</button></div></div>
{eG===g.id&&(<div style={{borderTop:'1px solid var(--border)',padding:14,background:'var(--bg)'}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:12,flexWrap:'wrap',gap:6}}><h4 style={{fontSize:13,fontWeight:700,color:'var(--gold)'}}>📍 {T('المراحل','Milestones',language)}</h4><div style={{display:'flex',gap:6,alignItems:'center'}}><SortBtn sort={msSort} onToggle={()=>setMsSort(s=>nextSort(s))} language={language}/><button className="btn btn-gold btn-xs" onClick={()=>onAdd('milestone',g.id)}>⚡ {T('مرحلة','Milestone',language)}</button></div></div>
<DragList items={getMilestones(g.id)} onReorder={arr=>onReorder('milestones',arr)} renderItem={(ms,idx,dragHandle)=>(
<div style={{background:'var(--bg2)',borderRadius:14,padding:12,marginBottom:8,border:'1px solid var(--border)'}}><div style={{display:'flex',alignItems:'center',gap:10,cursor:'pointer'}} onClick={()=>setEM(eM===ms.id?null:ms.id)}>{dragHandle}<span style={{fontSize:22}}>{ms.icon}</span><div style={{flex:1,minWidth:0}}><div style={{fontWeight:700,fontSize:14}}>{ms.title}</div>{ms.dueDate&&<div style={{fontSize:11,color:'var(--text2)'}}>{new Date(ms.dueDate).toLocaleDateString(language==='ar'?'ar-SA':'en-US')}</div>}</div><Prog progress={mP(ms.id)} size={38} sw={3} color={g.color}/><div style={{display:'flex',gap:4}}><button className="btn btn-ghost btn-icon-xs" onClick={e=>{e.stopPropagation();onEdit('milestone',ms);}}>✏️</button><button className="btn btn-ghost btn-icon-xs" style={{color:'var(--coral)'}} onClick={e=>{e.stopPropagation();onDelete('milestones',ms.id,ms.title);}}>🗑️</button></div></div>
{eM===ms.id&&(<div style={{marginTop:10,paddingTop:10,borderTop:'1px solid var(--border)'}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:8,flexWrap:'wrap',gap:6}}><span style={{fontSize:12,color:'var(--text2)',fontWeight:700}}>✅ {T('المهام','Tasks',language)}</span><div style={{display:'flex',gap:6,alignItems:'center'}}><SortBtn sort={tkSort} onToggle={()=>setTkSort(s=>nextSort(s))} language={language}/><button className="btn btn-teal btn-xs" onClick={()=>onAdd('task',g.id,ms.id)}>⚡ {T('مهمة','Task',language)}</button></div></div>
<DragList items={getTasks(ms.id)} onReorder={arr=>onReorder('tasks',arr)} renderItem={(tk,tidx,tDragHandle)=>{const blocked=isBlocked(tk);return(
<div style={{display:'flex',alignItems:'center',gap:8,padding:'8px 0',borderBottom:'1px solid var(--border)',opacity:blocked?.5:1}}>{tDragHandle}<div onClick={()=>{if(!blocked)onStatus('tasks',tk,ns[tk.status]);}} style={{width:26,height:26,borderRadius:8,border:`2px solid ${blocked?'var(--coral)':sc[tk.status]}`,background:tk.status==='complete'?sc.complete:blocked?'var(--coral-g)':'transparent',cursor:blocked?'not-allowed':'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:13,color:'white',fontWeight:900,flexShrink:0,transition:'all .2s'}}>{tk.status==='complete'?'✓':blocked?'🔒':''}</div><span style={{fontSize:16}}>{tk.icon}</span><div style={{flex:1,minWidth:0}}><div style={{fontWeight:600,fontSize:13,textDecoration:tk.status==='complete'?'line-through':'none',opacity:tk.status==='complete'?.5:1}}>{tk.title}</div><div style={{display:'flex',gap:4,flexWrap:'wrap',marginTop:3}}><span className="badge" style={{background:`${sc[tk.status]}22`,color:sc[tk.status]}}>{sl[tk.status]}</span><span className="badge" style={{background:`${pc[tk.priority]}22`,color:pc[tk.priority]}}>{tk.priority==='high'?'🔥':tk.priority==='medium'?'⚡':'🌱'}</span>{tk.repeat&&tk.repeat!=='never'&&<span className="badge" style={{background:'var(--electric-g)',color:'var(--electric)'}}>🔄</span>}{blocked&&<span className="dep-badge">🔗 {depName(tk).slice(0,20)}</span>}</div>{tk.notes&&<div className="note-box">📝 {tk.notes.length>80?tk.notes.slice(0,80)+'...':tk.notes}</div>}</div><div style={{display:'flex',gap:4}}><button className="btn btn-ghost btn-icon-xs" onClick={()=>onEdit('task',tk)}>✏️</button><button className="btn btn-ghost btn-icon-xs" style={{color:'var(--coral)'}} onClick={()=>onDelete('tasks',tk.id,tk.title)}>🗑️</button></div></div>
);}}/></div>)}</div>
)}/></div>)}</div>))}</div>);}

// ========== MEETINGS BROWSER ==========
function MeetingsBrowser({meetings,language,onEdit,onDelete}){
  const[mSearch,setMSearch]=useState('');
  const[expanded,setExpanded]=useState(null);

  const filtered=useMemo(()=>{
    if(!mSearch)return meetings;
    const q=mSearch.toLowerCase();
    return meetings.filter(m=>(m.title||'').toLowerCase().includes(q)||(m.minutes||'').toLowerCase().includes(q)||(m.decisions||'').toLowerCase().includes(q)||(m.attendees||'').toLowerCase().includes(q)||(m.location||'').toLowerCase().includes(q));
  },[meetings,mSearch]);

  // Group by month
  const grouped=useMemo(()=>{
    const g={};
    filtered.forEach(m=>{const key=m.meetingDate.slice(0,7);if(!g[key])g[key]=[];g[key].push(m);});
    return Object.entries(g).sort((a,b)=>b[0].localeCompare(a[0]));
  },[filtered]);

  return(<div className="card" style={{padding:16}}>
    <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:12}}>
      <h3 style={{fontSize:15,fontWeight:800,color:'var(--pink)'}}>🗂️ {T('الاجتماعات السابقة','Past Meetings',language)} <span style={{fontSize:11,fontWeight:600,background:'var(--pink-g)',color:'var(--pink)',padding:'2px 8px',borderRadius:8}}>{meetings.length}</span></h3>
    </div>
    <div className="search-wrap" style={{marginBottom:12}}><span className="search-icon">🔍</span><input className="field" value={mSearch} onChange={e=>setMSearch(e.target.value)} placeholder={T('ابحث في الاجتماعات...','Search meetings...',language)} style={{paddingRight:language==='ar'?36:12,paddingLeft:language!=='ar'?36:12,fontSize:12}}/>{mSearch&&<span className="search-clear" onClick={()=>setMSearch('')}>✕</span>}</div>

    {!filtered.length?<p style={{textAlign:'center',color:'var(--text2)',padding:16,fontSize:13}}>🫥 {T('لا نتائج','No results',language)}</p>:
    grouped.map(([monthKey,monthMeetings])=>(<div key={monthKey}>
      <div style={{fontSize:12,fontWeight:800,color:'var(--pink)',padding:'10px 0 6px',borderBottom:'2px solid var(--border)'}}>{new Date(monthKey+'-15').toLocaleDateString(language==='ar'?'ar-SA':'en-US',{month:'long',year:'numeric'})} ({monthMeetings.length})</div>
      {monthMeetings.map(m=>{const isOpen=expanded===m.id;return(<div key={m.id} style={{borderBottom:'1px solid var(--border)'}}>
        <div onClick={()=>setExpanded(isOpen?null:m.id)} style={{display:'flex',alignItems:'center',gap:10,padding:'10px 0',cursor:'pointer'}}>
          <div style={{fontSize:18,width:36,height:36,display:'flex',alignItems:'center',justifyContent:'center',background:'var(--pink-g)',borderRadius:10,flexShrink:0}}>{m.icon||'👥'}</div>
          <div style={{flex:1,minWidth:0}}>
            <div style={{fontWeight:700,fontSize:13}}>{m.title}</div>
            <div style={{fontSize:11,color:'var(--text2)',display:'flex',gap:6,flexWrap:'wrap',marginTop:2}}>
              <span>📅 {new Date(m.meetingDate).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{day:'numeric',month:'short',weekday:'short'})}</span>
              <span>🕐 {new Date(m.meetingDate).toLocaleTimeString(language==='ar'?'ar-SA':'en-US',{hour:'2-digit',minute:'2-digit'})}</span>
              {m.location&&<span>📍 {m.location}</span>}
            </div>
          </div>
          <div style={{display:'flex',alignItems:'center',gap:4}}>
            {(m.minutes||m.decisions)&&<span style={{fontSize:10,color:'var(--lime)'}}>📋</span>}
            <span style={{fontSize:12,transition:'transform .2s',transform:isOpen?'rotate(180deg)':'rotate(0)',color:'var(--text2)'}}>▼</span>
          </div>
        </div>

        {isOpen&&<div style={{padding:'0 0 14px 46px',display:'flex',flexDirection:'column',gap:8}}>
          {m.description&&<div style={{fontSize:12,color:'var(--text2)'}}>{m.description}</div>}
          {m.attendees&&<div style={{fontSize:12}}><span style={{fontWeight:700,color:'var(--text2)'}}>👤 {T('الحضور','Attendees',language)}:</span> {m.attendees}</div>}
          {m.location&&<div style={{fontSize:12}}><span style={{fontWeight:700,color:'var(--text2)'}}>📍 {T('الموقع','Location',language)}:</span> {m.location}</div>}
          {m.minutes&&<div className="note-box" style={{background:'var(--pink-g)',borderColor:'var(--pink)',whiteSpace:'pre-wrap',lineHeight:1.8}}>📋 <strong>{T('محضر الاجتماع','Meeting Minutes',language)}</strong>{'\n'}{m.minutes}</div>}
          {m.decisions&&<div className="note-box" style={{background:'var(--lime-g)',borderColor:'var(--lime)',whiteSpace:'pre-wrap',lineHeight:1.8}}>✅ <strong>{T('القرارات والإجراءات','Decisions & Actions',language)}</strong>{'\n'}{m.decisions}</div>}
          {m.notes&&<div className="note-box" style={{whiteSpace:'pre-wrap'}}>📝 {m.notes}</div>}
          <div style={{display:'flex',gap:6,marginTop:4}}>
            <button className="btn btn-ghost btn-xs" onClick={()=>onEdit('meeting',m)}>✏️ {T('تعديل','Edit',language)}</button>
            <button className="btn btn-ghost btn-xs" style={{color:'var(--coral)'}} onClick={()=>onDelete('meetings',m.id,m.title)}>🗑️ {T('حذف','Delete',language)}</button>
          </div>
        </div>}
      </div>);})}
    </div>))}
  </div>);
}

function Today({data,language,onAdd,onEdit,onDelete,onStatus,onSaveList,onDeleteList}){const[ni,setNi]=useState({});const ts=localDS();const tT=(data.tasks||[]).filter(t=>t.dueDate&&t.dueDate.startsWith(ts));const tQ=(data.quickTasks||[]).filter(t=>t.dueDate&&t.dueDate.startsWith(ts));const tM=(data.meetings||[]).filter(m=>m.meetingDate&&m.meetingDate.startsWith(ts)).sort((a,b)=>new Date(a.meetingDate)-new Date(b.meetingDate));const sc={complete:'var(--lime)',inProgress:'var(--teal)',partial:'var(--gold)',notStarted:'var(--text2)'};const sl={complete:T('مكتمل','Done',language),inProgress:T('جارٍ','Active',language),partial:T('جزئي','Partial',language),notStarted:T('لم يبدأ','Todo',language)};const pc={high:'var(--coral)',medium:'var(--gold)',low:'var(--lime)'};const n3={notStarted:'inProgress',inProgress:'complete',complete:'notStarted'};const n4={notStarted:'inProgress',inProgress:'partial',partial:'complete',complete:'notStarted'};const all=[...tT.map(t=>({...t,_s:'tasks',_ns:n4})),...tQ.map(t=>({...t,_s:'quickTasks',_ns:n3}))];const tLI=async(l,iid)=>{await onSaveList({...l,items:l.items.map(i=>i.id===iid?{...i,checked:!i.checked}:i)});};const aLI=async(l,title)=>{if(!title.trim())return;await onSaveList({...l,items:[...l.items,{id:uid(),title:title.trim(),checked:false,createdAt:new Date().toISOString()}]});setNi({...ni,[l.id]:''});};const rLI=async(l,iid)=>{await onSaveList({...l,items:l.items.filter(i=>i.id!==iid)});};const lP=l=>{if(!l.items||!l.items.length)return 0;return l.items.filter(i=>i.checked).length/l.items.length*100;};
return(<div style={{display:'flex',flexDirection:'column',gap:16}}><h2 style={{fontSize:22,fontWeight:900}}>🔥 {T('اليوم','Today',language)}</h2>
<div className="card" style={{padding:16}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:14}}><h3 style={{fontSize:16,fontWeight:800,color:'var(--pink)'}}>👥 {T('الاجتماعات','Meetings',language)}</h3><button className="btn btn-pink btn-xs" onClick={()=>onAdd('meeting')}>⚡ {T('جديد','New',language)}</button></div>{!tM.length?(<p style={{textAlign:'center',color:'var(--text2)',padding:16,fontSize:13}}>😌 {T('لا اجتماعات','No meetings',language)}</p>):tM.map(m=>(<div key={m.id} style={{display:'flex',alignItems:'flex-start',gap:12,padding:'12px 0',borderBottom:'1px solid var(--border)'}}><div style={{fontSize:28,width:44,height:44,display:'flex',alignItems:'center',justifyContent:'center',background:'var(--pink-g)',borderRadius:12,flexShrink:0}}>{m.icon||'👥'}</div><div style={{flex:1,minWidth:0}}><div style={{fontWeight:700,fontSize:14}}>{m.title}</div><div style={{fontSize:12,color:'var(--text2)',display:'flex',gap:8,flexWrap:'wrap',marginTop:3}}>{m.meetingDate&&<span>🕐 {new Date(m.meetingDate).toLocaleTimeString(language==='ar'?'ar-SA':'en-US',{hour:'2-digit',minute:'2-digit'})}</span>}{m.location&&<span>📍 {m.location}</span>}{m.attendees&&<span>👤 {m.attendees}</span>}</div>{m.minutes&&<div className="note-box" style={{background:'var(--pink-g)',borderColor:'var(--pink)'}}>📋 <strong>{T('المحضر','Minutes',language)}:</strong> {m.minutes.length>120?m.minutes.slice(0,120)+'...':m.minutes}</div>}{m.decisions&&<div className="note-box" style={{background:'var(--lime-g)',borderColor:'var(--lime)'}}>✅ <strong>{T('القرارات','Decisions',language)}:</strong> {m.decisions.length>80?m.decisions.slice(0,80)+'...':m.decisions}</div>}{m.notes&&!m.minutes&&<div className="note-box">📝 {m.notes.length>60?m.notes.slice(0,60)+'...':m.notes}</div>}</div><div style={{display:'flex',gap:4}}><button className="btn btn-ghost btn-icon-xs" onClick={()=>onEdit('meeting',m)}>✏️</button><button className="btn btn-ghost btn-icon-xs" style={{color:'var(--coral)'}} onClick={()=>onDelete('meetings',m.id,m.title)}>🗑️</button></div></div>))}</div>
{(()=>{const allM=(data.meetings||[]).filter(m=>m.meetingDate&&!m.meetingDate.startsWith(ts)).sort((a,b)=>new Date(b.meetingDate)-new Date(a.meetingDate));if(!allM.length)return null;return(<MeetingsBrowser meetings={allM} language={language} onEdit={onEdit} onDelete={onDelete}/>);})()}
<div className="card" style={{padding:16}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:14}}><h3 style={{fontSize:16,fontWeight:800,color:'var(--teal)'}}>✅ {T('المهام','Tasks',language)} <span style={{fontSize:12,fontWeight:600,color:'var(--text2)'}}>({all.filter(t=>t.status==='complete').length}/{all.length})</span></h3><button className="btn btn-teal btn-xs" onClick={()=>onAdd('quickTask')}>⚡ {T('مهمة','Task',language)}</button></div>{!all.length?(<p style={{textAlign:'center',color:'var(--text2)',padding:16,fontSize:13}}>🎉 {T('لا مهام','No tasks',language)}</p>):all.map(tk=>(<div key={tk.id} style={{display:'flex',alignItems:'center',gap:8,padding:'10px 0',borderBottom:'1px solid var(--border)'}}><div onClick={()=>onStatus(tk._s,tk,tk._ns[tk.status])} style={{width:26,height:26,borderRadius:8,border:`2px solid ${sc[tk.status]}`,background:tk.status==='complete'?sc.complete:'transparent',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:13,color:'white',fontWeight:900,flexShrink:0}}>{tk.status==='complete'&&'✓'}</div><span style={{fontSize:18}}>{tk.icon||'✅'}</span><div style={{flex:1,minWidth:0}}><div style={{fontWeight:600,fontSize:13,textDecoration:tk.status==='complete'?'line-through':'none',opacity:tk.status==='complete'?.5:1}}>{tk.title}</div><div style={{display:'flex',gap:4,flexWrap:'wrap',marginTop:3}}><span className="badge" style={{background:`${sc[tk.status]}22`,color:sc[tk.status]}}>{sl[tk.status]}</span>{tk.priority&&<span className="badge" style={{background:`${pc[tk.priority]||'var(--text2)'}22`,color:pc[tk.priority]||'var(--text2)'}}>{tk.priority==='high'?'🔥':tk.priority==='medium'?'⚡':'🌱'}</span>}{tk.repeat&&tk.repeat!=='never'&&<span className="badge" style={{background:'var(--electric-g)',color:'var(--electric)'}}>🔄</span>}</div>{tk.notes&&<div className="note-box">📝 {tk.notes.length>60?tk.notes.slice(0,60)+'...':tk.notes}</div>}</div><div style={{display:'flex',gap:4}}><button className="btn btn-ghost btn-icon-xs" onClick={()=>onEdit(tk._s==='tasks'?'task':'quickTask',tk)}>✏️</button><button className="btn btn-ghost btn-icon-xs" style={{color:'var(--coral)'}} onClick={()=>onDelete(tk._s,tk.id,tk.title)}>🗑️</button></div></div>))}</div>
<div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><h3 style={{fontSize:16,fontWeight:800,color:'var(--gold)'}}>📋 {T('القوائم','Lists',language)}</h3><button className="btn btn-gold btn-xs" onClick={()=>onAdd('taskList')}>⚡ {T('قائمة','List',language)}</button></div>
{!(data.taskLists||[]).length?(<div className="card" style={{padding:30,textAlign:'center'}}><div style={{fontSize:40,marginBottom:8}}>📝</div><p style={{color:'var(--text2)',fontSize:13}}>{T('أنشئ قائمتك الأولى!','Create your first list!',language)}</p></div>):(data.taskLists||[]).map(list=>(<div key={list.id} className="card" style={{padding:14,borderRight:language==='ar'?`3px solid ${list.color}`:'none',borderLeft:language!=='ar'?`3px solid ${list.color}`:'none'}}><div style={{display:'flex',alignItems:'center',gap:10,marginBottom:10}}><div style={{fontSize:24,width:40,height:40,display:'flex',alignItems:'center',justifyContent:'center',background:`${list.color}22`,borderRadius:10,flexShrink:0}}>{list.icon}</div><div style={{flex:1}}><div style={{fontWeight:800,fontSize:14}}>{list.name}</div><div style={{fontSize:11,color:'var(--text2)',fontWeight:600}}>{list.items?.length||0} {T('عناصر','items',language)} · {Math.round(lP(list))}%</div></div><div style={{display:'flex',gap:4}}><button className="btn btn-ghost btn-icon-xs" onClick={()=>onEdit('taskList',list)}>✏️</button><button className="btn btn-ghost btn-icon-xs" style={{color:'var(--coral)'}} onClick={()=>onDeleteList(list)}>🗑️</button></div></div><div style={{height:4,background:'var(--border)',borderRadius:4,marginBottom:10,overflow:'hidden'}}><div style={{height:'100%',width:`${lP(list)}%`,background:`linear-gradient(90deg,${list.color},${list.color}88)`,borderRadius:4,transition:'width .5s'}}/></div>{(list.items||[]).map(it=>(<div key={it.id} style={{display:'flex',alignItems:'center',gap:8,padding:'6px 0'}}><div onClick={()=>tLI(list,it.id)} style={{width:22,height:22,borderRadius:6,border:`2px solid ${it.checked?'var(--lime)':'var(--border)'}`,background:it.checked?'var(--lime)':'transparent',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:11,color:'white',fontWeight:900,flexShrink:0,transition:'all .2s'}}>{it.checked&&'✓'}</div><span style={{flex:1,fontSize:13,fontWeight:500,textDecoration:it.checked?'line-through':'none',opacity:it.checked?.4:1}}>{it.title}</span><button className="btn btn-ghost btn-icon-xs" style={{width:22,height:22,fontSize:10}} onClick={()=>rLI(list,it.id)}>✕</button></div>))}<div style={{display:'flex',gap:8,marginTop:8}}><input className="field" style={{fontSize:13,padding:'8px 12px'}} value={ni[list.id]||''} onChange={e=>setNi({...ni,[list.id]:e.target.value})} onKeyDown={e=>{if(e.key==='Enter')aLI(list,ni[list.id]||'');}} placeholder={T('عنصر جديد...','New item...',language)}/><button className="btn btn-teal btn-sm" onClick={()=>aLI(list,ni[list.id]||'')}>+</button></div></div>))}</div>);}

// ========== EXPENSE SYSTEM ==========
const DEF_CATS=[
  {id:'cat-food',name:'أكل ومطاعم',nameEn:'Food & Dining',icon:'🍽️',color:'#FF6B6B'},
  {id:'cat-transport',name:'مواصلات وبنزين',nameEn:'Transport & Gas',icon:'🚗',color:'#5F7FFF'},
  {id:'cat-bills',name:'إيجار وفواتير',nameEn:'Rent & Bills',icon:'🏠',color:'#FECA57'},
  {id:'cat-shopping',name:'تسوق ومشتريات',nameEn:'Shopping',icon:'🛒',color:'#FF9FF3'},
  {id:'cat-health',name:'صحة وعلاج',nameEn:'Health',icon:'💊',color:'#00D2D3'},
  {id:'cat-edu',name:'تعليم ودورات',nameEn:'Education',icon:'📚',color:'#55E6C1'},
];
const CURRENCIES=[{code:'SAR',icon:'🇸🇦',name:'ريال',nameEn:'SAR'},{code:'EGP',icon:'🇪🇬',name:'جنيه',nameEn:'EGP'},{code:'USD',icon:'🇺🇸',name:'دولار',nameEn:'USD'},{code:'EUR',icon:'🇪🇺',name:'يورو',nameEn:'EUR'},{code:'GBP',icon:'🇬🇧',name:'جنيه إسترليني',nameEn:'GBP'}];

// Exchange rates system
const DEF_RATES={USD:1,SAR:3.75,EGP:50.0,EUR:0.92,GBP:0.79};
function getStoredRates(){try{const s=localStorage.getItem('gt-rates');return s?JSON.parse(s):{rates:DEF_RATES,base:'USD',updated:null,baseCurrency:'SAR'};}catch(e){return{rates:DEF_RATES,base:'USD',updated:null,baseCurrency:'SAR'};}}
function saveRates(data){localStorage.setItem('gt-rates',JSON.stringify(data));}
async function fetchLiveRates(){
  try{
    const res=await fetch('https://open.er-api.com/v6/latest/USD');
    if(!res.ok)throw new Error('API error');
    const data=await res.json();
    if(data.result!=='success')throw new Error('API fail');
    const rates={USD:1,SAR:data.rates.SAR||3.75,EGP:data.rates.EGP||50,EUR:data.rates.EUR||0.92,GBP:data.rates.GBP||0.79};
    const stored=getStoredRates();
    const merged={...rates};
    if(stored.manualOverrides){Object.entries(stored.manualOverrides).forEach(([k,v])=>{merged[k]=v;});}
    const newData={...stored,rates:merged,base:'USD',updated:new Date().toISOString()};
    saveRates(newData);
    return newData;
  }catch(e){console.warn('Rate fetch failed:',e);return getStoredRates();}
}
function convertAmount(amount,fromCur,toCur,rates){
  if(fromCur===toCur||!amount)return amount;
  const r=rates||getStoredRates().rates;
  const fromRate=r[fromCur]||1;
  const toRate=r[toCur]||1;
  if(!fromRate||!toRate)return amount;
  const inUSD=amount/fromRate;
  return inUSD*toRate;
}
function fmtMoney(n){if(n==null||isNaN(n))return'0';if(n<0)return'-'+fmtMoney(-n);if(n>=1000000)return(n/1000000).toFixed(1)+'M';if(n>=10000)return(n/1000).toFixed(1)+'K';if(n>=1000)return Math.round(n).toLocaleString();if(n%1)return n.toFixed(2);return n.toString();}

async function initCats(){const existing=await dAll('categories');if(!existing.length){for(const c of DEF_CATS)await dPut('categories',{...c,createdAt:new Date().toISOString()});}}

function ExpenseModal({expense,categories,budgets,language,onSave,onClose}){
  const isE=expense&&expense.id&&!expense._isNew;
  const[form,setForm]=useState(()=>isE?{...expense}:{title:'',amount:'',currency:expense?.currency||'SAR',category:categories[0]?.id||'',date:expense?.date||localDS(),notes:'',budgetId:expense?.budgetId||'',paymentMethod:'cash'});
  const f=(k,v)=>setForm(p=>({...p,[k]:v}));
  const save=()=>{if(!form.title.trim()||!form.amount){return;}onSave({...form,id:form.id||uid(),amount:parseFloat(form.amount),createdAt:form.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()});};
  const pay=[{v:'cash',l:T('نقد','Cash',language),i:'💵'},{v:'card',l:T('بطاقة','Card',language),i:'💳'},{v:'transfer',l:T('تحويل','Transfer',language),i:'🏦'}];
  return(<div className="overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()} style={{maxWidth:420,maxHeight:'90dvh',overflow:'auto'}}>
    <div style={{padding:'20px 24px',borderBottom:'1px solid var(--border)'}}><h3 style={{fontSize:16,fontWeight:800}}>{isE?T('تعديل مصروف','Edit Expense',language):T('مصروف جديد','New Expense',language)}</h3></div>
    <div style={{padding:20,display:'flex',flexDirection:'column',gap:14}}>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('الوصف','Description',language)}</label><input className="field" value={form.title} onChange={e=>f('title',e.target.value)} placeholder={T('قهوة، غداء، بنزين...','Coffee, lunch, gas...',language)}/></div>
      <div style={{display:'grid',gridTemplateColumns:'1fr auto',gap:8}}><div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('المبلغ','Amount',language)}</label><input className="field" type="number" step="0.01" value={form.amount} onChange={e=>f('amount',e.target.value)} placeholder="0.00" style={{fontSize:20,fontWeight:900}}/></div><div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('العملة','Currency',language)}</label><select className="field" value={form.currency} onChange={e=>f('currency',e.target.value)}>{CURRENCIES.map(c=>(<option key={c.code} value={c.code}>{c.icon} {c.code}</option>))}</select></div></div>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('التصنيف','Category',language)}</label><div style={{display:'flex',flexWrap:'wrap',gap:6}}>{categories.map(c=>(<div key={c.id} onClick={()=>f('category',c.id)} style={{padding:'6px 12px',borderRadius:10,fontSize:12,fontWeight:700,cursor:'pointer',border:`2px solid ${form.category===c.id?c.color:'var(--border)'}`,background:form.category===c.id?`${c.color}22`:'transparent',color:form.category===c.id?c.color:'var(--text2)',transition:'all .15s'}}>{c.icon} {language==='ar'?c.name:c.nameEn}</div>))}</div></div>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('التاريخ','Date',language)}</label><input className="field" type="date" value={form.date} onChange={e=>f('date',e.target.value)}/></div>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('طريقة الدفع','Payment',language)}</label><div style={{display:'flex',gap:6}}>{pay.map(p=>(<div key={p.v} onClick={()=>f('paymentMethod',p.v)} style={{flex:1,padding:'8px 6px',borderRadius:10,fontSize:12,fontWeight:700,cursor:'pointer',textAlign:'center',border:`2px solid ${form.paymentMethod===p.v?'var(--teal)':'var(--border)'}`,background:form.paymentMethod===p.v?'var(--teal-g)':'transparent',color:form.paymentMethod===p.v?'var(--teal)':'var(--text2)'}}>{p.i} {p.l}</div>))}</div></div>
      {budgets.length>0&&<div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('ميزانية (اختياري)','Budget (optional)',language)}</label><select className="field" value={form.budgetId||''} onChange={e=>f('budgetId',e.target.value)}><option value="">{T('— بدون —','— None —',language)}</option>{budgets.map(b=>(<option key={b.id} value={b.id}>{b.icon} {b.title}</option>))}</select></div>}
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('ملاحظات','Notes',language)}</label><textarea className="field" rows={2} value={form.notes} onChange={e=>f('notes',e.target.value)}/></div>
    </div>
    <div style={{padding:'16px 24px',borderTop:'1px solid var(--border)',display:'flex',gap:10,justifyContent:'flex-end'}}><button className="btn btn-ghost" onClick={onClose}>{T('إلغاء','Cancel',language)}</button><button className="btn btn-coral" onClick={save}>💰 {T('حفظ','Save',language)}</button></div>
  </div></div>);
}

function CategoryModal({category,language,onSave,onClose}){
  const isE=category&&category.id&&!category._isNew;
  const[form,setForm]=useState(()=>isE?{...category}:{name:'',nameEn:'',icon:'🏷️',color:'#FF6B6B'});
  const f=(k,v)=>setForm(p=>({...p,[k]:v}));
  const icons=['🏷️','🍕','☕','🍔','🥗','🧁','🍽️','🍺','🥤','🎮','⛽','💻','📱','🎁','✈️','🐱','🐕','🏋️','🎵','📦','🎬','🌙','🕌','📿','🎒','🏕️','⚽','🎂','👕','👗','💇','🧹','🔧','🏥','💊','🚗','🚕','🚌','⛽','🏠','💡','📞','💧','🔌','🎓','📚','📝','💼','👶','💍','🧴','🧼','🍼','🛏️','🪑','📺','🖨️','🎨','🏖️','⛷️','🎣','🏊','🎭','🎪','🎟️','🛍️','💎','⌚','👓','🧳','🛒','🏦','💳','📮','🛠️','🔑','🏗️','🌿','🐈','🐾','🎶','🍷','🧀','🥩','🍰','🎤','📸','🏡','🚿','🧲','🔋','📡','🖥️','⚡'];
  return(<div className="overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()} style={{maxWidth:380}}>
    <div style={{padding:'20px 24px',borderBottom:'1px solid var(--border)'}}><h3 style={{fontSize:16,fontWeight:800}}>{isE?T('تعديل تصنيف','Edit Category',language):T('تصنيف جديد','New Category',language)}</h3></div>
    <div style={{padding:20,display:'flex',flexDirection:'column',gap:14}}>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('الاسم بالعربي','Arabic Name',language)}</label><input className="field" value={form.name} onChange={e=>f('name',e.target.value)}/></div>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('الاسم بالإنجليزي','English Name',language)}</label><input className="field" value={form.nameEn} onChange={e=>f('nameEn',e.target.value)}/></div>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('الأيقونة','Icon',language)}</label><IconPick icons={icons} sel={form.icon} onSel={v=>f('icon',v)}/></div>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('اللون','Color',language)}</label><ColPick sel={form.color} onSel={v=>f('color',v)}/></div>
    </div>
    <div style={{padding:'16px 24px',borderTop:'1px solid var(--border)',display:'flex',gap:10,justifyContent:'flex-end'}}><button className="btn btn-ghost" onClick={onClose}>{T('إلغاء','Cancel',language)}</button><button className="btn btn-teal" onClick={()=>{if(!form.name.trim())return;onSave({...form,id:form.id||uid(),createdAt:form.createdAt||new Date().toISOString()});}}>✅ {T('حفظ','Save',language)}</button></div>
  </div></div>);
}

function BudgetModal({budget,language,onSave,onClose}){
  const isE=budget&&budget.id&&!budget._isNew;
  const[form,setForm]=useState(()=>isE?{...budget}:{title:'',icon:'💰',color:'#FECA57',totalAmount:'',currency:'SAR',startDate:localDS(),endDate:'',type:'custom'});
  const f=(k,v)=>setForm(p=>({...p,[k]:v}));
  const icons=['💰','🇵🇹','✈️','🏠','🎓','🌙','🚗','💻','🎁','💍','🏕️','🏗️','👶','🎉','📚'];
  return(<div className="overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()} style={{maxWidth:400}}>
    <div style={{padding:'20px 24px',borderBottom:'1px solid var(--border)'}}><h3 style={{fontSize:16,fontWeight:800}}>{isE?T('تعديل ميزانية','Edit Budget',language):T('ميزانية جديدة','New Budget',language)}</h3></div>
    <div style={{padding:20,display:'flex',flexDirection:'column',gap:14}}>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('العنوان','Title',language)}</label><input className="field" value={form.title} onChange={e=>f('title',e.target.value)} placeholder={T('رحلة البرتغال، مصاريف رمضان...','Trip to Portugal, Ramadan...',language)}/></div>
      <div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('الأيقونة','Icon',language)}</label><IconPick icons={icons} sel={form.icon} onSel={v=>f('icon',v)}/></div>
      <div style={{display:'grid',gridTemplateColumns:'1fr auto',gap:8}}><div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('المبلغ','Amount',language)}</label><input className="field" type="number" value={form.totalAmount} onChange={e=>f('totalAmount',e.target.value)} style={{fontSize:20,fontWeight:900}}/></div><div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('العملة','Currency',language)}</label><select className="field" value={form.currency} onChange={e=>f('currency',e.target.value)}>{CURRENCIES.map(c=>(<option key={c.code} value={c.code}>{c.icon} {c.code}</option>))}</select></div></div>
      <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:8}}><div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('من','From',language)}</label><input className="field" type="date" value={form.startDate} onChange={e=>f('startDate',e.target.value)}/></div><div><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('إلى','To',language)}</label><input className="field" type="date" value={form.endDate} onChange={e=>f('endDate',e.target.value)}/></div></div>
    </div>
    <div style={{padding:'16px 24px',borderTop:'1px solid var(--border)',display:'flex',gap:10,justifyContent:'flex-end'}}><button className="btn btn-ghost" onClick={onClose}>{T('إلغاء','Cancel',language)}</button><button className="btn btn-gold" onClick={()=>{if(!form.title.trim()||!form.totalAmount)return;onSave({...form,id:form.id||uid(),totalAmount:parseFloat(form.totalAmount),createdAt:form.createdAt||new Date().toISOString()});}}>💰 {T('حفظ','Save',language)}</button></div>
  </div></div>);
}

// SVG Charts
function ExpPieChart({expenses,categories,language,toBase}){
  if(!expenses.length)return(<div style={{textAlign:'center',padding:30,color:'var(--text2)'}}><div style={{fontSize:48}}>📊</div><p style={{fontSize:13,marginTop:8}}>{T('لا توجد بيانات','No data',language)}</p></div>);
  const byC={};expenses.forEach(e=>{byC[e.category]=(byC[e.category]||0)+(toBase?toBase(e.amount,e.currency):e.amount);});
  const entries=Object.entries(byC).sort((a,b)=>b[1]-a[1]);
  const total=entries.reduce((s,e)=>s+e[1],0);
  let startAngle=0;
  const slices=entries.map(([catId,amt])=>{
    const cat=categories.find(c=>c.id===catId)||{icon:'❓',color:'#666',name:catId,nameEn:catId};
    const pct=amt/total;const angle=pct*360;const rad=Math.PI/180;
    const x1=Math.cos((startAngle-90)*rad)*80+100,y1=Math.sin((startAngle-90)*rad)*80+100;
    const endA=startAngle+angle;
    const x2=Math.cos((endA-90)*rad)*80+100,y2=Math.sin((endA-90)*rad)*80+100;
    const large=angle>180?1:0;
    const d=`M100,100 L${x1},${y1} A80,80 0 ${large},1 ${x2},${y2} Z`;
    startAngle=endA;
    return{d,color:cat.color,cat,amt,pct};
  });
  return(<div><svg viewBox="0 0 200 200" style={{width:180,height:180,margin:'0 auto',display:'block'}}>{slices.map((s,i)=>(<path key={i} d={s.d} fill={s.color} stroke="var(--bg2)" strokeWidth="2"><title>{s.cat.icon} {Math.round(s.pct*100)}%</title></path>))}</svg>
    <div className="exp-pie-legend">{slices.map((s,i)=>(<div key={i} className="exp-pie-legend-item"><div style={{width:10,height:10,borderRadius:3,background:s.color}}/><span>{s.cat.icon} {language==='ar'?s.cat.name:s.cat.nameEn}: {Math.round(s.pct*100)}%</span></div>))}</div></div>);
}

function ExpTrendLine({expenses,language,dateRange,toBase}){
  if(!expenses.length)return(<div style={{textAlign:'center',padding:30,color:'var(--text2)'}}><div style={{fontSize:48}}>📈</div><p style={{fontSize:13,marginTop:8}}>{T('لا توجد بيانات','No data',language)}</p></div>);
  const byDay={};expenses.forEach(e=>{const d=e.date;byDay[d]=(byDay[d]||0)+(toBase?toBase(e.amount,e.currency):e.amount);});
  const days=Object.keys(byDay).sort();
  const vals=days.map(d=>byDay[d]);
  const max=Math.max(...vals,1);
  const w=300,h=150,px=40,py=10;
  const points=days.map((d,i)=>{const x=px+i*(w-px*2)/(days.length-1||1);const y=h-py-(vals[i]/max)*(h-py*2);return{x,y,v:vals[i],d};});
  const line=points.map((p,i)=>i===0?`M${p.x},${p.y}`:`L${p.x},${p.y}`).join(' ');
  return(<svg viewBox={`0 0 ${w} ${h}`} style={{width:'100%',maxWidth:400,margin:'0 auto',display:'block'}}>
    {[0,.25,.5,.75,1].map((p,i)=>{const y=h-py-p*(h-py*2);return(<g key={i}><line x1={px} y1={y} x2={w-px} y2={y} stroke="var(--border)" strokeWidth="0.5"/><text x={px-4} y={y+3} textAnchor="end" fontSize="8" fill="var(--text2)">{Math.round(max*p)}</text></g>);})}
    <path d={line} fill="none" stroke="var(--coral)" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"/>
    {points.map((p,i)=>(<g key={i}><circle cx={p.x} cy={p.y} r="4" fill="var(--coral)" stroke="var(--bg2)" strokeWidth="2"><title>{p.d}: {p.v}</title></circle></g>))}
    {points.length<=14&&points.map((p,i)=>(<text key={'l'+i} x={p.x} y={h-1} textAnchor="middle" fontSize="7" fill="var(--text2)">{p.d.slice(5)}</text>))}
  </svg>);
}

function ExpMonthlyBars({expenses,categories,language,toBase}){
  if(!expenses.length)return(<div style={{textAlign:'center',padding:30,color:'var(--text2)'}}><div style={{fontSize:48}}>📊</div><p style={{fontSize:13,marginTop:8}}>{T('لا توجد بيانات','No data',language)}</p></div>);
  const byMonth={};expenses.forEach(e=>{const m=e.date.slice(0,7);byMonth[m]=(byMonth[m]||0)+(toBase?toBase(e.amount,e.currency):e.amount);});
  const months=Object.keys(byMonth).sort().slice(-6);
  const max=Math.max(...months.map(m=>byMonth[m]),1);
  return(<div style={{display:'flex',alignItems:'flex-end',gap:8,height:140,padding:'0 8px'}}>
    {months.map(m=>{const v=byMonth[m];const pct=v/max*100;const mName=new Date(m+'-15').toLocaleDateString(language==='ar'?'ar-SA':'en-US',{month:'short'});return(
      <div key={m} style={{flex:1,display:'flex',flexDirection:'column',alignItems:'center',gap:4}}>
        <span style={{fontSize:10,fontWeight:700,color:'var(--text2)'}}>{Math.round(v)}</span>
        <div style={{width:'100%',maxWidth:40,height:`${Math.max(pct,4)}%`,background:'linear-gradient(180deg,var(--coral),var(--gold))',borderRadius:'8px 8px 0 0',minHeight:4,transition:'height .5s'}}/>
        <span style={{fontSize:10,fontWeight:600,color:'var(--text2)'}}>{mName}</span>
      </div>);})}
  </div>);
}

function Expenses({data,language,onSaveExpense,onDeleteExpense,onSaveCategory,onDeleteCategory,onSaveBudget,onDeleteBudget,toast}){
  const[expModal,setExpModal]=useState(null);
  const[catModal,setCatModal]=useState(null);
  const[budModal,setBudModal]=useState(null);
  const[chartTab,setChartTab]=useState('pie');
  const[dateRange,setDateRange]=useState('month');
  const[customFrom,setCustomFrom]=useState('');
  const[customTo,setCustomTo]=useState('');
  const[expSearch,setExpSearch]=useState('');
  const[mgtMode,setMgtMode]=useState(false);
  const[rateData,setRateData]=useState(()=>getStoredRates());
  const[rateLoading,setRateLoading]=useState(false);
  const[selBudget,setSelBudget]=useState(null);
  const[expandedCats,setExpandedCats]=useState({});

  const baseCur=rateData.baseCurrency||'SAR';
  const rates=rateData.rates||DEF_RATES;
  const baseCurInfo=CURRENCIES.find(c=>c.code===baseCur)||CURRENCIES[0];

  // Auto-fetch rates on first load if never fetched
  useEffect(()=>{if(!rateData.updated){fetchLiveRates().then(d=>setRateData(d));}},[]);

  const refreshRates=useCallback(async()=>{setRateLoading(true);const d=await fetchLiveRates();setRateData(d);setRateLoading(false);toast(T('تم تحديث الأسعار 💱','Rates updated 💱',language));},[toast,language]);
  const setBaseCurrency=useCallback((code)=>{const d={...rateData,baseCurrency:code};saveRates(d);setRateData(d);},[rateData]);
  const setManualRate=useCallback((code,val)=>{const mo={...(rateData.manualOverrides||{}), [code]:parseFloat(val)};const nr={...rateData.rates,[code]:parseFloat(val)};const d={...rateData,rates:nr,manualOverrides:mo};saveRates(d);setRateData(d);},[rateData]);
  const clearManualRate=useCallback((code)=>{const mo={...(rateData.manualOverrides||{})};delete mo[code];const d={...rateData,manualOverrides:mo};saveRates(d);setRateData(d);refreshRates();},[rateData,refreshRates]);

  const toBase=useCallback((amount,fromCur)=>convertAmount(amount,fromCur,baseCur,rates),[baseCur,rates]);
  const toBudgetCur=useCallback((amount,fromCur,budCur)=>convertAmount(amount,fromCur,budCur,rates),[rates]);

  const cats=data.categories||[];
  const allExp=data.expenses||[];
  const budgets=data.budgets||[];

  const filtered=useMemo(()=>{
    const now=new Date();let from,to;
    if(dateRange==='week'){from=new Date(now);from.setDate(from.getDate()-7);to=now;}
    else if(dateRange==='month'){from=new Date(now.getFullYear(),now.getMonth(),1);to=now;}
    else if(dateRange==='year'){from=new Date(now.getFullYear(),0,1);to=now;}
    else if(dateRange==='custom'&&customFrom&&customTo){from=new Date(customFrom);to=new Date(customTo);to.setHours(23,59,59);}
    else{from=new Date(0);to=now;}
    return allExp.filter(e=>{const d=new Date(e.date);return d>=from&&d<=to;}).filter(e=>!expSearch||((e.title||'').toLowerCase().includes(expSearch.toLowerCase()))).sort((a,b)=>new Date(b.date)-new Date(a.date));
  },[allExp,dateRange,customFrom,customTo,expSearch]);

  const totalFiltered=useMemo(()=>filtered.reduce((s,e)=>s+toBase(e.amount,e.currency),0),[filtered,toBase]);
  const curMonth=localDS().slice(0,7);
  const monthTotal=useMemo(()=>allExp.filter(e=>e.date.startsWith(curMonth)).reduce((s,e)=>s+toBase(e.amount,e.currency),0),[allExp,curMonth,toBase]);

  const getCatName=(id)=>{const c=cats.find(c=>c.id===id);return c?(language==='ar'?c.name:c.nameEn):'❓';};
  const getCat=(id)=>cats.find(c=>c.id===id)||{icon:'❓',color:'#666',name:'أخرى',nameEn:'Other'};
  const getBudgetSpent=useCallback((bid)=>{const b=budgets.find(x=>x.id===bid);const bCur=b?b.currency:baseCur;return allExp.filter(e=>e.budgetId===bid).reduce((s,e)=>s+toBudgetCur(e.amount,e.currency,bCur),0);},[allExp,budgets,baseCur,toBudgetCur]);

  // Group by date
  const grouped=useMemo(()=>{const g={};filtered.forEach(e=>{const d=e.date;if(!g[d])g[d]=[];g[d].push(e);});return Object.entries(g);},[filtered]);

  const chartTabs=[{id:'pie',icon:'🥧',l:T('دائري','Pie',language)},{id:'trend',icon:'📈',l:T('خطي','Trend',language)},{id:'bars',icon:'📊',l:T('شهري','Monthly',language)},{id:'table',icon:'📋',l:T('جدول','Table',language)},{id:'budgets',icon:'🎯',l:T('ميزانيات','Budgets',language)}];
  const dateRanges=[{id:'week',l:T('أسبوع','Week',language)},{id:'month',l:T('شهر','Month',language)},{id:'year',l:T('سنة','Year',language)},{id:'custom',l:T('مخصص','Custom',language)}];

  const handleExportXlsx=()=>{
    const wsData=[[T('التاريخ','Date',language),T('التصنيف','Category',language),T('الوصف','Description',language),T('المبلغ','Amount',language),T('العملة','Currency',language),T('المبلغ بـ ','Amount in ',language)+baseCur,T('طريقة الدفع','Payment',language),T('ملاحظات','Notes',language)]];
    filtered.forEach(e=>{const cat=getCat(e.category);wsData.push([e.date,language==='ar'?cat.name:cat.nameEn,e.title,e.amount,e.currency,Math.round(toBase(e.amount,e.currency)*100)/100,e.paymentMethod||'',e.notes||'']);});
    wsData.push([]);wsData.push(['','',T('الإجمالي','Total',language),'','',Math.round(totalFiltered),'','']);
    const sumData=[[T('التصنيف','Category',language),T('المبلغ بـ ','Amount in ',language)+baseCur,T('النسبة','%',language)]];
    const byC={};filtered.forEach(e=>{byC[e.category]=(byC[e.category]||0)+toBase(e.amount,e.currency);});
    Object.entries(byC).sort((a,b)=>b[1]-a[1]).forEach(([cid,amt])=>{const cat=getCat(cid);sumData.push([language==='ar'?cat.name:cat.nameEn,Math.round(amt),totalFiltered?Math.round(amt/totalFiltered*100)+'%':'0%']);});
    const wb=XLSX.utils.book_new();const ws1=XLSX.utils.aoa_to_sheet(wsData);const ws2=XLSX.utils.aoa_to_sheet(sumData);
    XLSX.utils.book_append_sheet(wb,ws1,T('المصاريف','Expenses',language));XLSX.utils.book_append_sheet(wb,ws2,T('الملخص','Summary',language));
    XLSX.writeFile(wb,`expenses-${localDS()}.xlsx`);
    toast(T('تم التصدير 📤','Exported 📤',language));
  };

  return(<div style={{display:'flex',flexDirection:'column',gap:16}}>
    <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><h2 style={{fontSize:22,fontWeight:900}}>💰 {T('المصاريف','Expenses',language)}</h2><div style={{display:'flex',gap:6}}>
      <button className="btn btn-coral btn-sm" onClick={()=>setExpModal({_isNew:true})}>+ {T('مصروف','Expense',language)}</button>
      <button className="btn btn-ghost btn-sm" onClick={()=>setMgtMode(!mgtMode)}>{mgtMode?'✕':'⚙️'}</button>
      <button className="btn btn-ghost btn-sm" onClick={handleExportXlsx}>📤 Excel</button>
    </div></div>

    {mgtMode&&<div className="card" style={{padding:14}}>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:10}}><h3 style={{fontSize:14,fontWeight:800}}>🏷️ {T('التصنيفات','Categories',language)}</h3><button className="btn btn-teal btn-xs" onClick={()=>setCatModal({_isNew:true})}>+ {T('جديد','New',language)}</button></div>
      <div style={{display:'flex',flexWrap:'wrap',gap:6}}>{cats.map(c=>(<div key={c.id} style={{display:'flex',alignItems:'center',gap:4,padding:'6px 10px',borderRadius:10,background:`${c.color}22`,border:`1px solid ${c.color}44`}}>
        <span>{c.icon}</span><span style={{fontSize:12,fontWeight:600,color:c.color}}>{language==='ar'?c.name:c.nameEn}</span>
        <span style={{cursor:'pointer',fontSize:10,opacity:.6}} onClick={()=>setCatModal(c)}>✏️</span>
        <span style={{cursor:'pointer',fontSize:10,opacity:.6}} onClick={()=>onDeleteCategory(c)}>✕</span>
      </div>))}</div>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginTop:14,marginBottom:10}}><h3 style={{fontSize:14,fontWeight:800}}>🎯 {T('الميزانيات','Budgets',language)}</h3><button className="btn btn-gold btn-xs" onClick={()=>setBudModal({_isNew:true})}>+ {T('جديدة','New',language)}</button></div>
      {!budgets.length?<p style={{fontSize:12,color:'var(--text2)'}}>🫥 {T('لا ميزانيات','No budgets',language)}</p>:budgets.map(b=>{const spent=getBudgetSpent(b.id);const pct=b.totalAmount?Math.min(spent/b.totalAmount*100,100):0;return(
        <div key={b.id} className="exp-budget-card" style={{cursor:'pointer'}} onClick={()=>setExpModal({_isNew:true,budgetId:b.id,currency:b.currency})}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><div><span style={{fontSize:18}}>{b.icon}</span> <span style={{fontWeight:700,fontSize:14}}>{b.title}</span><span style={{fontSize:11,color:'var(--text2)',marginRight:6,marginLeft:6}}>{b.currency}</span></div><div style={{display:'flex',gap:4}}><span style={{cursor:'pointer',fontSize:12}} onClick={e=>{e.stopPropagation();setBudModal(b);}}>✏️</span><span style={{cursor:'pointer',fontSize:12}} onClick={e=>{e.stopPropagation();onDeleteBudget(b);}}>🗑️</span></div></div>
        <div style={{display:'flex',justifyContent:'space-between',marginTop:6,fontSize:12,fontWeight:700}}><span style={{color:pct>=100?'var(--coral)':pct>=80?'var(--gold)':'var(--lime)'}}>{fmtMoney(spent)} / {fmtMoney(b.totalAmount)} {b.currency}</span><span style={{color:pct>=100?'var(--coral)':'var(--text2)'}}>{Math.round(pct)}%</span></div>
        <div className="exp-budget-bar"><div className="exp-budget-fill" style={{width:`${pct}%`,background:pct>=100?'var(--coral)':pct>=80?'var(--gold)':'var(--lime)'}}/></div>
        {b.startDate&&<div style={{fontSize:10,color:'var(--text2)',marginTop:4}}>{b.startDate} → {b.endDate||'∞'}</div>}
      </div>);})}

      <div style={{marginTop:14,borderTop:'1px solid var(--border)',paddingTop:14}}>
        <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:10}}><h3 style={{fontSize:14,fontWeight:800}}>💱 {T('العملات وأسعار الصرف','Currency & Rates',language)}</h3><button className="btn btn-ghost btn-xs" onClick={refreshRates} disabled={rateLoading}>{rateLoading?'⏳':'🔄'} {T('تحديث','Refresh',language)}</button></div>
        <div style={{marginBottom:10}}><label style={{fontSize:12,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>{T('العملة الأساسية','Base Currency',language)}</label>
          <div style={{display:'flex',gap:6,flexWrap:'wrap'}}>{CURRENCIES.map(c=>(<div key={c.code} onClick={()=>setBaseCurrency(c.code)} style={{padding:'6px 12px',borderRadius:10,fontSize:12,fontWeight:700,cursor:'pointer',border:`2px solid ${baseCur===c.code?'var(--teal)':'var(--border)'}`,background:baseCur===c.code?'var(--teal-g)':'transparent',color:baseCur===c.code?'var(--teal)':'var(--text2)'}}>{c.icon} {c.code}</div>))}</div>
        </div>
        <div style={{display:'flex',flexDirection:'column',gap:6}}>
          {CURRENCIES.filter(c=>c.code!==baseCur).map(c=>{const isManual=rateData.manualOverrides?.[c.code]!==undefined;return(
            <div key={c.code} style={{display:'flex',alignItems:'center',gap:8,padding:'6px 10px',borderRadius:10,background:'var(--bg3)',fontSize:12}}>
              <span style={{width:30}}>{c.icon}</span>
              <span style={{fontWeight:700,width:40}}>{c.code}</span>
              <span style={{color:'var(--text2)',flex:1}}>1 {baseCur} =</span>
              <input type="number" step="0.01" value={(rates[c.code]/rates[baseCur]).toFixed(4)} onChange={e=>{const v=parseFloat(e.target.value);if(v>0){const newRate=v*rates[baseCur];setManualRate(c.code,newRate);}}} style={{width:80,padding:'4px 6px',borderRadius:6,border:'1px solid var(--border)',background:'var(--bg2)',color:'var(--text)',fontSize:12,fontWeight:700,textAlign:'center'}}/>
              <span style={{fontSize:10,fontWeight:600,color:isManual?'var(--gold)':'var(--lime)'}}>{isManual?T('يدوي','Manual',language):T('تلقائي','Auto',language)}</span>
              {isManual&&<span style={{cursor:'pointer',fontSize:10}} onClick={()=>clearManualRate(c.code)}>↩️</span>}
            </div>);})}
        </div>
        {rateData.updated&&<div style={{fontSize:10,color:'var(--text2)',marginTop:6,textAlign:'center'}}>✅ {T('آخر تحديث: ','Last update: ',language)}{new Date(rateData.updated).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{day:'numeric',month:'short',hour:'2-digit',minute:'2-digit'})}</div>}
      </div>
    </div>}

    <div className="exp-summary">
      <div className="exp-summary-card"><div className="exp-lbl">{T('هذا الشهر','This Month',language)} ({baseCur})</div><div className="exp-val" style={{color:'var(--coral)'}}>{fmtMoney(monthTotal)}</div></div>
      <div className="exp-summary-card"><div className="exp-lbl">{T('الفترة المحددة','Selected Period',language)} ({baseCur})</div><div className="exp-val" style={{color:'var(--teal)'}}>{fmtMoney(totalFiltered)}</div><div className="exp-lbl">{filtered.length} {T('عملية','transactions',language)}</div></div>
    </div>

    <div className="card" style={{padding:14}}>
      <div style={{display:'flex',gap:4,marginBottom:10,flexWrap:'wrap'}}>{dateRanges.map(r=>(<div key={r.id} className={`exp-tab ${dateRange===r.id?'active':''}`} onClick={()=>setDateRange(r.id)}>{r.l}</div>))}</div>
      {dateRange==='custom'&&<div style={{display:'flex',gap:8,marginBottom:10}}><input className="field" type="date" value={customFrom} onChange={e=>setCustomFrom(e.target.value)} style={{flex:1,fontSize:12}}/><input className="field" type="date" value={customTo} onChange={e=>setCustomTo(e.target.value)} style={{flex:1,fontSize:12}}/></div>}
      <div className="exp-tabs">{chartTabs.map(t=>(<div key={t.id} className={`exp-tab ${chartTab===t.id?'active':''}`} onClick={()=>setChartTab(t.id)}>{t.icon} {t.l}</div>))}</div>
      <div className="exp-chart-wrap">
        {chartTab==='pie'&&<ExpPieChart expenses={filtered} categories={cats} language={language} toBase={toBase}/>}
        {chartTab==='trend'&&<ExpTrendLine expenses={filtered} language={language} toBase={toBase}/>}
        {chartTab==='bars'&&<ExpMonthlyBars expenses={allExp} categories={cats} language={language} toBase={toBase}/>}
        {chartTab==='table'&&(<div style={{width:'100%',maxHeight:300,overflowY:'auto'}}><table style={{width:'100%',fontSize:12,borderCollapse:'collapse'}}><thead><tr style={{borderBottom:'2px solid var(--border)'}}><th style={{textAlign:'start',padding:6,fontWeight:700}}>{T('التصنيف','Category',language)}</th><th style={{textAlign:'start',padding:6,fontWeight:700}}>{T('المبلغ','Amount',language)} ({baseCur})</th><th style={{textAlign:'start',padding:6,fontWeight:700}}>%</th></tr></thead><tbody>{(()=>{const byC={};filtered.forEach(e=>{byC[e.category]=(byC[e.category]||0)+toBase(e.amount,e.currency);});return Object.entries(byC).sort((a,b)=>b[1]-a[1]).map(([cid,amt])=>{const cat=getCat(cid);return(<tr key={cid} style={{borderBottom:'1px solid var(--border)'}}><td style={{padding:6}}>{cat.icon} {language==='ar'?cat.name:cat.nameEn}</td><td style={{padding:6,fontWeight:700}}>{fmtMoney(amt)}</td><td style={{padding:6,color:'var(--text2)'}}>{totalFiltered?Math.round(amt/totalFiltered*100):0}%</td></tr>);});})()}</tbody></table></div>)}
        {chartTab==='budgets'&&(<div style={{width:'100%'}}>{!budgets.length?<p style={{textAlign:'center',color:'var(--text2)',padding:20}}>{T('لا ميزانيات — أضف من ⚙️','No budgets — add from ⚙️',language)}</p>:selBudget?(()=>{
          const b=budgets.find(x=>x.id===selBudget);if(!b)return null;
          const bExps=allExp.filter(e=>e.budgetId===b.id);
          const spent=bExps.reduce((s,e)=>s+toBudgetCur(e.amount,e.currency,b.currency),0);
          const pct=b.totalAmount?Math.min(spent/b.totalAmount*100,100):0;
          const remaining=b.totalAmount-spent;
          // By category with expenses
          const byC={};bExps.forEach(e=>{const cid=e.category;if(!byC[cid])byC[cid]={amount:0,count:0,items:[]};byC[cid].amount+=toBudgetCur(e.amount,e.currency,b.currency);byC[cid].count++;byC[cid].items.push(e);});
          Object.values(byC).forEach(v=>v.items.sort((a,b)=>new Date(b.date)-new Date(a.date)));
          const catEntries=Object.entries(byC).sort((a,b)=>b[1].amount-a[1].amount);
          // By date
          const byDate={};bExps.sort((a,b)=>new Date(b.date)-new Date(a.date)).forEach(e=>{if(!byDate[e.date])byDate[e.date]=[];byDate[e.date].push(e);});
          return(<div>
            <div style={{display:'flex',alignItems:'center',gap:8,marginBottom:14}}>
              <button className="btn btn-ghost btn-sm" onClick={()=>setSelBudget(null)}>←</button>
              <span style={{fontSize:24}}>{b.icon}</span>
              <div style={{flex:1}}><div style={{fontWeight:800,fontSize:16}}>{b.title}</div><div style={{fontSize:11,color:'var(--text2)'}}>{b.startDate&&`${b.startDate} → ${b.endDate||'∞'}`}</div></div>
              <div style={{display:'flex',gap:4}}>
                <button className="btn btn-ghost btn-xs" onClick={()=>setBudModal(b)}>✏️</button>
                <button className="btn btn-ghost btn-xs" style={{color:'var(--coral)'}} onClick={()=>{onDeleteBudget(b);setSelBudget(null);}}>🗑️</button>
                <button className="btn btn-coral btn-xs" onClick={()=>setExpModal({_isNew:true,budgetId:b.id,currency:b.currency})}>+ {T('مصروف','Expense',language)}</button>
              </div>
            </div>

            <div className="exp-budget-card" style={{marginBottom:14}}>
              <div style={{display:'flex',justifyContent:'space-between',alignItems:'baseline'}}><span style={{fontSize:28,fontWeight:900,color:pct>=100?'var(--coral)':pct>=80?'var(--gold)':'var(--lime)'}}>{Math.round(pct)}%</span><span style={{fontSize:14,fontWeight:700,color:'var(--text2)'}}>{fmtMoney(spent)} / {fmtMoney(b.totalAmount)} {b.currency}</span></div>
              <div className="exp-budget-bar" style={{height:12,marginTop:8}}><div className="exp-budget-fill" style={{width:`${pct}%`,background:pct>=100?'linear-gradient(90deg,var(--gold),var(--coral))':pct>=80?'linear-gradient(90deg,var(--lime),var(--gold))':'var(--lime)'}}/></div>
              <div style={{display:'flex',justifyContent:'space-between',marginTop:6,fontSize:12,fontWeight:600}}><span style={{color:'var(--text2)'}}>{bExps.length} {T('عملية','transactions',language)}</span><span style={{color:remaining<0?'var(--coral)':'var(--lime)'}}>{remaining>=0?T('متبقي: ','Left: ',language)+fmtMoney(remaining):T('تجاوز: ','Over: ',language)+fmtMoney(Math.abs(remaining))} {b.currency}</span></div>
            </div>

            {catEntries.length>0&&<div className="card" style={{padding:14,marginBottom:14}}>
              <h4 style={{fontSize:13,fontWeight:800,marginBottom:10}}>📊 {T('حسب التصنيف','By Category',language)}</h4>
              {catEntries.map(([cid,info])=>{const cat=getCat(cid);const catPct=spent?Math.round(info.amount/spent*100):0;const isOpen=expandedCats[cid];return(
                <div key={cid}>
                <div onClick={()=>setExpandedCats(p=>({...p,[cid]:!p[cid]}))} style={{display:'flex',alignItems:'center',gap:8,padding:'10px 0',borderBottom:'1px solid var(--border)',cursor:'pointer',transition:'background .15s'}}>
                  <div className="exp-cat-dot" style={{background:`${cat.color}22`,width:36,height:36,fontSize:18}}>{cat.icon}</div>
                  <div style={{flex:1}}><div style={{fontWeight:700,fontSize:13}}>{language==='ar'?cat.name:cat.nameEn}</div><div style={{fontSize:10,color:'var(--text2)'}}>{info.count} {T('عملية','items',language)}</div></div>
                  <div style={{textAlign:'end',marginLeft:4,marginRight:4}}><div style={{fontWeight:800,fontSize:14,color:cat.color}}>{fmtMoney(info.amount)} {b.currency}</div><div style={{fontSize:10,color:'var(--text2)'}}>{catPct}%</div></div>
                  <span style={{fontSize:12,transition:'transform .2s',transform:isOpen?'rotate(180deg)':'rotate(0)',color:'var(--text2)'}}>▼</span>
                </div>
                {isOpen&&<div style={{padding:'4px 0 8px',borderBottom:'1px solid var(--border)',background:'var(--bg3)',borderRadius:'0 0 8px 8px',marginBottom:4}}>
                  {info.items.map(e=>(
                    <div key={e.id} style={{display:'flex',alignItems:'center',gap:8,padding:'7px 12px'}}>
                      <div style={{width:6,height:6,borderRadius:'50%',background:cat.color,flexShrink:0}}/>
                      <div style={{flex:1,minWidth:0}}><div style={{fontWeight:600,fontSize:12}}>{e.title}</div>{e.notes&&<div style={{fontSize:10,color:'var(--text2)',overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}}>📝 {e.notes}</div>}</div>
                      <div style={{textAlign:'end',flexShrink:0}}><div style={{fontWeight:700,fontSize:12,color:cat.color}}>{e.amount.toFixed(e.amount%1?2:0)} {e.currency}</div><div style={{fontSize:9,color:'var(--text2)'}}>{new Date(e.date+'T12:00').toLocaleDateString(language==='ar'?'ar-SA':'en-US',{day:'numeric',month:'short'})}</div></div>
                    </div>))}
                </div>}
                </div>);})}
            </div>}

            {Object.entries(byDate).length>0&&<div className="card" style={{padding:14}}>
              <h4 style={{fontSize:13,fontWeight:800,marginBottom:10}}>📅 {T('حسب التاريخ','By Date',language)}</h4>
              {Object.entries(byDate).map(([date,exps])=>(<div key={date}>
                <div style={{fontSize:11,fontWeight:700,color:'var(--text2)',padding:'8px 0 4px',borderBottom:'1px solid var(--border)',display:'flex',justifyContent:'space-between'}}><span>{new Date(date+'T12:00').toLocaleDateString(language==='ar'?'ar-SA':'en-US',{weekday:'short',day:'numeric',month:'short'})}</span><span>{fmtMoney(exps.reduce((s,e)=>s+toBudgetCur(e.amount,e.currency,b.currency),0))} {b.currency}</span></div>
                {exps.map(e=>{const cat=getCat(e.category);return(
                  <div key={e.id} style={{display:'flex',alignItems:'center',gap:8,padding:'8px 0',borderBottom:'1px solid var(--border)'}}>
                    <span style={{fontSize:16}}>{cat.icon}</span>
                    <div style={{flex:1,minWidth:0}}><div style={{fontWeight:600,fontSize:13}}>{e.title}</div>{e.notes&&<div style={{fontSize:10,color:'var(--text2)'}}>📝 {e.notes.length>40?e.notes.slice(0,40)+'...':e.notes}</div>}</div>
                    <div style={{textAlign:'end'}}><div style={{fontWeight:800,fontSize:13,color:cat.color}}>{e.amount.toFixed(e.amount%1?2:0)} {e.currency}</div>{e.currency!==b.currency&&<div style={{fontSize:9,color:'var(--text2)'}}>≈ {fmtMoney(toBudgetCur(e.amount,e.currency,b.currency))} {b.currency}</div>}</div>
                  </div>);})}
              </div>))}
            </div>}

            {!bExps.length&&<p style={{textAlign:'center',color:'var(--text2)',padding:20}}>🫥 {T('لا مصاريف في هذه الميزانية','No expenses in this budget',language)}</p>}
          </div>);
        })():<><p style={{fontSize:11,color:'var(--text2)',textAlign:'center',marginBottom:8}}>💡 {T('اضغط على الميزانية لعرض التقرير','Tap a budget to view report',language)}</p>{budgets.map(b=>{const spent=getBudgetSpent(b.id);const pct=b.totalAmount?Math.min(spent/b.totalAmount*100,100):0;const remaining=b.totalAmount-spent;return(
          <div key={b.id} className="exp-budget-card" style={{cursor:'pointer'}} onClick={()=>{setSelBudget(b.id);setExpandedCats({});}}><div style={{display:'flex',alignItems:'center',gap:8}}><span style={{fontSize:24}}>{b.icon}</span><div style={{flex:1}}><div style={{fontWeight:700,fontSize:14}}>{b.title}</div><div style={{fontSize:11,color:'var(--text2)'}}>{b.currency} {fmtMoney(b.totalAmount)}</div></div><div style={{textAlign:'end'}}><div style={{fontWeight:900,fontSize:18,color:pct>=100?'var(--coral)':pct>=80?'var(--gold)':'var(--lime)'}}>{Math.round(pct)}%</div><div style={{fontSize:10,color:remaining<0?'var(--coral)':'var(--text2)'}}>{remaining>=0?T('متبقي: ','Left: ',language)+fmtMoney(remaining)+' '+b.currency:T('تجاوز: ','Over: ',language)+fmtMoney(Math.abs(remaining))+' '+b.currency}</div></div></div>
          <div className="exp-budget-bar" style={{height:10,marginTop:8}}><div className="exp-budget-fill" style={{width:`${pct}%`,background:pct>=100?'linear-gradient(90deg,var(--gold),var(--coral))':pct>=80?'linear-gradient(90deg,var(--lime),var(--gold))':'var(--lime)'}}/></div>
        </div>);})}</>}</div>)}
      </div>
    </div>

    <div className="card" style={{padding:14}}>
      <div className="search-wrap" style={{marginBottom:10}}><span className="search-icon">🔍</span><input className="field" value={expSearch} onChange={e=>setExpSearch(e.target.value)} placeholder={T('ابحث في المصاريف...','Search expenses...',language)} style={{paddingRight:language==='ar'?36:12,paddingLeft:language!=='ar'?36:12}}/>{expSearch&&<span className="search-clear" onClick={()=>setExpSearch('')}>✕</span>}</div>
      {!grouped.length?<p style={{textAlign:'center',color:'var(--text2)',padding:20}}>🫥 {T('لا مصاريف','No expenses',language)}</p>:grouped.map(([date,exps])=>(<div key={date}>
        <div className="exp-date-group">{new Date(date+'T12:00').toLocaleDateString(language==='ar'?'ar-SA':'en-US',{weekday:'long',day:'numeric',month:'short'})} — {fmtMoney(exps.reduce((s,e)=>s+toBase(e.amount,e.currency),0))} {baseCur}</div>
        {exps.map(e=>{const cat=getCat(e.category);return(<div key={e.id} className="exp-item">
          <div className="exp-cat-dot" style={{background:`${cat.color}22`}}>{cat.icon}</div>
          <div style={{flex:1,minWidth:0}}><div style={{fontWeight:700,fontSize:14}}>{e.title}</div><div style={{fontSize:11,color:'var(--text2)',display:'flex',gap:6}}><span>{language==='ar'?cat.name:cat.nameEn}</span>{e.paymentMethod&&<span>· {e.paymentMethod==='cash'?'💵':e.paymentMethod==='card'?'💳':'🏦'}</span>}{e.notes&&<span>· 📝</span>}</div></div>
          <div style={{textAlign:'end'}}><div className="exp-amount" style={{color:cat.color}}>{e.amount.toFixed(e.amount%1?2:0)}</div><div style={{fontSize:10,color:'var(--text2)'}}>{CURRENCIES.find(c=>c.code===e.currency)?.icon} {e.currency}{e.currency!==baseCur&&<span style={{opacity:.6}}> ≈ {fmtMoney(toBase(e.amount,e.currency))} {baseCur}</span>}</div></div>
          <div style={{display:'flex',flexDirection:'column',gap:2}}><button className="btn btn-ghost btn-icon-xs" onClick={()=>setExpModal(e)}>✏️</button><button className="btn btn-ghost btn-icon-xs" style={{color:'var(--coral)'}} onClick={()=>onDeleteExpense(e)}>🗑️</button></div>
        </div>);})}
      </div>))}
    </div>

    {expModal&&<ExpenseModal expense={expModal} categories={cats} budgets={budgets} language={language} onSave={e=>{onSaveExpense(e);setExpModal(null);}} onClose={()=>setExpModal(null)}/>}
    {catModal&&<CategoryModal category={catModal} language={language} onSave={c=>{onSaveCategory(c);setCatModal(null);}} onClose={()=>setCatModal(null)}/>}
    {budModal&&<BudgetModal budget={budModal} language={language} onSave={b=>{onSaveBudget(b);setBudModal(null);}} onClose={()=>setBudModal(null)}/>}
  </div>);
}

// ========== NOTES / MYFAKRA ==========
const NOTE_COLORS=['#1E2744','#2D1B1B','#1B2D1B','#1B1B2D','#2D2B1B','#1B2D2D','#2D1B2D','#2B2D1B'];
const NOTE_TYPES=[
  {id:'text',icon:'📝',l_ar:'نص',l_en:'Text'},
  {id:'checklist',icon:'✅',l_ar:'قائمة',l_en:'Checklist'},
  {id:'link',icon:'🔗',l_ar:'رابط',l_en:'Link'},
  {id:'idea',icon:'💡',l_ar:'فكرة',l_en:'Idea'}
];

// Reminder checker
function checkReminders(notes,language,toast){
  const now=new Date();
  notes.forEach(n=>{
    if(n.reminder&&!n.reminderFired){
      const rd=new Date(n.reminder);
      if(rd<=now){
        if('Notification' in window&&Notification.permission==='granted'){
          new Notification(n.title||T('تذكير','Reminder',language),{body:n.content?.slice(0,100)||'',icon:'📓'});
        }
        toast(`⏰ ${n.title||T('تذكير','Reminder',language)}`);
        n._shouldFire=true;
      }
    }
  });
  return notes.filter(n=>n._shouldFire).map(n=>({...n,reminderFired:true,_shouldFire:undefined}));
}

function NoteModal({note,language,onSave,onDelete,onClose}){
  const isE=note&&note.id&&!note._isNew;
  const[form,setForm]=useState(()=>isE?{...note,checklist:note.checklist||[]}:{
    title:'',content:'',type:'text',color:NOTE_COLORS[0],pinned:false,
    checklist:[],linkUrl:'',linkDesc:'',
    reminder:'',reminderFired:false
  });
  const f=(k,v)=>setForm(p=>({...p,[k]:v}));

  // Checklist management
  const addCheckItem=()=>f('checklist',[...form.checklist,{id:uid(),text:'',done:false}]);
  const updateCheckItem=(id,key,val)=>f('checklist',form.checklist.map(c=>c.id===id?{...c,[key]:val}:c));
  const removeCheckItem=(id)=>f('checklist',form.checklist.filter(c=>c.id!==id));

  const save=()=>{
    if(!form.title.trim()&&!form.content?.trim()&&!form.checklist.length&&!form.linkUrl)return;
    onSave({...form,id:form.id||uid(),updatedAt:new Date().toISOString(),createdAt:form.createdAt||new Date().toISOString()});
  };

  return(<div className="overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()} style={{maxWidth:440,maxHeight:'92dvh',overflow:'auto'}}>
    <div style={{padding:'16px 20px',borderBottom:'1px solid var(--border)',display:'flex',justifyContent:'space-between',alignItems:'center'}}>
      <h3 style={{fontSize:16,fontWeight:800}}>{isE?T('تعديل','Edit',language):T('ملاحظة جديدة','New Note',language)}</h3>
      <div style={{display:'flex',gap:6}}>
        <button className={`btn btn-ghost btn-xs ${form.pinned?'btn-gold':''}`} onClick={()=>f('pinned',!form.pinned)}>📌</button>
        <button className="btn btn-ghost btn-icon-sm" onClick={onClose}>✕</button>
      </div>
    </div>
    <div style={{padding:16,display:'flex',flexDirection:'column',gap:12}}>

      <div className="note-type-tabs">{NOTE_TYPES.map(t=>(<div key={t.id} className={`exp-tab ${form.type===t.id?'active':''}`} onClick={()=>f('type',t.id)}>{t.icon} {language==='ar'?t.l_ar:t.l_en}</div>))}</div>

      <input className="field" value={form.title} onChange={e=>f('title',e.target.value)} placeholder={T('العنوان...','Title...',language)} style={{fontSize:16,fontWeight:700}}/>

      {form.type==='text'&&<textarea className="field" rows={5} value={form.content} onChange={e=>f('content',e.target.value)} placeholder={T('اكتب ملاحظتك...','Write your note...',language)} style={{lineHeight:1.7,resize:'vertical'}}/>}

      {form.type==='idea'&&<textarea className="field" rows={4} value={form.content} onChange={e=>f('content',e.target.value)} placeholder={T('اكتب فكرتك...','Write your idea...',language)} style={{lineHeight:1.7,resize:'vertical'}}/>}

      {form.type==='checklist'&&<div style={{display:'flex',flexDirection:'column',gap:6}}>
        {form.checklist.map(c=>(<div key={c.id} style={{display:'flex',alignItems:'center',gap:8}}>
          <div onClick={()=>updateCheckItem(c.id,'done',!c.done)} style={{width:22,height:22,borderRadius:6,border:'2px solid var(--border)',background:c.done?'var(--lime)':'transparent',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:12,color:'white',flexShrink:0}}>{c.done&&'✓'}</div>
          <input className="field" value={c.text} onChange={e=>updateCheckItem(c.id,'text',e.target.value)} placeholder={T('عنصر...','Item...',language)} style={{flex:1,fontSize:13,textDecoration:c.done?'line-through':'none'}}/>
          <span style={{cursor:'pointer',fontSize:12,color:'var(--coral)'}} onClick={()=>removeCheckItem(c.id)}>✕</span>
        </div>))}
        <button className="btn btn-ghost btn-sm" onClick={addCheckItem} style={{alignSelf:'flex-start'}}>+ {T('عنصر جديد','New item',language)}</button>
      </div>}

      {form.type==='link'&&<div style={{display:'flex',flexDirection:'column',gap:8}}>
        <input className="field" value={form.linkUrl} onChange={e=>f('linkUrl',e.target.value)} placeholder="https://..." style={{fontSize:13}} dir="ltr"/>
        <textarea className="field" rows={2} value={form.linkDesc||form.content} onChange={e=>{f('linkDesc',e.target.value);f('content',e.target.value);}} placeholder={T('وصف الرابط...','Link description...',language)}/>
      </div>}

      <div><label style={{fontSize:11,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>🎨 {T('اللون','Color',language)}</label>
        <div style={{display:'flex',gap:6,flexWrap:'wrap'}}>{NOTE_COLORS.map(c=>(<div key={c} onClick={()=>f('color',c)} style={{width:28,height:28,borderRadius:8,background:c,cursor:'pointer',border:`2px solid ${form.color===c?'var(--teal)':'transparent'}`,transition:'border .15s'}}/>))}</div>
      </div>

      <div><label style={{fontSize:11,fontWeight:700,color:'var(--text2)',marginBottom:4,display:'block'}}>⏰ {T('تذكير (اختياري)','Reminder (optional)',language)}</label>
        <input className="field" type="datetime-local" value={form.reminder||''} onChange={e=>f('reminder',e.target.value)} style={{fontSize:12}}/>
        {form.reminder&&<button className="btn btn-ghost btn-xs" style={{marginTop:4}} onClick={()=>{f('reminder','');f('reminderFired',false);}}>✕ {T('إلغاء التذكير','Remove reminder',language)}</button>}
      </div>

    </div>
    <div style={{padding:'14px 20px',borderTop:'1px solid var(--border)',display:'flex',gap:10,justifyContent:'flex-end'}}>
      {onDelete&&<button className="btn btn-ghost" style={{color:'var(--coral)',marginLeft:'auto',marginRight:'auto'}} onClick={onDelete}>🗑️ {T('حذف','Delete',language)}</button>}
      <button className="btn btn-ghost" onClick={onClose}>{T('إلغاء','Cancel',language)}</button>
      <button className="btn btn-teal" onClick={save}>📓 {T('حفظ','Save',language)}</button>
    </div>
  </div></div>);
}

function Notes({data,language,onSaveNote,onDeleteNote,toast}){
  const[noteModal,setNoteModal]=useState(null);
  const[viewMode,setViewMode]=useState('grid');
  const[noteSearch,setNoteSearch]=useState('');
  const[typeFilter,setTypeFilter]=useState('all');

  const allNotes=data.notes||[];

  // Request notification permission
  useEffect(()=>{if('Notification' in window&&Notification.permission==='default'){Notification.requestPermission();}},[]);

  // Check reminders every 30s
  useEffect(()=>{
    const check=()=>{const fired=checkReminders(allNotes,language,toast);fired.forEach(n=>onSaveNote(n));};
    check();
    const iv=setInterval(check,30000);
    return()=>clearInterval(iv);
  },[allNotes,language,toast,onSaveNote]);

  const filtered=useMemo(()=>{
    let notes=allNotes;
    if(typeFilter!=='all')notes=notes.filter(n=>n.type===typeFilter);
    if(noteSearch){const q=noteSearch.toLowerCase();notes=notes.filter(n=>(n.title||'').toLowerCase().includes(q)||(n.content||'').toLowerCase().includes(q)||(n.linkUrl||'').toLowerCase().includes(q)||(n.checklist||[]).some(c=>c.text.toLowerCase().includes(q)));}
    const pinned=notes.filter(n=>n.pinned).sort((a,b)=>new Date(b.updatedAt||b.createdAt)-new Date(a.updatedAt||a.createdAt));
    const rest=notes.filter(n=>!n.pinned).sort((a,b)=>new Date(b.updatedAt||b.createdAt)-new Date(a.updatedAt||a.createdAt));
    return{pinned,rest};
  },[allNotes,typeFilter,noteSearch]);

  const renderNoteCard=(n)=>{
    const typeInfo=NOTE_TYPES.find(t=>t.id===n.type)||NOTE_TYPES[0];
    const hasReminder=n.reminder&&!n.reminderFired;
    const isPastReminder=n.reminder&&new Date(n.reminder)<new Date()&&!n.reminderFired;
    const checkDone=n.checklist?n.checklist.filter(c=>c.done).length:0;
    const checkTotal=n.checklist?n.checklist.length:0;

    if(viewMode==='list'){
      return(<div key={n.id} className="note-card" style={{background:n.color||NOTE_COLORS[0],borderColor:n.pinned?'var(--gold)':'var(--border)'}} onClick={()=>setNoteModal(n)}>
        {n.pinned&&<span style={{fontSize:14,marginLeft:4,marginRight:4}}>📌</span>}
        <span style={{fontSize:20,flexShrink:0}}>{typeInfo.icon}</span>
        <div style={{flex:1,minWidth:0}}>
          <div className="note-card-title">{n.title||T('بدون عنوان','Untitled',language)}</div>
          <div className="note-card-body">{n.type==='checklist'?`${checkDone}/${checkTotal} ${T('مكتمل','done',language)}`:n.type==='link'?n.linkUrl:(n.content||'').slice(0,80)}</div>
        </div>
        <div style={{display:'flex',flexDirection:'column',alignItems:'flex-end',gap:4,flexShrink:0}}>
          {hasReminder&&<span className="note-reminder-badge">⏰ {new Date(n.reminder).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{day:'numeric',month:'short'})}</span>}
          <span style={{fontSize:9,color:'var(--text2)'}}>{new Date(n.updatedAt||n.createdAt).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{day:'numeric',month:'short'})}</span>
        </div>
      </div>);
    }

    return(<div key={n.id} className={`note-card ${n.pinned?'pinned':''}`} style={{background:n.color||NOTE_COLORS[0],borderColor:n.pinned?'var(--gold)':'var(--border)'}} onClick={()=>setNoteModal(n)}>
      {n.pinned&&<span className="note-pin">📌</span>}
      <div style={{display:'flex',alignItems:'center',gap:6,marginBottom:4}}>
        <span style={{fontSize:16}}>{typeInfo.icon}</span>
        <span className="note-card-title" style={{marginBottom:0,flex:1}}>{n.title||T('بدون عنوان','Untitled',language)}</span>
      </div>

      {n.type==='text'||n.type==='idea'?<div className="note-card-body">{n.content}</div>:null}

      {n.type==='checklist'&&<div style={{marginTop:2}}>
        {(n.checklist||[]).slice(0,4).map(c=>(<div key={c.id} className={`note-check-item ${c.done?'done':''}`}><span>{c.done?'☑':'☐'}</span><span>{c.text}</span></div>))}
        {(n.checklist||[]).length>4&&<div style={{fontSize:10,color:'var(--text2)',marginTop:2}}>+{n.checklist.length-4} {T('أخرى','more',language)}</div>}
      </div>}

      {n.type==='link'&&<div><div className="note-card-body" style={{color:'var(--teal)',fontSize:10,wordBreak:'break-all'}}>{n.linkUrl}</div>{n.linkDesc&&<div className="note-card-body" style={{marginTop:4}}>{n.linkDesc}</div>}</div>}

      <div className="note-card-footer">
        <span>{new Date(n.updatedAt||n.createdAt).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{day:'numeric',month:'short'})}</span>
        <div style={{display:'flex',gap:4,alignItems:'center'}}>
          {n.type==='checklist'&&<span style={{fontSize:10,fontWeight:700,color:checkDone===checkTotal&&checkTotal>0?'var(--lime)':'var(--text2)'}}>{checkDone}/{checkTotal}</span>}
          {hasReminder&&<span className="note-reminder-badge">⏰</span>}
        </div>
      </div>
    </div>);
  };

  const filters=[{id:'all',icon:'📓',l:T('الكل','All',language)},...NOTE_TYPES.map(t=>({id:t.id,icon:t.icon,l:language==='ar'?t.l_ar:t.l_en}))];

  return(<div style={{display:'flex',flexDirection:'column',gap:14}}>
    <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>
      <h2 style={{fontSize:22,fontWeight:900}}>📓 {T('مفكرتي','My Notes',language)}</h2>
      <div style={{display:'flex',gap:6}}>
        <button className="btn btn-ghost btn-sm" onClick={()=>setViewMode(v=>v==='grid'?'list':'grid')}>{viewMode==='grid'?'☰':'▦'}</button>
        <button className="btn btn-teal btn-sm" onClick={()=>setNoteModal({_isNew:true})}>+ {T('جديد','New',language)}</button>
      </div>
    </div>

    <div className="search-wrap"><span className="search-icon">🔍</span><input className="field" value={noteSearch} onChange={e=>setNoteSearch(e.target.value)} placeholder={T('ابحث في الملاحظات...','Search notes...',language)} style={{paddingRight:language==='ar'?36:12,paddingLeft:language!=='ar'?36:12}}/>{noteSearch&&<span className="search-clear" onClick={()=>setNoteSearch('')}>✕</span>}</div>

    <div className="note-type-tabs">{filters.map(f=>(<div key={f.id} className={`exp-tab ${typeFilter===f.id?'active':''}`} onClick={()=>setTypeFilter(f.id)}>{f.icon} {f.l}</div>))}</div>

    {filtered.pinned.length>0&&<div>
      <h3 style={{fontSize:13,fontWeight:700,color:'var(--gold)',marginBottom:8}}>📌 {T('المثبتة','Pinned',language)}</h3>
      <div className={viewMode==='grid'?'notes-grid':'notes-list'} style={viewMode==='list'?{display:'flex',flexDirection:'column',gap:8}:{}}>{filtered.pinned.map(renderNoteCard)}</div>
    </div>}

    <div>
      {filtered.pinned.length>0&&filtered.rest.length>0&&<h3 style={{fontSize:13,fontWeight:700,color:'var(--text2)',marginBottom:8}}>{T('الأخرى','Others',language)}</h3>}
      {filtered.rest.length>0?
        <div className={viewMode==='grid'?'notes-grid':'notes-list'} style={viewMode==='list'?{display:'flex',flexDirection:'column',gap:8}:{}}>{filtered.rest.map(renderNoteCard)}</div>:
        !filtered.pinned.length&&<div style={{textAlign:'center',padding:40,color:'var(--text2)'}}><div style={{fontSize:48}}>📓</div><p style={{fontSize:14,marginTop:8}}>{T('لا ملاحظات — أضف أول ملاحظة!','No notes — add your first note!',language)}</p></div>
      }
    </div>

    {noteModal&&<NoteModal note={noteModal} language={language} onSave={n=>{onSaveNote(n);setNoteModal(null);}} onDelete={noteModal.id&&!noteModal._isNew?()=>{onDeleteNote(noteModal);setNoteModal(null);}:null} onClose={()=>setNoteModal(null)}/>}
  </div>);
}

function Timeline({data,language}){const[tlSort,setTlSort]=useState('asc');const items=useMemo(()=>{const r=[];(data.goals||[]).forEach(g=>{if(g.startDate)r.push({...g,_type:'gstart',_date:g.startDate,_c:g.color});if(g.endDate)r.push({...g,_type:'gend',_date:g.endDate,_c:g.color});});(data.milestones||[]).forEach(m=>{if(m.dueDate)r.push({...m,_type:'ms',_date:m.dueDate,_c:'#FECA57'});});(data.tasks||[]).forEach(t=>{if(t.dueDate)r.push({...t,_type:'task',_date:t.dueDate,_c:'#00D2D3'});});(data.quickTasks||[]).forEach(q=>{if(q.dueDate)r.push({...q,_type:'qt',_date:q.dueDate,_c:'#5F7FFF'});});(data.meetings||[]).forEach(m=>{if(m.meetingDate)r.push({...m,_type:'meet',_date:m.meetingDate,_c:'#FF9FF3'});});r.sort((a,b)=>tlSort==='asc'?new Date(a._date)-new Date(b._date):new Date(b._date)-new Date(a._date));return r;},[data,tlSort]);const lb={gstart:{i:'🚀',l:T('بداية هدف','Goal Start',language)},gend:{i:'🏁',l:T('نهاية هدف','Goal End',language)},ms:{i:'📍',l:T('مرحلة','Milestone',language)},task:{i:'📝',l:T('مهمة','Task',language)},qt:{i:'✅',l:T('سريعة','Quick',language)},meet:{i:'👥',l:T('اجتماع','Meeting',language)}};const tStr=localDS();
return(<div style={{display:'flex',flexDirection:'column',gap:16}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><h2 style={{fontSize:22,fontWeight:900}}>📊 {T('الجدول الزمني','Timeline',language)}</h2><SortBtn sort={tlSort} onToggle={()=>setTlSort(s=>s==='asc'?'desc':'asc')} language={language}/></div>{!items.length?(<div className="card" style={{padding:50,textAlign:'center'}}><div style={{fontSize:56,marginBottom:16}}>⏳</div><p style={{color:'var(--text2)',fontWeight:600}}>{T('لا توجد عناصر','No items',language)}</p></div>):(<div style={{position:'relative',paddingRight:language==='ar'?28:0,paddingLeft:language!=='ar'?28:0}}><div style={{position:'absolute',top:0,bottom:0,width:3,background:'linear-gradient(180deg,var(--coral),var(--teal),var(--gold))',borderRadius:4,right:language==='ar'?11:'auto',left:language!=='ar'?11:'auto'}}/>{items.map((it,i)=>{const ds=it._date.split('T')[0],past=ds<tStr,isT=ds===tStr;const info=lb[it._type];const clr=it._c;return(<div key={i} style={{position:'relative',marginBottom:14,opacity:past?.5:1}}><div style={{position:'absolute',width:14,height:14,borderRadius:'50%',background:isT?'#FECA57':clr,right:language==='ar'?5:'auto',left:language!=='ar'?5:'auto',top:18,border:'3px solid var(--bg2)',zIndex:1,boxShadow:isT?'0 0 10px var(--gold-g)':'none'}}/><div className="card" style={{marginRight:language==='ar'?22:0,marginLeft:language!=='ar'?22:0,padding:14}}><div style={{display:'flex',alignItems:'center',gap:10}}><span style={{fontSize:24}}>{it.icon||info.i}</span><div style={{flex:1,minWidth:0}}><div style={{fontWeight:700,fontSize:14}}>{it.title}</div><div style={{display:'flex',gap:6,flexWrap:'wrap',marginTop:4,alignItems:'center'}}><span className="badge" style={{background:`${clr}22`,color:clr}}>{info.i} {info.l}</span><span style={{fontSize:11,color:'var(--text2)',fontWeight:600}}>{new Date(it._date).toLocaleDateString(language==='ar'?'ar-SA':'en-US',{month:'short',day:'numeric',year:'numeric'})}</span>{it._type==='meet'&&it.location&&<span style={{fontSize:11,color:'var(--text2)'}}>📍 {it.location}</span>}</div></div>{isT&&<span className="badge" style={{background:'var(--gold-g)',color:'var(--gold)',animation:'pulse 2s infinite'}}>🔥 {T('اليوم','Today',language)}</span>}</div></div></div>);})}</div>)}</div>);}

// ========== APP ==========
function App(){
  const[lang,setLang]=useState('ar');const[view,setView]=useState('dashboard');
  const[data,setData]=useState({goals:[],milestones:[],tasks:[],quickTasks:[],taskLists:[],meetings:[]});
  const[toasts,setToasts]=useState([]);const[modal,setModal]=useState(null);const[confirm,setConfirm]=useState(null);
  const[dayView,setDayView]=useState(null);const[listModal,setListModal]=useState(null);const[uploadModal,setUploadModal]=useState(false);
  const[theme,setTheme]=useState(()=>localStorage.getItem('gt-theme')||'dark');
  const[previewMode,setPreviewMode]=useState('desktop');
  const[search,setSearch]=useState('');
  const[filter,setFilter]=useState('all');
  const[installPrompt,setInstallPrompt]=useState(null);
  const[calOpen,setCalOpen]=useState(()=>window.innerWidth>=768);
  const[expFromCal,setExpFromCal]=useState(null);
  useEffect(()=>{const h=e=>{e.preventDefault();setInstallPrompt(e);};window.addEventListener('beforeinstallprompt',h);return()=>window.removeEventListener('beforeinstallprompt',h);},[]);
  const handleInstall=useCallback(async()=>{if(!installPrompt)return;installPrompt.prompt();const{outcome}=await installPrompt.userChoice;if(outcome==='accepted')toast(T('تم التثبيت! 📱','Installed! 📱',lang));setInstallPrompt(null);},[installPrompt,toast,lang]);

  const load=useCallback(async()=>{const d={};for(const s of ST)d[s]=await dAll(s);setData(d);},[]);
  useEffect(()=>{(async()=>{await initCats();await load();})();},[load]);
  useEffect(()=>{document.documentElement.lang=lang;document.documentElement.dir=lang==='ar'?'rtl':'ltr';},[lang]);
  useEffect(()=>{document.documentElement.className=theme==='light'?'light':'';localStorage.setItem('gt-theme',theme);},[theme]);
  const toast=useCallback((msg,type='success')=>{const id=Date.now();setToasts(p=>[...p,{id,message:msg,type}]);setTimeout(()=>setToasts(p=>p.filter(t=>t.id!==id)),3000);},[]);
  const tsMap={goal:'goals',milestone:'milestones',task:'tasks',quickTask:'quickTasks',meeting:'meetings'};

  const handleSave=useCallback(async(type,item)=>{if(type==='milestone'&&modal?.goalId)item.goalId=modal.goalId;try{await dPut(tsMap[type],item);await load();toast(T('تم الحفظ ✅','Saved ✅',lang));setModal(null);}catch(e){toast(T('خطأ','Error',lang),'error');}},[modal,lang,load,toast]);
  const handleAdd=useCallback((type,gid,msid)=>{if(type==='taskList'){setListModal({});return;}setModal({type,goalId:gid,milestoneId:msid,editItem:null});},[]);
  const handleEdit=useCallback((type,item)=>{if(type==='taskList'){setListModal(item);return;}setModal({type,editItem:item});},[]);
  const handleDelete=useCallback((store,id,title)=>{setConfirm({message:T(`حذف "${title}"؟`,`Delete "${title}"?`,lang),onOk:async()=>{await dDel(store,id);if(store==='goals'){for(const m of(data.milestones||[]).filter(m=>m.goalId===id)){for(const tk of(data.tasks||[]).filter(tk=>tk.milestoneId===m.id))await dDel('tasks',tk.id);await dDel('milestones',m.id);}}if(store==='milestones'){for(const tk of(data.tasks||[]).filter(tk=>tk.milestoneId===id))await dDel('tasks',tk.id);}await load();toast(T('تم الحذف 🗑️','Deleted 🗑️',lang));setConfirm(null);}});},[lang,data,load,toast]);
  const handleStatus=useCallback(async(store,item,ns)=>{const u={...item,status:ns,updatedAt:new Date().toISOString()};delete u._s;delete u._ns;delete u._type;await dPut(store,u);if(ns==='complete'){toast(cheer(lang),'success');}if(ns==='complete'&&item.repeat&&item.repeat!=='never'&&store==='tasks'){const dd=new Date(item.dueDate);let nd;if(item.repeat==='daily')nd=new Date(dd.setDate(dd.getDate()+1));else if(item.repeat==='weekly')nd=new Date(dd.setDate(dd.getDate()+7));else nd=new Date(dd.setMonth(dd.getMonth()+1));const end=item.repeatEndDate?new Date(item.repeatEndDate):null;if(!end||nd<=end){const nt={...item,id:uid(),status:'notStarted',dueDate:nlocalDS(d),createdAt:new Date().toISOString()};delete nt._s;delete nt._ns;delete nt._type;await dPut('tasks',nt);toast(T('🔄 مهمة متكررة','🔄 Recurring task',lang),'info');}}await load();},[load,toast,lang]);
  const handleSaveList=useCallback(async l=>{await dPut('taskLists',l);await load();},[load]);
  const handleDeleteList=useCallback(l=>{setConfirm({message:T(`حذف "${l.name}"؟`,`Delete "${l.name}"?`,lang),onOk:async()=>{await dDel('taskLists',l.id);await load();toast(T('تم الحذف','Deleted',lang));setConfirm(null);}});},[lang,load,toast]);
  const handleSaveListModal=useCallback(async l=>{await dPut('taskLists',l);await load();toast(T('تم الحفظ','Saved',lang));setListModal(null);},[load,toast,lang]);
  const handleReorder=useCallback(async(store,items)=>{for(const it of items){const clean={...it};delete clean._type;delete clean._s;delete clean._ns;await dPut(store,clean);}await load();},[load]);
  const handleDayClick=useCallback((ds,items)=>setDayView({dateStr:ds,items}),[]);
  const handleAddFromDay=useCallback((type,ds)=>{setDayView(null);setModal(type==='quickTask'?{type:'quickTask',editItem:{dueDate:ds}}:{type:'meeting',editItem:{meetingDate:ds+'T09:00'}});},[]);

  // XLSX Import
  const handleXlsxImport = useCallback(async (parsed) => {
    try {
      for (const store of ST) {
        if (parsed[store] && parsed[store].length) {
          for (const item of parsed[store]) await dPut(store, item);
        }
      }
      await load();
      const total = Object.values(parsed).reduce((s, a) => s + a.length, 0);
      toast(T(`تم استيراد ${total} عنصر بنجاح 🎉`, `Successfully imported ${total} items 🎉`, lang));
      setUploadModal(false);
    } catch (e) {
      toast(T('خطأ في الاستيراد', 'Import error', lang), 'error');
    }
  }, [load, toast, lang]);

  // JSON Export/Import
  const handleExport=useCallback(async()=>{const d={};for(const s of ST)d[s]=await dAll(s);const b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download=`goal-tracker-backup-${localDS()}.json`;a.click();localStorage.setItem('gt-last-export',new Date().toISOString());toast(T('تم تصدير كل البيانات 📤','All data exported 📤',lang));},[lang,toast]);
  const handleCalExport=useCallback(()=>{const{content,count}=generateICS(data,lang);if(!count){toast(T('لا توجد مهام بتاريخ للتصدير','No dated tasks to export',lang),'warning');return;}const b=new Blob([content],{type:'text/calendar;charset=utf-8'});const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download=`goal-tracker-${localDS()}.ics`;a.click();toast(T(`تم تصدير ${count} حدث للتقويم 📅`,`Exported ${count} events to calendar 📅`,lang));},[data,lang,toast]);
  const handleImport=useCallback(()=>{const inp=document.createElement('input');inp.type='file';inp.accept='.json';inp.onchange=async e=>{try{const txt=await e.target.files[0].text(),imp=JSON.parse(txt);const doIt=async()=>{for(const s of ST){await dClr(s);if(imp[s])for(const it of imp[s])await dPut(s,it);}await initCats();await load();toast(T('تم استيراد كل البيانات 📥','All data imported 📥',lang));};if(data.goals.length||data.expenses?.length||data.notes?.length)setConfirm({message:T('سيتم استبدال كل البيانات (أهداف + مصاريف + مفكرة). متابعة؟','Replace ALL data (goals + expenses + notes)?',lang),onOk:async()=>{await doIt();setConfirm(null);}});else await doIt();}catch(e){toast(T('خطأ','Error',lang),'error');}};inp.click();},[data,lang,load,toast]);

  // Expense handlers
  const handleSaveExpense=useCallback(async(e)=>{await dPut('expenses',e);await load();toast(T('تم حفظ المصروف 💰','Expense saved 💰',lang));
    // Budget warning with currency conversion
    if(e.budgetId){const allE=await dAll('expenses');const b=(await dAll('budgets')).find(b=>b.id===e.budgetId);if(b){const r=getStoredRates().rates;const spent=allE.filter(x=>x.budgetId===b.id).reduce((s,x)=>s+convertAmount(x.amount,x.currency,b.currency,r),0);const pct=b.totalAmount?spent/b.totalAmount*100:0;if(pct>=100)toast(T(`🔴 تجاوزت ميزانية "${b.title}"!`,`🔴 Over budget "${b.title}"!`,lang),'error');else if(pct>=80)toast(T(`⚠️ وصلت ${Math.round(pct)}% من "${b.title}"`,`⚠️ ${Math.round(pct)}% of "${b.title}"`,lang),'warning');}}
  },[load,toast,lang]);
  const handleDeleteExpense=useCallback((e)=>{setConfirm({message:T(`حذف "${e.title}"؟`,`Delete "${e.title}"?`,lang),onOk:async()=>{await dDel('expenses',e.id);await load();toast(T('تم الحذف','Deleted',lang));setConfirm(null);}});},[lang,load,toast]);
  const handleSaveCategory=useCallback(async(c)=>{await dPut('categories',c);await load();toast(T('تم حفظ التصنيف','Category saved',lang));},[load,toast,lang]);
  const handleDeleteCategory=useCallback((c)=>{setConfirm({message:T(`حذف تصنيف "${c.name}"؟`,`Delete category "${c.nameEn}"?`,lang),onOk:async()=>{await dDel('categories',c.id);await load();toast(T('تم الحذف','Deleted',lang));setConfirm(null);}});},[lang,load,toast]);
  const handleSaveBudget=useCallback(async(b)=>{await dPut('budgets',b);await load();toast(T('تم حفظ الميزانية','Budget saved',lang));},[load,toast,lang]);
  const handleDeleteBudget=useCallback((b)=>{setConfirm({message:T(`حذف ميزانية "${b.title}"؟`,`Delete budget "${b.title}"?`,lang),onOk:async()=>{await dDel('budgets',b.id);await load();toast(T('تم الحذف','Deleted',lang));setConfirm(null);}});},[lang,load,toast]);

  // Note handlers
  const handleSaveNote=useCallback(async(n)=>{await dPut('notes',n);await load();toast(T('تم حفظ الملاحظة 📓','Note saved 📓',lang));},[load,toast,lang]);
  const handleDeleteNote=useCallback((n)=>{setConfirm({message:T(`حذف "${n.title||'ملاحظة'}"؟`,`Delete "${n.title||'note'}"?`,lang),onOk:async()=>{await dDel('notes',n.id);await load();toast(T('تم الحذف','Deleted',lang));setConfirm(null);}});},[lang,load,toast]);

  const navs=[{id:'dashboard',icon:'🎯',label:T('الأهداف','Goals',lang)},{id:'today',icon:'🔥',label:T('اليوم','Today',lang)},{id:'expenses',icon:'💰',label:T('المصاريف','Expenses',lang)},{id:'notes',icon:'📓',label:T('مفكرتي','Notes',lang)},{id:'timeline',icon:'📊',label:T('الجدول','Timeline',lang)}];
  return(
    <div style={{minHeight:'100dvh',display:'flex',flexDirection:'column',position:'relative',zIndex:1}}>
      <header style={{background:'var(--bg2)',borderBottom:'1px solid var(--border)',padding:'10px 14px',position:'sticky',top:0,zIndex:40,backdropFilter:'blur(12px)'}}>
        <div className="desktop-layout" style={{maxWidth:860,margin:'0 auto',display:'flex',alignItems:'center',justifyContent:'space-between'}}>
          <div style={{display:'flex',alignItems:'center',gap:8}}><img src={MUTQIN_LOGO} alt="متقن" style={{width:36,height:36,borderRadius:8}}/><h1 className="hidden sm:block" style={{fontSize:18,fontWeight:900,background:'linear-gradient(135deg,var(--coral),var(--gold))',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent'}}>{T('متقن','Mutqin',lang)}</h1></div>
          <nav className="dnav" style={{gap:4}}>{navs.map(n=>(<div key={n.id} className={`dnav-item ${view===n.id?'active':''}`} onClick={()=>setView(n.id)}><span>{n.icon}</span><span>{n.label}</span></div>))}</nav>
          <div style={{display:'flex',alignItems:'center',gap:4}}>
            {installPrompt&&<button className="btn btn-coral btn-sm" onClick={handleInstall} style={{fontSize:12,padding:'6px 12px',animation:'pulse 2s infinite'}}>📲 {T('ثبّت التطبيق','Install App',lang)}</button>}
            <button className="btn btn-ghost btn-icon-sm" title={theme==='dark'?T('الوضع الفاتح','Light Mode',lang):T('الوضع الداكن','Dark Mode',lang)} onClick={()=>setTheme(t=>t==='dark'?'light':'dark')}>{theme==='dark'?'☀️':'🌙'}</button>
            <button className="btn btn-ghost btn-icon-sm" title={previewMode==='desktop'?T('معاينة الجوال','Mobile Preview',lang):T('معاينة سطح المكتب','Desktop View',lang)} onClick={()=>setPreviewMode(p=>p==='desktop'?'mobile':'desktop')} style={{fontSize:16}}>{previewMode==='desktop'?'📱':'💻'}</button>
            <button className="btn btn-ghost btn-icon-sm" title={T('استيراد من Excel','Import Excel',lang)} onClick={()=>setUploadModal(true)}>📂</button>
            <button className="btn btn-ghost btn-icon-sm" title={T('تصدير للتقويم','Export to Calendar',lang)} onClick={handleCalExport} style={{fontSize:16}}>📅</button>
            <button className="btn btn-ghost btn-icon-sm" title={T('تصدير JSON','Export JSON',lang)} onClick={handleExport}>📤</button>
            <button className="btn btn-ghost btn-icon-sm" title={T('استيراد JSON','Import JSON',lang)} onClick={handleImport}>📥</button>
            <button className="btn btn-ghost btn-sm" onClick={()=>setLang(lang==='ar'?'en':'ar')} style={{fontWeight:800,fontSize:13}}>{lang==='ar'?'EN':'عربي'}</button>
          </div>
        </div>
      </header>
      {previewMode==='mobile'?(
        <div style={{flex:1,display:'flex',justifyContent:'center',alignItems:'flex-start',padding:'20px 12px',background:'var(--bg)',overflow:'auto'}}>
          <div className="mobile-preview">
            <div style={{flex:1,overflowY:'auto',overflowX:'hidden',background:'var(--bg)'}}>
              <div style={{padding:'36px 10px 90px',maxWidth:'100%'}}>
                <BackupBar language={lang} onExport={handleExport}/>
                {view!=='timeline'&&view!=='expenses'&&view!=='notes'&&<div style={{marginBottom:16}}><Cal language={lang} data={data} onDayClick={handleDayClick}/></div>}
                {view==='dashboard'&&<><StatsBar data={data} language={lang}/><WeeklyChart data={data} language={lang}/><SearchFilter language={lang} search={search} onSearch={setSearch} filter={filter} onFilter={setFilter}/><Dashboard data={data} language={lang} onAdd={handleAdd} onEdit={handleEdit} onDelete={handleDelete} onStatus={handleStatus} onReorder={handleReorder} search={search} filter={filter}/></>}
                {view==='today'&&<Today data={data} language={lang} onAdd={handleAdd} onEdit={handleEdit} onDelete={handleDelete} onStatus={handleStatus} onSaveList={handleSaveList} onDeleteList={handleDeleteList}/>}
                {view==='expenses'&&<Expenses data={data} language={lang} onSaveExpense={handleSaveExpense} onDeleteExpense={handleDeleteExpense} onSaveCategory={handleSaveCategory} onDeleteCategory={handleDeleteCategory} onSaveBudget={handleSaveBudget} onDeleteBudget={handleDeleteBudget} toast={toast}/>}
                {view==='notes'&&<Notes data={data} language={lang} onSaveNote={handleSaveNote} onDeleteNote={handleDeleteNote} toast={toast}/>}
                {view==='timeline'&&<Timeline data={data} language={lang}/>}
              </div>
            </div>
            <div className="bottom-nav">{navs.map(n=>(<div key={n.id} className={`bnav-item ${view===n.id?'active':''}`} onClick={()=>setView(n.id)}><span>{n.icon}</span><span>{n.label}</span></div>))}</div>
          </div>
        </div>
      ):(
        <>
          <main className="desktop-layout" style={{flex:1,maxWidth:860,margin:'0 auto',width:'100%',padding:'16px 12px 100px'}}>
            <BackupBar language={lang} onExport={handleExport}/>
            {view==='dashboard'||view==='today'?(
              <div className="desk-split">
                <div className="cal-col">
                  <button className="cal-toggle" onClick={()=>setCalOpen(p=>!p)}><span style={{fontSize:18}}>📅</span><span style={{flex:1,textAlign:lang==='ar'?'right':'left'}}>{calOpen?T('إخفاء التقويم','Hide Calendar',lang):T('عرض التقويم','Show Calendar',lang)}</span><span style={{transition:'transform .2s',transform:calOpen?'rotate(180deg)':'rotate(0)'}}>▼</span></button>
                  <div className="cal-inner" style={!calOpen?{display:'none'}:{}}><Cal language={lang} data={data} onDayClick={handleDayClick}/></div>
                </div>
                <div>
                  {view==='dashboard'&&<><StatsBar data={data} language={lang}/><WeeklyChart data={data} language={lang}/><SearchFilter language={lang} search={search} onSearch={setSearch} filter={filter} onFilter={setFilter}/><Dashboard data={data} language={lang} onAdd={handleAdd} onEdit={handleEdit} onDelete={handleDelete} onStatus={handleStatus} onReorder={handleReorder} search={search} filter={filter}/></>}
                  {view==='today'&&<Today data={data} language={lang} onAdd={handleAdd} onEdit={handleEdit} onDelete={handleDelete} onStatus={handleStatus} onSaveList={handleSaveList} onDeleteList={handleDeleteList}/>}
                </div>
              </div>
            ):view==='expenses'?(
              <Expenses data={data} language={lang} onSaveExpense={handleSaveExpense} onDeleteExpense={handleDeleteExpense} onSaveCategory={handleSaveCategory} onDeleteCategory={handleDeleteCategory} onSaveBudget={handleSaveBudget} onDeleteBudget={handleDeleteBudget} toast={toast}/>
            ):view==='notes'?(
              <Notes data={data} language={lang} onSaveNote={handleSaveNote} onDeleteNote={handleDeleteNote} toast={toast}/>
            ):(
              <Timeline data={data} language={lang}/>
            )}}
          </main>
          <div className="bottom-nav">{navs.map(n=>(<div key={n.id} className={`bnav-item ${view===n.id?'active':''}`} onClick={()=>setView(n.id)}><span>{n.icon}</span><span>{n.label}</span></div>))}</div>
        </>
      )}
      <Toasts toasts={toasts} onDismiss={id=>setToasts(p=>p.filter(t=>t.id!==id))}/>
      <Pomodoro language={lang}/>
      {modal&&<ItemModal type={modal.type} editItem={modal.editItem} goalId={modal.goalId} milestoneId={modal.milestoneId} language={lang} onSave={handleSave} onClose={()=>setModal(null)} allTasks={data.tasks||[]}/>}
      {listModal&&<ListModal editList={listModal.id?listModal:null} language={lang} onSave={handleSaveListModal} onClose={()=>setListModal(null)}/>}
      {confirm&&<Confirm message={confirm.message} language={lang} onOk={confirm.onOk} onCancel={()=>setConfirm(null)}/>}
      {dayView&&<DayMod dateStr={dayView.dateStr} items={dayView.items} language={lang} onClose={()=>setDayView(null)} onAddTask={d=>handleAddFromDay('quickTask',d)} onAddMeeting={d=>handleAddFromDay('meeting',d)} onAddExpense={d=>{setDayView(null);setExpFromCal(d);}} onStatus={async(store,item,ns)=>{await handleStatus(store,item,ns);const ds=dayView.dateStr;const nd=await dAll('tasks'),nq=await dAll('quickTasks'),nm=await dAll('meetings');const ni=[];nd.forEach(x=>{if(x.dueDate&&x.dueDate.startsWith(ds))ni.push({...x,_type:'task'});});nq.forEach(x=>{if(x.dueDate&&x.dueDate.startsWith(ds))ni.push({...x,_type:'quickTask'});});nm.forEach(x=>{if(x.meetingDate&&x.meetingDate.startsWith(ds))ni.push({...x,_type:'meeting'});});setDayView({dateStr:ds,items:ni});}} onReorder={async(store,items)=>{await handleReorder(store,items);const ds=dayView.dateStr;const nd=await dAll('tasks'),nq=await dAll('quickTasks'),nm=await dAll('meetings');const ni=[];nd.forEach(x=>{if(x.dueDate&&x.dueDate.startsWith(ds))ni.push({...x,_type:'task'});});nq.forEach(x=>{if(x.dueDate&&x.dueDate.startsWith(ds))ni.push({...x,_type:'quickTask'});});nm.forEach(x=>{if(x.meetingDate&&x.meetingDate.startsWith(ds))ni.push({...x,_type:'meeting'});});setDayView({dateStr:ds,items:ni});}}/>}
      {expFromCal&&<ExpenseModal expense={{_isNew:true,date:expFromCal}} categories={data.categories||[]} budgets={data.budgets||[]} language={lang} onSave={async e=>{await handleSaveExpense(e);setExpFromCal(null);}} onClose={()=>setExpFromCal(null)}/>}
      {uploadModal&&<UploadModal language={lang} onImport={handleXlsxImport} onClose={()=>setUploadModal(false)}/>}
    </div>);
}
ReactDOM.render(<App/>,document.getElementById('root'));
</script>
</body>
</html>
